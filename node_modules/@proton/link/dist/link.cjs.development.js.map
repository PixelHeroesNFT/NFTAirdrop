{"version":3,"file":"link.cjs.development.js","sources":["../../../node_modules/regenerator-runtime/runtime.js","../src/errors.ts","../src/link-options.ts","../src/link-abi-data.ts","../src/utils.ts","../src/link-session.ts","../src/link.ts"],"sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","/**\n * Error codes. Accessible using the `code` property on errors thrown by [[Link]] and [[LinkSession]].\n * - `E_DELIVERY`: Unable to request message to wallet.\n * - `E_TIMEOUT`: Request was delivered but user/wallet didn't respond in time.\n * - `E_CANCEL`: The [[LinkTransport]] canceled the request.\n * - `E_IDENTITY`: Identity proof failed to verify.\n */\nexport type LinkErrorCode = 'E_DELIVERY' | 'E_TIMEOUT' | 'E_CANCEL' | 'E_IDENTITY'\n\n/**\n * Error that is thrown if a [[LinkTransport]] cancels a request.\n * @internal\n */\nexport class CancelError extends Error {\n    public code = 'E_CANCEL'\n    constructor(reason?: string) {\n        super(`User canceled request ${reason ? '(' + reason + ')' : ''}`)\n    }\n}\n\n/**\n * Error that is thrown if an identity request fails to verify.\n * @internal\n */\nexport class IdentityError extends Error {\n    public code = 'E_IDENTITY'\n    constructor(reason?: string) {\n        super(`Unable to verify identity ${reason ? '(' + reason + ')' : ''}`)\n    }\n}\n\n/**\n * Error originating from a [[LinkSession]].\n * @internal\n */\nexport class SessionError extends Error {\n    public code: 'E_DELIVERY' | 'E_TIMEOUT'\n    constructor(reason: string, code: 'E_DELIVERY' | 'E_TIMEOUT') {\n        super(reason)\n        this.code = code\n    }\n}\n","import {ChainName} from '@proton/signing-request'\nimport {JsonRpc} from '@proton/js'\nimport {LinkStorage} from './link-storage'\nimport {LinkTransport} from './link-transport'\n\n/**\n * Available options when creating a new [[Link]] instance.\n */\nexport interface LinkOptions {\n    /**\n     * Link transport responsible for presenting signing requests to user, required.\n     */\n    transport: LinkTransport\n    /**\n     * ChainID or esr chain name alias for which the link is valid.\n     * Defaults to EOS (aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906).\n     */\n    chainId?: string | ChainName\n    /**\n     * URL to EOSIO node to communicate with or e eosjs JsonRpc instance.\n     * Defaults to https://eos.greymass.com\n     */\n    rpc?: string | JsonRpc\n    /**\n     * URL to link callback service.\n     * Defaults to https://cb.anchor.link.\n     */\n    service?: string\n    /**\n     * Optional storage adapter that will be used to persist sessions if set.\n     * If not storage adapter is set but the given transport provides a storage, that will be used.\n     * Explicitly set this to `null` to force no storage.\n     */\n    storage?: LinkStorage | null\n    /**\n     * Scheme for transport\n     */\n    scheme?: string\n    /**\n     * Type of wallet (Anchor/Proton)\n     */\n    walletType?: string\n}\n\n/** @internal */\nexport const defaults = {\n    chainId: '384da888112027f0321850a169f737c33e53b388aad48b5adace4bab97f437e0',\n    rpc: 'https://proton.greymass.com',\n    service: 'https://cb.anchor.link',\n}\n","export default {\n    version: 'eosio::abi/1.1',\n    types: [],\n    structs: [\n        {\n            name: 'sealed_message',\n            base: '',\n            fields: [\n                {\n                    name: 'from',\n                    type: 'public_key',\n                },\n                {\n                    name: 'nonce',\n                    type: 'uint64',\n                },\n                {\n                    name: 'ciphertext',\n                    type: 'bytes',\n                },\n                {\n                    name: 'checksum',\n                    type: 'uint32',\n                },\n            ],\n        },\n        {\n            name: 'link_create',\n            base: '',\n            fields: [\n                {\n                    name: 'session_name',\n                    type: 'name',\n                },\n                {\n                    name: 'request_key',\n                    type: 'public_key',\n                },\n            ],\n        },\n        {\n            name: 'link_info',\n            base: '',\n            fields: [\n                {\n                    name: 'expiration',\n                    type: 'time_point_sec',\n                },\n            ],\n        },\n    ],\n    actions: [],\n    ricardian_clauses: [],\n    error_messages: [],\n    tables: [],\n    abi_extensions: [],\n}\n","import {Numeric, Serialize} from '@proton/js'\n\nimport {Bytes, SealedMessage} from './link-abi'\nimport linkAbi from './link-abi-data'\n\nimport * as ecc from 'eosjs-ecc'\n\n/** @internal */\nconst types = Serialize.getTypesFromAbi(Serialize.createInitialTypes(), linkAbi)\n\n/**\n * Helper to ABI encode value\n * @internal\n */\nexport function abiEncode(value: any, typeName: string): Uint8Array {\n    let type = types.get(typeName)\n    if (!type) {\n        throw new Error(`No such type: ${typeName}`)\n    }\n    let buf = new Serialize.SerialBuffer()\n    type.serialize(buf, value)\n    return buf.asUint8Array()\n}\n\n/**\n * Helper to ABI decode data.\n * @internal\n */\nexport function abiDecode<ResultType = any>(data: Bytes, typeName: string): ResultType {\n    let type = types.get(typeName)\n    if (!type) {\n        throw new Error(`No such type: ${typeName}`)\n    }\n    if (typeof data === 'string') {\n        data = Serialize.hexToUint8Array(data)\n    } else if (!(data instanceof Uint8Array)) {\n        data = new Uint8Array(data)\n    }\n    let buf = new Serialize.SerialBuffer({\n        array: data,\n    })\n    return type.deserialize(buf) as ResultType\n}\n\n/**\n * Encrypt a message using AES and shared secret derived from given keys.\n * @internal\n */\nexport function sealMessage(message: string, privateKey: string, publicKey: string) {\n    const res = ecc.Aes.encrypt(privateKey, publicKey, message)\n    const data: SealedMessage = {\n        from: ecc.privateToPublic(privateKey),\n        nonce: res.nonce.toString(),\n        ciphertext: res.message,\n        checksum: res.checksum,\n    }\n    return abiEncode(data, 'sealed_message')\n}\n\n/**\n * Ensure public key is in new PUB_ format.\n * @internal\n */\nexport function normalizePublicKey(key: string) {\n    if (key.startsWith('PUB_')) {\n        return key\n    }\n    return Numeric.publicKeyToString(Numeric.stringToPublicKey('EOS' + key.substr(-50)))\n}\n\n/**\n * Return true if given public keys are equal.\n * @internal\n */\nexport function publicKeyEqual(keyA: string, keyB: string) {\n    return normalizePublicKey(keyA) === normalizePublicKey(keyB)\n}\n\n/**\n * Generate a random private key.\n * Uses browser crypto if available, otherwise falls back to slow eosjs-ecc.\n * @internal\n */\nexport async function generatePrivateKey() {\n    if (typeof window !== 'undefined' && window.crypto) {\n        const data = new Uint32Array(32)\n        window.crypto.getRandomValues(data)\n        return ecc.PrivateKey.fromBuffer(Buffer.from(data)).toString()\n    } else {\n        return await ecc.randomKey()\n    }\n}\n","import {SigningRequest} from '@proton/signing-request'\nimport {ApiInterfaces} from '@proton/js'\nimport {SessionError} from './errors'\nimport {Link, PermissionLevel, TransactArgs, TransactOptions, TransactResult} from './link'\nimport {LinkInfo} from './link-abi'\nimport {LinkTransport} from './link-transport'\nimport {abiEncode, sealMessage} from './utils'\n\n/**\n * Type describing a link session that can create a eosjs compatible\n * signature provider and transact for a specific auth.\n */\nexport abstract class LinkSession {\n    /** The underlying link instance used by the session. */\n    abstract link: Link\n    /** App identifier that owns the session. */\n    abstract identifier: string\n    /** The public key the session can sign for. */\n    abstract publicKey: string\n    /** The EOSIO auth (a.k.a. permission level) the session can sign for. */\n    abstract auth: {\n        actor: string\n        permission: string\n    }\n    /** Session type, e.g. 'channel'.  */\n    abstract type: string\n    /** Arbitrary metadata that will be serialized with the session. */\n    abstract metadata: {[key: string]: any}\n    // Proton\n    /** Account data for proton related info */\n    accountData?: any[]\n\n    /** Creates a eosjs compatible authority provider. */\n    abstract makeAuthorityProvider(): ApiInterfaces.AuthorityProvider\n    /** Creates a eosjs compatible signature provider that can sign for the session public key. */\n    abstract makeSignatureProvider(): ApiInterfaces.SignatureProvider\n    /**\n     * Transact using this session. See [[Link.transact]].\n     */\n    abstract transact(args: TransactArgs, options?: TransactOptions): Promise<TransactResult>\n    /** Returns a JSON-encodable object that can be used recreate the session. */\n    abstract serialize(): SerializedLinkSession\n\n    /**\n     * Convenience, remove this session from associated [[Link]] storage if set.\n     * Equivalent to:\n     * ```ts\n     * session.link.removeSession(session.identifier, session.auth)\n     * ```\n     */\n    async remove() {\n        if (this.link.storage) {\n            await this.link.removeSession(this.identifier, this.auth)\n        }\n    }\n    /** Restore a previously serialized session. */\n    static restore(link: Link, data: SerializedLinkSession): LinkSession {\n        switch (data.type) {\n            case 'channel':\n                return new LinkChannelSession(link, data.data, data.metadata)\n            case 'fallback':\n                return new LinkFallbackSession(link, data.data, data.metadata)\n            default:\n                throw new Error('Unable to restore, session data invalid')\n        }\n    }\n}\n\n/** @internal */\nexport interface SerializedLinkSession {\n    type: string\n    metadata: {[key: string]: any}\n    data: any\n}\n\n/** @internal */\ninterface ChannelInfo {\n    /** Public key requests are encrypted to. */\n    key: string\n    /** The wallet given channel name, usually the device name. */\n    name: string\n    /** The channel push url. */\n    url: string\n}\n\n/** @internal */\nexport interface LinkChannelSessionData {\n    /** App identifier that owns the session. */\n    identifier: string\n    /** Authenticated user permission. */\n    auth: PermissionLevel\n    /** Public key of authenticated user */\n    publicKey: string\n    /** The wallet channel url. */\n    channel: ChannelInfo\n    /** The private request key. */\n    requestKey: string\n}\n\n/**\n * Link session that pushes requests over a channel.\n * @internal\n */\nexport class LinkChannelSession extends LinkSession implements LinkTransport {\n    readonly link: Link\n    readonly auth: PermissionLevel\n    readonly identifier: string\n    readonly type = 'channel'\n    readonly metadata: any\n    readonly publicKey: string\n    serialize: () => SerializedLinkSession\n    private channel: ChannelInfo\n    private timeout = 2 * 60 * 1000 // ms\n    private encrypt: (request: SigningRequest) => Uint8Array\n\n    constructor(link: Link, data: LinkChannelSessionData, metadata: any) {\n        super()\n        this.link = link\n        this.auth = data.auth\n        this.publicKey = data.publicKey\n        this.channel = data.channel\n        this.identifier = data.identifier\n        this.encrypt = (request) => {\n            return sealMessage(request.encode(true, false), data.requestKey, data.channel.key)\n        }\n        this.metadata = {\n            ...(metadata || {}),\n            timeout: this.timeout,\n            name: this.channel.name,\n        }\n        this.serialize = () => ({\n            type: 'channel',\n            data,\n            metadata: this.metadata,\n        })\n    }\n\n    onSuccess(request: any, result: any) {\n        if (this.link.transport.onSuccess) {\n            this.link.transport.onSuccess(request, result)\n        }\n    }\n\n    onFailure(request: any, error: any) {\n        if (this.link.transport.onFailure) {\n            this.link.transport.onFailure(request, error)\n        }\n    }\n\n    onRequest(request: any, cancel: any) {\n        const info: LinkInfo = {\n            expiration: new Date(Date.now() + this.timeout).toISOString().slice(0, -1),\n        }\n        if (this.link.transport.onSessionRequest) {\n            this.link.transport.onSessionRequest(this, request, cancel)\n        }\n        setTimeout(() => {\n            cancel(new SessionError('Wallet did not respond in time', 'E_TIMEOUT'))\n        }, this.timeout + 500)\n        request.data.info.push({\n            key: 'link',\n            value: abiEncode(info, 'link_info'),\n        })\n        fetch(this.channel.url, {\n            method: 'POST',\n            headers: {\n                'X-Buoy-Wait': (this.timeout / 1000).toFixed(0),\n                'Content-Type': \"text/html\",\n                'Accept': \"text/html\"\n            },\n\n            body: this.encrypt(request),\n        })\n            .then((response: any) => {\n                if (response.status !== 200) {\n                    cancel(new SessionError('Unable to push message', 'E_DELIVERY'))\n                } else {\n                    // request delivered\n                }\n            })\n            .catch((error: any) => {\n                cancel(\n                    new SessionError(\n                        `Unable to reach link service (${error.message || String(error)})`,\n                        'E_DELIVERY'\n                    )\n                )\n            })\n    }\n\n    prepare(request: any) {\n        if (this.link.transport.prepare) {\n            return this.link.transport.prepare(request, this)\n        }\n        return Promise.resolve(request)\n    }\n\n    showLoading() {\n        if (this.link.transport.showLoading) {\n            return this.link.transport.showLoading()\n        }\n    }\n\n    public makeSignatureProvider(): ApiInterfaces.SignatureProvider {\n        return this.link.makeSignatureProvider([this.publicKey], this)\n    }\n\n    public makeAuthorityProvider(): ApiInterfaces.AuthorityProvider {\n        return this.link.makeAuthorityProvider()\n    }\n\n    transact(args: TransactArgs, options?: TransactOptions) {\n        return this.link.transact(args, options, this)\n    }\n}\n\n/** @internal */\nexport interface LinkFallbackSessionData {\n    auth: {\n        actor: string\n        permission: string\n    }\n    publicKey: string\n    identifier: string\n}\n\n/**\n * Link session that sends every request over the transport.\n * @internal\n */\nexport class LinkFallbackSession extends LinkSession implements LinkTransport {\n    readonly link: Link\n    readonly auth: {\n        actor: string\n        permission: string\n    }\n    readonly type = 'fallback'\n    readonly identifier: string\n    readonly metadata: {[key: string]: any}\n    readonly publicKey: string\n    serialize: () => SerializedLinkSession\n\n    constructor(link: Link, data: LinkFallbackSessionData, metadata: any) {\n        super()\n        this.link = link\n        this.auth = data.auth\n        this.publicKey = data.publicKey\n        this.metadata = metadata || {}\n        this.identifier = data.identifier\n        this.serialize = () => ({\n            type: this.type,\n            data,\n            metadata: this.metadata,\n        })\n    }\n\n    onSuccess(request: any, result: any) {\n        if (this.link.transport.onSuccess) {\n            this.link.transport.onSuccess(request, result)\n        }\n    }\n\n    onFailure(request: any, error: any) {\n        if (this.link.transport.onFailure) {\n            this.link.transport.onFailure(request, error)\n        }\n    }\n\n    onRequest(request: any, cancel: any) {\n        if (this.link.transport.onSessionRequest) {\n            this.link.transport.onSessionRequest(this, request, cancel)\n        } else {\n            this.link.transport.onRequest(request, cancel)\n        }\n    }\n\n    prepare(request: any) {\n        if (this.link.transport.prepare) {\n            return this.link.transport.prepare(request, this)\n        }\n        return Promise.resolve(request)\n    }\n\n    showLoading() {\n        if (this.link.transport.showLoading) {\n            return this.link.transport.showLoading()\n        }\n    }\n\n    public makeSignatureProvider(): ApiInterfaces.SignatureProvider {\n        return this.link.makeSignatureProvider([this.publicKey], this)\n    }\n\n    public makeAuthorityProvider(): ApiInterfaces.AuthorityProvider {\n        return this.link.makeAuthorityProvider()\n    }\n\n    transact(args: TransactArgs, options?: TransactOptions) {\n        return this.link.transact(args, options, this)\n    }\n}\n","import * as esr from '@proton/signing-request'\nimport {ApiInterfaces, JsonRpc, Key} from '@proton/js'\nimport WebSocket from 'isomorphic-ws'\nimport zlib from 'pako'\nimport {v4 as uuid} from 'uuid'\n\nimport {CancelError, IdentityError} from './errors'\nimport {LinkCreate} from './link-abi'\nimport {defaults, LinkOptions} from './link-options'\nimport {LinkChannelSession, LinkFallbackSession, LinkSession} from './link-session'\nimport {LinkStorage} from './link-storage'\nimport {LinkTransport} from './link-transport'\nimport {abiEncode, generatePrivateKey, normalizePublicKey, publicKeyEqual} from './utils'\n\n/** EOSIO permission level with actor and signer, a.k.a. 'auth', 'authority' or 'account auth' */\nexport type PermissionLevel = esr.abi.PermissionLevel\n\n/**\n * Payload accepted by the [[Link.transact]] method.\n * Note that one of `action`, `actions` or `transaction` must be set.\n */\nexport interface TransactArgs {\n    /** Full transaction to sign. */\n    transaction?: esr.abi.Transaction\n    /** Action to sign. */\n    action?: esr.abi.Action\n    /** Actions to sign. */\n    actions?: esr.abi.Action[]\n}\n\n/**\n * Options for the [[Link.transact]] method.\n */\nexport interface TransactOptions {\n    /**\n     * Whether to broadcast the transaction or just return the signature.\n     * Defaults to true.\n     */\n    broadcast?: boolean\n}\n\n/**\n * The result of a [[Link.transact]] call.\n */\nexport interface TransactResult {\n    /** The signing request that was sent. */\n    request: esr.SigningRequest\n    /** The transaction signatures. */\n    signatures: string[]\n    /** The callback payload. */\n    payload: esr.CallbackPayload\n    /** The signer authority. */\n    signer: PermissionLevel\n    /** The resulting transaction. */\n    transaction: esr.abi.Transaction\n    /** Serialized version of transaction. */\n    serializedTransaction: Uint8Array\n    /** Push transaction response from api node, only present if transaction was broadcast. */\n    processed?: {[key: string]: any}\n}\n\n/**\n * The result of a [[Link.identify]] call.\n */\nexport interface IdentifyResult extends TransactResult {\n    /** The identified account. */\n    account: object\n    /** The public key that signed the identity proof.  */\n    signerKey: string\n}\n\n/**\n * The result of a [[Link.login]] call.\n */\nexport interface LoginResult extends IdentifyResult {\n    /** The session created by the login. */\n    session: LinkSession\n}\n\n/**\n * Main class, also exposed as the default export of the library.\n *\n * Example:\n *\n * ```ts\n * import AnchorLink from 'anchor-link'\n * import ConsoleTransport from 'anchor-link-console-transport'\n *\n * const link = new AnchorLink({\n *     transport: new ConsoleTransport()\n * })\n *\n * const result = await link.transact({actions: myActions})\n * ```\n */\nexport class Link implements esr.AbiProvider {\n    /** The eosjs RPC instance used to communicate with the EOSIO node. */\n    public readonly rpc: JsonRpc\n    /** Transport used to deliver requests to the user wallet. */\n    public readonly transport: LinkTransport\n    /** EOSIO ChainID for which requests are valid. */\n    public readonly chainId: string\n    /** Storage adapter used to persist sessions. */\n    public readonly storage?: LinkStorage\n    private serviceAddress: string\n    private requestOptions: esr.SigningRequestEncodingOptions\n    private abiCache = new Map<string, any>()\n    private pendingAbis = new Map<string, Promise<any>>()\n    private walletType: string = ''\n\n    /** Create a new link instance. */\n    constructor(options: LinkOptions) {\n        if (typeof options !== 'object') {\n            throw new TypeError('Missing options object')\n        }\n        if (!options.transport) {\n            throw new TypeError(\n                'options.transport is required, see https://github.com/greymass/anchor-link#transports'\n            )\n        }\n        if (options.rpc === undefined || typeof options.rpc === 'string') {\n            this.rpc = new JsonRpc(options.rpc || defaults.rpc)\n        } else {\n            this.rpc = options.rpc\n        }\n        if (options.chainId) {\n            this.chainId =\n                typeof options.chainId === 'number'\n                    ? esr.nameToId(options.chainId)\n                    : options.chainId\n        } else {\n            this.chainId = defaults.chainId\n        }\n        this.serviceAddress = (options.service || defaults.service).trim().replace(/\\/$/, '')\n        this.transport = options.transport\n        if (options.storage !== null) {\n            this.storage = options.storage\n        }\n        this.requestOptions = {\n            abiProvider: this,\n            zlib,\n            scheme: options.scheme,\n        }\n        if (options.walletType && options.walletType.length > 0) {\n            this.walletType = options.walletType || ''\n        }\n    }\n\n    /**\n     * Fetch the ABI for given account, cached.\n     * @internal\n     */\n    public async getAbi(account: string) {\n        let rv = this.abiCache.get(account)\n        if (!rv) {\n            let getAbi = this.pendingAbis.get(account)\n            if (!getAbi) {\n                getAbi = this.rpc.get_abi(account)\n                this.pendingAbis.set(account, getAbi)\n            }\n            rv = (await getAbi).abi\n            this.pendingAbis.delete(account)\n            if (rv) {\n                this.abiCache.set(account, rv)\n            }\n        }\n        return rv\n    }\n\n    /**\n     * Create a new unique buoy callback url.\n     * @internal\n     */\n    public createCallbackUrl() {\n        return `${this.serviceAddress}/${uuid()}`\n    }\n\n    /**\n     * Create a SigningRequest instance configured for this link.\n     * @internal\n     */\n    public async createRequest(args: esr.SigningRequestCreateArguments, transport?: LinkTransport) {\n        const t = transport || this.transport\n        // generate unique callback url\n        let request = await esr.SigningRequest.create(\n            {\n                ...args,\n                chainId: this.chainId,\n                broadcast: false,\n                callback: {\n                    url: this.createCallbackUrl(),\n                    background: true,\n                },\n            },\n            this.requestOptions\n        )\n        if (t.prepare) {\n            request = await t.prepare(request)\n        }\n        return request\n    }\n\n    /**\n     * Send a SigningRequest instance using this link.\n     * @internal\n     */\n    public async sendRequest(\n        request: esr.SigningRequest,\n        transport?: LinkTransport,\n        broadcast = false\n    ) {\n        const t = transport || this.transport\n        try {\n            const linkUrl = request.data.callback\n            if (!linkUrl.startsWith(this.serviceAddress)) {\n                throw new Error('Request must have a link callback')\n            }\n            if (request.data.flags !== 2) {\n                throw new Error('Invalid request flags')\n            }\n            // wait for callback or user cancel\n            const ctx: {cancel?: () => void} = {}\n            const socket = waitForCallback(linkUrl, ctx).then((data) => {\n                if (typeof data.rejected === 'string') {\n                    throw new CancelError(`Rejected by wallet: ${data.rejected}`)\n                }\n                return data\n            })\n            const cancel = new Promise<never>((_, reject) => {\n                t.onRequest(request, (reason) => {\n                    if (ctx.cancel) {\n                        ctx.cancel()\n                    }\n                    if (typeof reason === 'string') {\n                        reject(new CancelError(reason))\n                    } else {\n                        reject(reason)\n                    }\n                })\n            })\n            const payload = await Promise.race([socket, cancel])\n            const signer: PermissionLevel = {\n                actor: payload.sa,\n                permission: payload.sp,\n            }\n            const signatures: string[] = Object.keys(payload)\n                .filter((key) => key.startsWith('sig') && key !== 'sig0')\n                .map((key) => payload[key]!)\n            // recreate transaction from request response\n            const resolved = await esr.ResolvedSigningRequest.fromPayload(\n                payload,\n                this.requestOptions\n            )\n            const info = resolved.request.getInfo()\n            if (info['fuel_sig']) {\n                signatures.unshift(info['fuel_sig'])\n            }\n            const {serializedTransaction, transaction} = resolved\n            const result: TransactResult = {\n                request: resolved.request,\n                serializedTransaction,\n                transaction,\n                signatures,\n                payload,\n                signer,\n            }\n            if (broadcast) {\n                const res = await this.rpc.push_transaction({\n                    signatures: result.signatures,\n                    serializedTransaction: result.serializedTransaction,\n                })\n                result.processed = res.processed\n            }\n            if (result.request.isIdentity()) {\n                await this.checkIdentity(result)\n            }\n            if (t.onSuccess) {\n                t.onSuccess(request, result)\n            }\n            return result\n        } catch (error) {\n            if (t.onFailure) {\n                t.onFailure(request, error)\n            }\n            throw error\n        }\n    }\n\n    /**\n     * Sign and optionally broadcast a EOSIO transaction, action or actions.\n     *\n     * Example:\n     *\n     * ```ts\n     * let result = await myLink.transact({transaction: myTx})\n     * ```\n     *\n     * @param args The action, actions or transaction to use.\n     * @param options Options for this transact call.\n     * @param transport Transport override, for internal use.\n     */\n    public async transact(\n        args: TransactArgs,\n        options?: TransactOptions,\n        transport?: LinkTransport\n    ): Promise<TransactResult> {\n        const t = transport || this.transport\n        const broadcast = options ? options.broadcast !== false : true\n        // Initialize the loading state of the transport\n        if (t && t.showLoading) {\n            t.showLoading()\n        }\n        // eosjs transact compat: upgrade to transaction if args have any header fields\n        let anyArgs = args as any\n        if (\n            args.actions &&\n            (anyArgs.expiration ||\n                anyArgs.ref_block_num ||\n                anyArgs.ref_block_prefix ||\n                anyArgs.max_net_usage_words ||\n                anyArgs.max_cpu_usage_ms ||\n                anyArgs.delay_sec)\n        ) {\n            args = {\n                transaction: {\n                    expiration: '1970-01-01T00:00:00',\n                    ref_block_num: 0,\n                    ref_block_prefix: 0,\n                    max_net_usage_words: 0,\n                    max_cpu_usage_ms: 0,\n                    delay_sec: 0,\n                    ...anyArgs,\n                },\n            }\n        }\n        const request = await this.createRequest(args, t)\n        const result = await this.sendRequest(request, t, broadcast)\n        return result\n    }\n\n    /**\n     * Send an identity request and verify the identity proof.\n     * Errors thrown in this function will not be shown via the onFailure modal from browser transport, but will still be lifted up to the frontend\n     * To catch these errors, place the ConnectWallet function call from @protonprotocal/proton-web-sdk into a try/catch block in the frontend\n     * In the case of a thrown error in this function, the sendRequest will still show the onSuccess modal\n     * @param requestPermission Optional request permission if the request is for a specific account or permission.\n     * @param info Metadata to add to the request.\n     * @note This is for advanced use-cases, you probably want to use [[Link.login]] instead.\n     */\n    public async identify(\n        requestPermission?: PermissionLevel,\n        info?: {[key: string]: string | Uint8Array}\n    ): Promise<IdentifyResult> {\n        const request = await this.createRequest({\n            identity: {permission: requestPermission || null},\n            info,\n        })\n        const res = await this.sendRequest(request)\n        if (!res.request.isIdentity()) {\n            throw new IdentityError(`Unexpected response`)\n        }\n        const message = Buffer.concat([\n            Buffer.from(request.getChainId(), 'hex'),\n            Buffer.from(res.serializedTransaction),\n            Buffer.alloc(32),\n        ])\n        const {signer} = res\n        const signerKey = Key.Signature.fromString(res.signatures[0]).recover(message).toLegacyString()\n        const account = await this.rpc.get_account(signer.actor)\n\n        if (requestPermission) {\n            if (\n                (requestPermission.actor !== esr.PlaceholderName &&\n                    requestPermission.actor !== signer.actor) ||\n                (requestPermission.permission !== esr.PlaceholderPermission &&\n                    requestPermission.permission !== signer.permission)\n            ) {\n                throw new IdentityError(\n                    `Unexpected identity proof from ${formatAuth(signer)}, expected ${formatAuth(\n                        requestPermission\n                    )} `\n                )\n            }\n        }\n        return {\n            ...res,\n            account,\n            signerKey,\n        }\n    }\n\n    /**\n     * The error checks in this function were taken out of Identify() to check for identity errors before onSuccess() is called in sendRequest()\n     * Using this function in sendRequest will allow any identity errors checked here to be shown via the brower transport onFailure modal\n     * @param res compliled result in sendRequest function\n     */\n    public async checkIdentity(res: TransactResult) {\n        const request = res.request\n        const message = Buffer.concat([\n            Buffer.from(request.getChainId(), 'hex'),\n            Buffer.from(res.serializedTransaction),\n            Buffer.alloc(32),\n        ])\n        const {signer} = res\n        const signerKey = Key.Signature.fromString(res.signatures[0]).recover(message).toLegacyString()\n        const account = await this.rpc.get_account(signer.actor)\n        if (!account) {\n            throw new IdentityError(`Signature from unknown account: ${signer.actor}`)\n        }\n\n        const permission = account.permissions.find(\n            ({perm_name}: any) => perm_name === signer.permission\n        )\n        if (!permission) {\n            throw new IdentityError(\n                `${signer.actor} signed for unknown permission: ${signer.permission}`\n            )\n        }\n\n        const auth = permission.required_auth\n        const keyAuth = auth.keys.find(({key}: any) => publicKeyEqual(key, signerKey))\n        if (!keyAuth) {\n            throw new IdentityError(`${formatAuth(signer)} has no key matching id signature`)\n        }\n        if (auth.threshold > keyAuth.weight) {\n            throw new IdentityError(`${formatAuth(signer)} signature does not reach auth threshold`)\n        }\n    }\n\n    /**\n     * Login and create a persistent session.\n     * @param identifier The session identifier, an EOSIO name (`[a-z1-5]{1,12}`).\n     *                   Should be set to the contract account if applicable.\n     */\n    public async login(identifier: string): Promise<LoginResult> {\n        const privateKey = await generatePrivateKey()\n        const requestKey = Key.PrivateKey.fromString(privateKey).getPublicKey().toLegacyString()\n        const createInfo: LinkCreate = {\n            session_name: identifier,\n            request_key: requestKey,\n        }\n        const res = await this.identify(undefined, {\n            link: abiEncode(createInfo, 'link_create'),\n        })\n        const metadata = {sameDevice: res.request.getRawInfo()['return_path'] !== undefined}\n        let session: LinkSession\n        if (res.payload.link_ch && res.payload.link_key && res.payload.link_name) {\n            session = new LinkChannelSession(\n                this,\n                {\n                    identifier,\n                    auth: res.signer,\n                    publicKey: res.signerKey,\n                    channel: {\n                        url: res.payload.link_ch,\n                        key: res.payload.link_key,\n                        name: res.payload.link_name,\n                    },\n                    requestKey: privateKey,\n                },\n                metadata\n            )\n        } else {\n            session = new LinkFallbackSession(\n                this,\n                {\n                    identifier,\n                    auth: res.signer,\n                    publicKey: res.signerKey,\n                },\n                metadata\n            )\n        }\n        if (this.storage) {\n            await this.storeSession(identifier, session)\n        }\n\n        if (session.auth.actor) {\n            const {rows} = await this.rpc.get_table_rows({\n                scope: 'eosio.proton',\n                code: 'eosio.proton',\n                json: true,\n                table: 'usersinfo',\n                lower_bound: session.auth.actor,\n                upper_bound: session.auth.actor,\n            })\n            if (rows && rows.length > 0) {\n                session.accountData = await this.rpc.isLightKYCVerified(rows);\n            }\n        }\n\n        // once successfully logged in, set wallet type so restore session can work properly\n        if (this.walletType.length > 0) {\n            this.storage!.write('wallet-type', this.walletType)\n        }\n\n        return {\n            ...res,\n            session,\n        }\n    }\n\n    /**\n     * Restore previous session, see [[Link.login]] to create a new session.\n     * @param identifier The session identifier, should be same as what was used when creating the session with [[Link.login]].\n     * @param auth A specific session auth to restore, if omitted the most recently used session will be restored.\n     * @returns A [[LinkSession]] instance or null if no session can be found.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session data.\n     **/\n    public async restoreSession(identifier: string, auth?: PermissionLevel) {\n        if (!this.storage) {\n            throw new Error('Unable to restore session: No storage adapter configured')\n        }\n        let key: string\n        if (auth) {\n            key = this.sessionKey(identifier, formatAuth(auth))\n        } else {\n            let latest = (await this.listSessions(identifier))[0]\n            if (!latest) {\n                return null\n            }\n            key = this.sessionKey(identifier, formatAuth(latest))\n        }\n        let data = await this.storage.read(key)\n        if (!data) {\n            return null\n        }\n        let sessionData: any\n        try {\n            sessionData = JSON.parse(data)\n        } catch (error) {\n            throw new Error(\n                `Unable to restore session: Stored JSON invalid (${error.message || String(error)})`\n            )\n        }\n        const session = LinkSession.restore(this, sessionData)\n        if (auth) {\n            // update latest used\n            await this.touchSession(identifier, auth)\n        }\n\n        if (session.auth.actor) {\n            const {rows} = await this.rpc.get_table_rows({\n                scope: 'eosio.proton',\n                code: 'eosio.proton',\n                json: true,\n                table: 'usersinfo',\n                lower_bound: session.auth.actor,\n                upper_bound: session.auth.actor,\n            })\n            if (rows && rows.length > 0) {\n                session.accountData = await this.rpc.isLightKYCVerified(rows);\n            }\n        }\n\n        return session\n    }\n\n    /**\n     * List stored session auths for given identifier.\n     * The most recently used session is at the top (index 0).\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session list.\n     **/\n    public async listSessions(identifier: string) {\n        if (!this.storage) {\n            throw new Error('Unable to list sessions: No storage adapter configured')\n        }\n        let key = this.sessionKey(identifier, 'list')\n        let list: PermissionLevel[]\n        try {\n            list = JSON.parse((await this.storage.read(key)) || '[]')\n        } catch (error) {\n            throw new Error(\n                `Unable to list sessions: Stored JSON invalid (${error.message || String(error)})`\n            )\n        }\n        return list\n    }\n\n    /**\n     * Remove stored session for given identifier and auth.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n    public async removeSession(identifier: string, auth: PermissionLevel) {\n        if (!this.storage) {\n            throw new Error('Unable to remove session: No storage adapter configured')\n        }\n        let key = this.sessionKey(identifier, formatAuth(auth))\n        await this.storage.remove(key)\n        await this.touchSession(identifier, auth, true)\n        if (await this.storage.read('wallet-type')) {\n            this.storage.remove('wallet-type')\n        }\n        if (await this.storage.read('user-auth')) {\n            this.storage.remove('user-auth')\n        }\n    }\n\n    /**\n     * Remove all stored sessions for given identifier.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n    public async clearSessions(identifier: string) {\n        if (!this.storage) {\n            throw new Error('Unable to clear sessions: No storage adapter configured')\n        }\n        for (const auth of await this.listSessions(identifier)) {\n            await this.removeSession(identifier, auth)\n        }\n    }\n\n    /**\n     * Create an eosjs compatible signature provider using this link.\n     * @param availableKeys Keys the created provider will claim to be able to sign for.\n     * @param transport (internal) Transport override for this call.\n     * @note We don't know what keys are available so those have to be provided,\n     *       to avoid this use [[LinkSession.makeSignatureProvider]] instead. Sessions can be created with [[Link.login]].\n     */\n    public makeSignatureProvider(\n        availableKeys: string[],\n        transport?: LinkTransport\n    ): ApiInterfaces.SignatureProvider {\n        return {\n            getAvailableKeys: async () => availableKeys,\n            sign: async (args) => {\n                const t = transport || this.transport\n                let request = esr.SigningRequest.fromTransaction(\n                    args.chainId,\n                    args.serializedTransaction,\n                    this.requestOptions\n                )\n                request.setCallback(this.createCallbackUrl(), true)\n                request.setBroadcast(false)\n                if (t.prepare) {\n                    request = await t.prepare(request)\n                }\n                const {serializedTransaction, signatures} = await this.sendRequest(request, t)\n                return {\n                    ...args,\n                    serializedTransaction,\n                    signatures,\n                }\n            },\n        }\n    }\n\n    /**\n     * Create an eosjs authority provider using this link.\n     * @note Uses the configured RPC Node's `/v1/chain/get_required_keys` API to resolve keys.\n     */\n    public makeAuthorityProvider(): ApiInterfaces.AuthorityProvider {\n        const {rpc} = this\n        return {\n            async getRequiredKeys(args: ApiInterfaces.AuthorityProviderArgs) {\n                const {availableKeys, transaction} = args\n                const result = await rpc.post('/v1/chain/get_required_keys', {\n                    transaction,\n                    available_keys: availableKeys.map(normalizePublicKey),\n                })\n                return result.required_keys.map(normalizePublicKey)\n            },\n        }\n    }\n\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n    private async touchSession(identifier: string, auth: PermissionLevel, remove = false) {\n        let auths = await this.listSessions(identifier)\n        let formattedAuth = formatAuth(auth)\n        let existing = auths.findIndex((a) => formatAuth(a) === formattedAuth)\n        if (existing >= 0) {\n            auths.splice(existing, 1)\n        }\n        let key = this.sessionKey(identifier, 'list')\n        if (remove === true) {\n            await this.storage!.remove(key)\n        } else {\n            auths.unshift(auth)\n            await this.storage!.write(key, JSON.stringify(auths))\n        }\n    }\n\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n    private async storeSession(identifier: string, session: LinkSession) {\n        let key = this.sessionKey(identifier, formatAuth(session.auth))\n        let data = JSON.stringify(session.serialize())\n        await this.storage!.write(key, data)\n        await this.touchSession(identifier, session.auth)\n    }\n\n    /** Session storage key for identifier and suffix. */\n    private sessionKey(identifier: string, suffix: string) {\n        return [this.chainId, identifier, suffix].join('-')\n    }\n}\n\n/**\n * Connect to a WebSocket channel and wait for a message.\n * @internal\n */\nfunction waitForCallback(url: string, ctx: {cancel?: () => void}) {\n    return new Promise<esr.CallbackPayload>((resolve, reject) => {\n        let active = true\n        let retries = 0\n        const socketUrl = url.replace(/^http/, 'ws')\n        const handleResponse = (response: string) => {\n            try {\n                resolve(JSON.parse(response))\n            } catch (error) {\n                error.message = 'Unable to parse callback JSON: ' + error.message\n                reject(error)\n            }\n        }\n        const connect = () => {\n            const socket = new WebSocket(socketUrl)\n            ctx.cancel = () => {\n                active = false\n                if (\n                    socket.readyState === WebSocket.OPEN ||\n                    socket.readyState === WebSocket.CONNECTING\n                ) {\n                    socket.close()\n                }\n            }\n            socket.onmessage = (event: any) => {\n                active = false\n                if (socket.readyState === WebSocket.OPEN) {\n                    socket.close()\n                }\n                if (typeof Blob !== 'undefined' && event.data instanceof Blob) {\n                    const reader = new FileReader()\n                    reader.onload = () => {\n                        handleResponse(reader.result as string)\n                    }\n                    reader.onerror = (error) => {\n                        reject(error)\n                    }\n                    reader.readAsText(event.data)\n                } else {\n                    if (typeof event.data === 'string') {\n                        handleResponse(event.data)\n                    } else if (event.data instanceof ArrayBuffer) {\n                        handleResponse(Buffer.from(event.data).toString())\n                    } else {\n                        handleResponse(event.data.toString())\n                    }\n                }\n            }\n            socket.onopen = () => {\n                retries = 0\n            }\n            socket.onerror = (_: any) => {}\n            socket.onclose = (_: any) => {\n                if (active) {\n                    setTimeout(connect, backoff(retries++))\n                }\n            }\n        }\n        connect()\n    })\n}\n\n/**\n * Exponential backoff function that caps off at 10s after 10 tries.\n * https://i.imgur.com/IrUDcJp.png\n * @internal\n */\nfunction backoff(tries: number): number {\n    return Math.min(Math.pow(tries * 10, 2), 10 * 1000)\n}\n\n/**\n * Format a EOSIO permission level in the format `actor@permission` taking placeholders into consideration.\n * @internal\n */\nfunction formatAuth(auth: PermissionLevel): string {\n    let {actor, permission} = auth\n    if (actor === esr.PlaceholderName) {\n        actor = '<any>'\n    }\n    if (permission === esr.PlaceholderName || permission === esr.PlaceholderPermission) {\n        permission = '<any>'\n    }\n    return `${actor}@${permission}`\n}"],"names":["runtime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","undefined","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","type","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","constructor","displayName","defineIteratorMethods","forEach","method","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","next","done","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","toString","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","object","reverse","length","pop","iterable","iteratorMethod","isNaN","i","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","CancelError","reason","IdentityError","SessionError","code","defaults","chainId","rpc","service","version","types","structs","base","fields","actions","ricardian_clauses","error_messages","tables","abi_extensions","Serialize","getTypesFromAbi","createInitialTypes","linkAbi","abiEncode","typeName","get","buf","SerialBuffer","serialize","asUint8Array","sealMessage","message","privateKey","publicKey","res","ecc","encrypt","data","from","nonce","ciphertext","checksum","normalizePublicKey","startsWith","Numeric","publicKeyToString","stringToPublicKey","substr","publicKeyEqual","keyA","keyB","generatePrivateKey","window","crypto","Uint32Array","getRandomValues","fromBuffer","Buffer","LinkSession","remove","link","storage","removeSession","identifier","auth","restore","LinkChannelSession","metadata","LinkFallbackSession","channel","request","encode","requestKey","timeout","onSuccess","transport","onFailure","onRequest","cancel","expiration","Date","now","toISOString","onSessionRequest","setTimeout","fetch","url","headers","toFixed","body","response","status","String","prepare","showLoading","makeSignatureProvider","makeAuthorityProvider","transact","args","options","Link","Map","JsonRpc","esr","serviceAddress","trim","replace","requestOptions","abiProvider","zlib","scheme","walletType","getAbi","account","rv","abiCache","pendingAbis","get_abi","set","abi","createCallbackUrl","uuid","createRequest","t","broadcast","callback","background","sendRequest","linkUrl","flags","ctx","socket","waitForCallback","rejected","_","race","payload","signer","actor","sa","permission","sp","signatures","filter","map","fromPayload","resolved","getInfo","unshift","serializedTransaction","transaction","push_transaction","processed","isIdentity","checkIdentity","anyArgs","ref_block_num","ref_block_prefix","max_net_usage_words","max_cpu_usage_ms","delay_sec","identify","requestPermission","identity","concat","getChainId","alloc","signerKey","Key","Signature","fromString","recover","toLegacyString","get_account","formatAuth","permissions","find","perm_name","required_auth","keyAuth","threshold","weight","login","PrivateKey","getPublicKey","createInfo","session_name","request_key","sameDevice","getRawInfo","link_ch","link_key","link_name","session","storeSession","get_table_rows","scope","json","table","lower_bound","upper_bound","rows","isLightKYCVerified","accountData","write","restoreSession","sessionKey","listSessions","latest","read","sessionData","JSON","parse","touchSession","list","clearSessions","availableKeys","getAvailableKeys","sign","fromTransaction","setCallback","setBroadcast","getRequiredKeys","post","available_keys","required_keys","auths","formattedAuth","existing","findIndex","a","splice","stringify","suffix","join","active","retries","socketUrl","handleResponse","connect","WebSocket","readyState","OPEN","CONNECTING","close","onmessage","event","Blob","reader","FileReader","onload","onerror","readAsText","ArrayBuffer","onopen","onclose","backoff","tries","Math","min","pow"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAIA,OAAO,GAAI,UAAUC,OAAV,EAAmB;;AAGhC,QAAIC,EAAE,GAAGC,MAAM,CAACC,SAAhB;AACA,QAAIC,MAAM,GAAGH,EAAE,CAACI,cAAhB;AACA,QAAIC,WAAJ,CALgC;;AAMhC,QAAIC,OAAO,GAAG,OAAOC,MAAP,KAAkB,UAAlB,GAA+BA,MAA/B,GAAwC,EAAtD;AACA,QAAIC,cAAc,GAAGF,OAAO,CAACG,QAAR,IAAoB,YAAzC;AACA,QAAIC,mBAAmB,GAAGJ,OAAO,CAACK,aAAR,IAAyB,iBAAnD;AACA,QAAIC,iBAAiB,GAAGN,OAAO,CAACO,WAAR,IAAuB,eAA/C;;AAEA,aAASC,MAAT,CAAgBC,GAAhB,EAAqBC,GAArB,EAA0BC,KAA1B,EAAiC;AAC/BhB,MAAAA,MAAM,CAACiB,cAAP,CAAsBH,GAAtB,EAA2BC,GAA3B,EAAgC;AAC9BC,QAAAA,KAAK,EAAEA,KADuB;AAE9BE,QAAAA,UAAU,EAAE,IAFkB;AAG9BC,QAAAA,YAAY,EAAE,IAHgB;AAI9BC,QAAAA,QAAQ,EAAE;AAJoB,OAAhC;AAMA,aAAON,GAAG,CAACC,GAAD,CAAV;AACD;;AACD,QAAI;;AAEFF,MAAAA,MAAM,CAAC,EAAD,EAAK,EAAL,CAAN;AACD,KAHD,CAGE,OAAOQ,GAAP,EAAY;AACZR,MAAAA,MAAM,GAAG,gBAASC,GAAT,EAAcC,GAAd,EAAmBC,KAAnB,EAA0B;AACjC,eAAOF,GAAG,CAACC,GAAD,CAAH,GAAWC,KAAlB;AACD,OAFD;AAGD;;AAED,aAASM,IAAT,CAAcC,OAAd,EAAuBC,OAAvB,EAAgCC,IAAhC,EAAsCC,WAAtC,EAAmD;;AAEjD,UAAIC,cAAc,GAAGH,OAAO,IAAIA,OAAO,CAACvB,SAAR,YAA6B2B,SAAxC,GAAoDJ,OAApD,GAA8DI,SAAnF;AACA,UAAIC,SAAS,GAAG7B,MAAM,CAAC8B,MAAP,CAAcH,cAAc,CAAC1B,SAA7B,CAAhB;AACA,UAAI8B,OAAO,GAAG,IAAIC,OAAJ,CAAYN,WAAW,IAAI,EAA3B,CAAd,CAJiD;;;AAQjDG,MAAAA,SAAS,CAACI,OAAV,GAAoBC,gBAAgB,CAACX,OAAD,EAAUE,IAAV,EAAgBM,OAAhB,CAApC;AAEA,aAAOF,SAAP;AACD;;AACD/B,IAAAA,OAAO,CAACwB,IAAR,GAAeA,IAAf,CAzCgC;;;;;;;;;;;AAqDhC,aAASa,QAAT,CAAkBC,EAAlB,EAAsBtB,GAAtB,EAA2BuB,GAA3B,EAAgC;AAC9B,UAAI;AACF,eAAO;AAAEC,UAAAA,IAAI,EAAE,QAAR;AAAkBD,UAAAA,GAAG,EAAED,EAAE,CAACG,IAAH,CAAQzB,GAAR,EAAauB,GAAb;AAAvB,SAAP;AACD,OAFD,CAEE,OAAOhB,GAAP,EAAY;AACZ,eAAO;AAAEiB,UAAAA,IAAI,EAAE,OAAR;AAAiBD,UAAAA,GAAG,EAAEhB;AAAtB,SAAP;AACD;AACF;;AAED,QAAImB,sBAAsB,GAAG,gBAA7B;AACA,QAAIC,sBAAsB,GAAG,gBAA7B;AACA,QAAIC,iBAAiB,GAAG,WAAxB;AACA,QAAIC,iBAAiB,GAAG,WAAxB,CAhEgC;;;AAoEhC,QAAIC,gBAAgB,GAAG,EAAvB,CApEgC;;;;;AA0EhC,aAAShB,SAAT,GAAqB;;AACrB,aAASiB,iBAAT,GAA6B;;AAC7B,aAASC,0BAAT,GAAsC,EA5EN;;;;AAgFhC,QAAIC,iBAAiB,GAAG,EAAxB;;AACAA,IAAAA,iBAAiB,CAACxC,cAAD,CAAjB,GAAoC,YAAY;AAC9C,aAAO,IAAP;AACD,KAFD;;AAIA,QAAIyC,QAAQ,GAAGhD,MAAM,CAACiD,cAAtB;AACA,QAAIC,uBAAuB,GAAGF,QAAQ,IAAIA,QAAQ,CAACA,QAAQ,CAACG,MAAM,CAAC,EAAD,CAAP,CAAT,CAAlD;;AACA,QAAID,uBAAuB,IACvBA,uBAAuB,KAAKnD,EAD5B,IAEAG,MAAM,CAACqC,IAAP,CAAYW,uBAAZ,EAAqC3C,cAArC,CAFJ,EAE0D;;;AAGxDwC,MAAAA,iBAAiB,GAAGG,uBAApB;AACD;;AAED,QAAIE,EAAE,GAAGN,0BAA0B,CAAC7C,SAA3B,GACP2B,SAAS,CAAC3B,SAAV,GAAsBD,MAAM,CAAC8B,MAAP,CAAciB,iBAAd,CADxB;AAEAF,IAAAA,iBAAiB,CAAC5C,SAAlB,GAA8BmD,EAAE,CAACC,WAAH,GAAiBP,0BAA/C;AACAA,IAAAA,0BAA0B,CAACO,WAA3B,GAAyCR,iBAAzC;AACAA,IAAAA,iBAAiB,CAACS,WAAlB,GAAgCzC,MAAM,CACpCiC,0BADoC,EAEpCnC,iBAFoC,EAGpC,mBAHoC,CAAtC,CAnGgC;;;AA2GhC,aAAS4C,qBAAT,CAA+BtD,SAA/B,EAA0C;AACxC,OAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4BuD,OAA5B,CAAoC,UAASC,MAAT,EAAiB;AACnD5C,QAAAA,MAAM,CAACZ,SAAD,EAAYwD,MAAZ,EAAoB,UAASpB,GAAT,EAAc;AACtC,iBAAO,KAAKJ,OAAL,CAAawB,MAAb,EAAqBpB,GAArB,CAAP;AACD,SAFK,CAAN;AAGD,OAJD;AAKD;;AAEDvC,IAAAA,OAAO,CAAC4D,mBAAR,GAA8B,UAASC,MAAT,EAAiB;AAC7C,UAAIC,IAAI,GAAG,OAAOD,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACN,WAAlD;AACA,aAAOO,IAAI,GACPA,IAAI,KAAKf,iBAAT;;AAGA,OAACe,IAAI,CAACN,WAAL,IAAoBM,IAAI,CAACC,IAA1B,MAAoC,mBAJ7B,GAKP,KALJ;AAMD,KARD;;AAUA/D,IAAAA,OAAO,CAACgE,IAAR,GAAe,UAASH,MAAT,EAAiB;AAC9B,UAAI3D,MAAM,CAAC+D,cAAX,EAA2B;AACzB/D,QAAAA,MAAM,CAAC+D,cAAP,CAAsBJ,MAAtB,EAA8Bb,0BAA9B;AACD,OAFD,MAEO;AACLa,QAAAA,MAAM,CAACK,SAAP,GAAmBlB,0BAAnB;AACAjC,QAAAA,MAAM,CAAC8C,MAAD,EAAShD,iBAAT,EAA4B,mBAA5B,CAAN;AACD;;AACDgD,MAAAA,MAAM,CAAC1D,SAAP,GAAmBD,MAAM,CAAC8B,MAAP,CAAcsB,EAAd,CAAnB;AACA,aAAOO,MAAP;AACD,KATD,CA7HgC;;;;;;AA4IhC7D,IAAAA,OAAO,CAACmE,KAAR,GAAgB,UAAS5B,GAAT,EAAc;AAC5B,aAAO;AAAE6B,QAAAA,OAAO,EAAE7B;AAAX,OAAP;AACD,KAFD;;AAIA,aAAS8B,aAAT,CAAuBtC,SAAvB,EAAkCuC,WAAlC,EAA+C;AAC7C,eAASC,MAAT,CAAgBZ,MAAhB,EAAwBpB,GAAxB,EAA6BiC,OAA7B,EAAsCC,MAAtC,EAA8C;AAC5C,YAAIC,MAAM,GAAGrC,QAAQ,CAACN,SAAS,CAAC4B,MAAD,CAAV,EAAoB5B,SAApB,EAA+BQ,GAA/B,CAArB;;AACA,YAAImC,MAAM,CAAClC,IAAP,KAAgB,OAApB,EAA6B;AAC3BiC,UAAAA,MAAM,CAACC,MAAM,CAACnC,GAAR,CAAN;AACD,SAFD,MAEO;AACL,cAAIoC,MAAM,GAAGD,MAAM,CAACnC,GAApB;AACA,cAAIrB,KAAK,GAAGyD,MAAM,CAACzD,KAAnB;;AACA,cAAIA,KAAK,IACL,OAAOA,KAAP,KAAiB,QADjB,IAEAd,MAAM,CAACqC,IAAP,CAAYvB,KAAZ,EAAmB,SAAnB,CAFJ,EAEmC;AACjC,mBAAOoD,WAAW,CAACE,OAAZ,CAAoBtD,KAAK,CAACkD,OAA1B,EAAmCQ,IAAnC,CAAwC,UAAS1D,KAAT,EAAgB;AAC7DqD,cAAAA,MAAM,CAAC,MAAD,EAASrD,KAAT,EAAgBsD,OAAhB,EAAyBC,MAAzB,CAAN;AACD,aAFM,EAEJ,UAASlD,GAAT,EAAc;AACfgD,cAAAA,MAAM,CAAC,OAAD,EAAUhD,GAAV,EAAeiD,OAAf,EAAwBC,MAAxB,CAAN;AACD,aAJM,CAAP;AAKD;;AAED,iBAAOH,WAAW,CAACE,OAAZ,CAAoBtD,KAApB,EAA2B0D,IAA3B,CAAgC,UAASC,SAAT,EAAoB;;;;AAIzDF,YAAAA,MAAM,CAACzD,KAAP,GAAe2D,SAAf;AACAL,YAAAA,OAAO,CAACG,MAAD,CAAP;AACD,WANM,EAMJ,UAASG,KAAT,EAAgB;;;AAGjB,mBAAOP,MAAM,CAAC,OAAD,EAAUO,KAAV,EAAiBN,OAAjB,EAA0BC,MAA1B,CAAb;AACD,WAVM,CAAP;AAWD;AACF;;AAED,UAAIM,eAAJ;;AAEA,eAASC,OAAT,CAAiBrB,MAAjB,EAAyBpB,GAAzB,EAA8B;AAC5B,iBAAS0C,0BAAT,GAAsC;AACpC,iBAAO,IAAIX,WAAJ,CAAgB,UAASE,OAAT,EAAkBC,MAAlB,EAA0B;AAC/CF,YAAAA,MAAM,CAACZ,MAAD,EAASpB,GAAT,EAAciC,OAAd,EAAuBC,MAAvB,CAAN;AACD,WAFM,CAAP;AAGD;;AAED,eAAOM,eAAe;;;;;;;;;;;;AAapBA,QAAAA,eAAe,GAAGA,eAAe,CAACH,IAAhB,CAChBK,0BADgB;;AAIhBA,QAAAA,0BAJgB,CAAH,GAKXA,0BAA0B,EAlBhC;AAmBD,OA5D4C;;;;AAgE7C,WAAK9C,OAAL,GAAe6C,OAAf;AACD;;AAEDvB,IAAAA,qBAAqB,CAACY,aAAa,CAAClE,SAAf,CAArB;;AACAkE,IAAAA,aAAa,CAAClE,SAAd,CAAwBQ,mBAAxB,IAA+C,YAAY;AACzD,aAAO,IAAP;AACD,KAFD;;AAGAX,IAAAA,OAAO,CAACqE,aAAR,GAAwBA,aAAxB,CAvNgC;;;;AA4NhCrE,IAAAA,OAAO,CAACkF,KAAR,GAAgB,UAASzD,OAAT,EAAkBC,OAAlB,EAA2BC,IAA3B,EAAiCC,WAAjC,EAA8C0C,WAA9C,EAA2D;AACzE,UAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4BA,WAAW,GAAGa,OAAd;AAE5B,UAAIC,IAAI,GAAG,IAAIf,aAAJ,CACT7C,IAAI,CAACC,OAAD,EAAUC,OAAV,EAAmBC,IAAnB,EAAyBC,WAAzB,CADK,EAET0C,WAFS,CAAX;AAKA,aAAOtE,OAAO,CAAC4D,mBAAR,CAA4BlC,OAA5B,IACH0D,IADG;AAAA,QAEHA,IAAI,CAACC,IAAL,GAAYT,IAAZ,CAAiB,UAASD,MAAT,EAAiB;AAChC,eAAOA,MAAM,CAACW,IAAP,GAAcX,MAAM,CAACzD,KAArB,GAA6BkE,IAAI,CAACC,IAAL,EAApC;AACD,OAFD,CAFJ;AAKD,KAbD;;AAeA,aAASjD,gBAAT,CAA0BX,OAA1B,EAAmCE,IAAnC,EAAyCM,OAAzC,EAAkD;AAChD,UAAIsD,KAAK,GAAG7C,sBAAZ;AAEA,aAAO,SAAS6B,MAAT,CAAgBZ,MAAhB,EAAwBpB,GAAxB,EAA6B;AAClC,YAAIgD,KAAK,KAAK3C,iBAAd,EAAiC;AAC/B,gBAAM,IAAI4C,KAAJ,CAAU,8BAAV,CAAN;AACD;;AAED,YAAID,KAAK,KAAK1C,iBAAd,EAAiC;AAC/B,cAAIc,MAAM,KAAK,OAAf,EAAwB;AACtB,kBAAMpB,GAAN;AACD,WAH8B;;;;AAO/B,iBAAOkD,UAAU,EAAjB;AACD;;AAEDxD,QAAAA,OAAO,CAAC0B,MAAR,GAAiBA,MAAjB;AACA1B,QAAAA,OAAO,CAACM,GAAR,GAAcA,GAAd;;AAEA,eAAO,IAAP,EAAa;AACX,cAAImD,QAAQ,GAAGzD,OAAO,CAACyD,QAAvB;;AACA,cAAIA,QAAJ,EAAc;AACZ,gBAAIC,cAAc,GAAGC,mBAAmB,CAACF,QAAD,EAAWzD,OAAX,CAAxC;;AACA,gBAAI0D,cAAJ,EAAoB;AAClB,kBAAIA,cAAc,KAAK7C,gBAAvB,EAAyC;AACzC,qBAAO6C,cAAP;AACD;AACF;;AAED,cAAI1D,OAAO,CAAC0B,MAAR,KAAmB,MAAvB,EAA+B;;;AAG7B1B,YAAAA,OAAO,CAAC4D,IAAR,GAAe5D,OAAO,CAAC6D,KAAR,GAAgB7D,OAAO,CAACM,GAAvC;AAED,WALD,MAKO,IAAIN,OAAO,CAAC0B,MAAR,KAAmB,OAAvB,EAAgC;AACrC,gBAAI4B,KAAK,KAAK7C,sBAAd,EAAsC;AACpC6C,cAAAA,KAAK,GAAG1C,iBAAR;AACA,oBAAMZ,OAAO,CAACM,GAAd;AACD;;AAEDN,YAAAA,OAAO,CAAC8D,iBAAR,CAA0B9D,OAAO,CAACM,GAAlC;AAED,WARM,MAQA,IAAIN,OAAO,CAAC0B,MAAR,KAAmB,QAAvB,EAAiC;AACtC1B,YAAAA,OAAO,CAAC+D,MAAR,CAAe,QAAf,EAAyB/D,OAAO,CAACM,GAAjC;AACD;;AAEDgD,UAAAA,KAAK,GAAG3C,iBAAR;AAEA,cAAI8B,MAAM,GAAGrC,QAAQ,CAACZ,OAAD,EAAUE,IAAV,EAAgBM,OAAhB,CAArB;;AACA,cAAIyC,MAAM,CAAClC,IAAP,KAAgB,QAApB,EAA8B;;;AAG5B+C,YAAAA,KAAK,GAAGtD,OAAO,CAACqD,IAAR,GACJzC,iBADI,GAEJF,sBAFJ;;AAIA,gBAAI+B,MAAM,CAACnC,GAAP,KAAeO,gBAAnB,EAAqC;AACnC;AACD;;AAED,mBAAO;AACL5B,cAAAA,KAAK,EAAEwD,MAAM,CAACnC,GADT;AAEL+C,cAAAA,IAAI,EAAErD,OAAO,CAACqD;AAFT,aAAP;AAKD,WAhBD,MAgBO,IAAIZ,MAAM,CAAClC,IAAP,KAAgB,OAApB,EAA6B;AAClC+C,YAAAA,KAAK,GAAG1C,iBAAR,CADkC;;;AAIlCZ,YAAAA,OAAO,CAAC0B,MAAR,GAAiB,OAAjB;AACA1B,YAAAA,OAAO,CAACM,GAAR,GAAcmC,MAAM,CAACnC,GAArB;AACD;AACF;AACF,OAxED;AAyED,KAvT+B;;;;;;AA6ThC,aAASqD,mBAAT,CAA6BF,QAA7B,EAAuCzD,OAAvC,EAAgD;AAC9C,UAAI0B,MAAM,GAAG+B,QAAQ,CAAChF,QAAT,CAAkBuB,OAAO,CAAC0B,MAA1B,CAAb;;AACA,UAAIA,MAAM,KAAKrD,WAAf,EAA0B;;;AAGxB2B,QAAAA,OAAO,CAACyD,QAAR,GAAmB,IAAnB;;AAEA,YAAIzD,OAAO,CAAC0B,MAAR,KAAmB,OAAvB,EAAgC;;AAE9B,cAAI+B,QAAQ,CAAChF,QAAT,CAAkB,QAAlB,CAAJ,EAAiC;;;AAG/BuB,YAAAA,OAAO,CAAC0B,MAAR,GAAiB,QAAjB;AACA1B,YAAAA,OAAO,CAACM,GAAR,GAAcjC,WAAd;AACAsF,YAAAA,mBAAmB,CAACF,QAAD,EAAWzD,OAAX,CAAnB;;AAEA,gBAAIA,OAAO,CAAC0B,MAAR,KAAmB,OAAvB,EAAgC;;;AAG9B,qBAAOb,gBAAP;AACD;AACF;;AAEDb,UAAAA,OAAO,CAAC0B,MAAR,GAAiB,OAAjB;AACA1B,UAAAA,OAAO,CAACM,GAAR,GAAc,IAAI0D,SAAJ,CACZ,gDADY,CAAd;AAED;;AAED,eAAOnD,gBAAP;AACD;;AAED,UAAI4B,MAAM,GAAGrC,QAAQ,CAACsB,MAAD,EAAS+B,QAAQ,CAAChF,QAAlB,EAA4BuB,OAAO,CAACM,GAApC,CAArB;;AAEA,UAAImC,MAAM,CAAClC,IAAP,KAAgB,OAApB,EAA6B;AAC3BP,QAAAA,OAAO,CAAC0B,MAAR,GAAiB,OAAjB;AACA1B,QAAAA,OAAO,CAACM,GAAR,GAAcmC,MAAM,CAACnC,GAArB;AACAN,QAAAA,OAAO,CAACyD,QAAR,GAAmB,IAAnB;AACA,eAAO5C,gBAAP;AACD;;AAED,UAAIoD,IAAI,GAAGxB,MAAM,CAACnC,GAAlB;;AAEA,UAAI,CAAE2D,IAAN,EAAY;AACVjE,QAAAA,OAAO,CAAC0B,MAAR,GAAiB,OAAjB;AACA1B,QAAAA,OAAO,CAACM,GAAR,GAAc,IAAI0D,SAAJ,CAAc,kCAAd,CAAd;AACAhE,QAAAA,OAAO,CAACyD,QAAR,GAAmB,IAAnB;AACA,eAAO5C,gBAAP;AACD;;AAED,UAAIoD,IAAI,CAACZ,IAAT,EAAe;;;AAGbrD,QAAAA,OAAO,CAACyD,QAAQ,CAACS,UAAV,CAAP,GAA+BD,IAAI,CAAChF,KAApC,CAHa;;AAMbe,QAAAA,OAAO,CAACoD,IAAR,GAAeK,QAAQ,CAACU,OAAxB,CANa;;;;;;;AAcb,YAAInE,OAAO,CAAC0B,MAAR,KAAmB,QAAvB,EAAiC;AAC/B1B,UAAAA,OAAO,CAAC0B,MAAR,GAAiB,MAAjB;AACA1B,UAAAA,OAAO,CAACM,GAAR,GAAcjC,WAAd;AACD;AAEF,OAnBD,MAmBO;;AAEL,eAAO4F,IAAP;AACD,OAvE6C;;;;AA2E9CjE,MAAAA,OAAO,CAACyD,QAAR,GAAmB,IAAnB;AACA,aAAO5C,gBAAP;AACD,KA1Y+B;;;;AA8YhCW,IAAAA,qBAAqB,CAACH,EAAD,CAArB;AAEAvC,IAAAA,MAAM,CAACuC,EAAD,EAAKzC,iBAAL,EAAwB,WAAxB,CAAN,CAhZgC;;;;;;AAuZhCyC,IAAAA,EAAE,CAAC7C,cAAD,CAAF,GAAqB,YAAW;AAC9B,aAAO,IAAP;AACD,KAFD;;AAIA6C,IAAAA,EAAE,CAAC+C,QAAH,GAAc,YAAW;AACvB,aAAO,oBAAP;AACD,KAFD;;AAIA,aAASC,YAAT,CAAsBC,IAAtB,EAA4B;AAC1B,UAAIC,KAAK,GAAG;AAAEC,QAAAA,MAAM,EAAEF,IAAI,CAAC,CAAD;AAAd,OAAZ;;AAEA,UAAI,KAAKA,IAAT,EAAe;AACbC,QAAAA,KAAK,CAACE,QAAN,GAAiBH,IAAI,CAAC,CAAD,CAArB;AACD;;AAED,UAAI,KAAKA,IAAT,EAAe;AACbC,QAAAA,KAAK,CAACG,UAAN,GAAmBJ,IAAI,CAAC,CAAD,CAAvB;AACAC,QAAAA,KAAK,CAACI,QAAN,GAAiBL,IAAI,CAAC,CAAD,CAArB;AACD;;AAED,WAAKM,UAAL,CAAgBC,IAAhB,CAAqBN,KAArB;AACD;;AAED,aAASO,aAAT,CAAuBP,KAAvB,EAA8B;AAC5B,UAAI9B,MAAM,GAAG8B,KAAK,CAACQ,UAAN,IAAoB,EAAjC;AACAtC,MAAAA,MAAM,CAAClC,IAAP,GAAc,QAAd;AACA,aAAOkC,MAAM,CAACnC,GAAd;AACAiE,MAAAA,KAAK,CAACQ,UAAN,GAAmBtC,MAAnB;AACD;;AAED,aAASxC,OAAT,CAAiBN,WAAjB,EAA8B;;;;AAI5B,WAAKiF,UAAL,GAAkB,CAAC;AAAEJ,QAAAA,MAAM,EAAE;AAAV,OAAD,CAAlB;AACA7E,MAAAA,WAAW,CAAC8B,OAAZ,CAAoB4C,YAApB,EAAkC,IAAlC;AACA,WAAKW,KAAL,CAAW,IAAX;AACD;;AAEDjH,IAAAA,OAAO,CAACkH,IAAR,GAAe,UAASC,MAAT,EAAiB;AAC9B,UAAID,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIjG,GAAT,IAAgBkG,MAAhB,EAAwB;AACtBD,QAAAA,IAAI,CAACJ,IAAL,CAAU7F,GAAV;AACD;;AACDiG,MAAAA,IAAI,CAACE,OAAL,GAL8B;;;AAS9B,aAAO,SAAS/B,IAAT,GAAgB;AACrB,eAAO6B,IAAI,CAACG,MAAZ,EAAoB;AAClB,cAAIpG,GAAG,GAAGiG,IAAI,CAACI,GAAL,EAAV;;AACA,cAAIrG,GAAG,IAAIkG,MAAX,EAAmB;AACjB9B,YAAAA,IAAI,CAACnE,KAAL,GAAaD,GAAb;AACAoE,YAAAA,IAAI,CAACC,IAAL,GAAY,KAAZ;AACA,mBAAOD,IAAP;AACD;AACF,SARoB;;;;;AAarBA,QAAAA,IAAI,CAACC,IAAL,GAAY,IAAZ;AACA,eAAOD,IAAP;AACD,OAfD;AAgBD,KAzBD;;AA2BA,aAAShC,MAAT,CAAgBkE,QAAhB,EAA0B;AACxB,UAAIA,QAAJ,EAAc;AACZ,YAAIC,cAAc,GAAGD,QAAQ,CAAC9G,cAAD,CAA7B;;AACA,YAAI+G,cAAJ,EAAoB;AAClB,iBAAOA,cAAc,CAAC/E,IAAf,CAAoB8E,QAApB,CAAP;AACD;;AAED,YAAI,OAAOA,QAAQ,CAAClC,IAAhB,KAAyB,UAA7B,EAAyC;AACvC,iBAAOkC,QAAP;AACD;;AAED,YAAI,CAACE,KAAK,CAACF,QAAQ,CAACF,MAAV,CAAV,EAA6B;AAC3B,cAAIK,CAAC,GAAG,CAAC,CAAT;AAAA,cAAYrC,IAAI,GAAG,SAASA,IAAT,GAAgB;AACjC,mBAAO,EAAEqC,CAAF,GAAMH,QAAQ,CAACF,MAAtB,EAA8B;AAC5B,kBAAIjH,MAAM,CAACqC,IAAP,CAAY8E,QAAZ,EAAsBG,CAAtB,CAAJ,EAA8B;AAC5BrC,gBAAAA,IAAI,CAACnE,KAAL,GAAaqG,QAAQ,CAACG,CAAD,CAArB;AACArC,gBAAAA,IAAI,CAACC,IAAL,GAAY,KAAZ;AACA,uBAAOD,IAAP;AACD;AACF;;AAEDA,YAAAA,IAAI,CAACnE,KAAL,GAAaZ,WAAb;AACA+E,YAAAA,IAAI,CAACC,IAAL,GAAY,IAAZ;AAEA,mBAAOD,IAAP;AACD,WAbD;;AAeA,iBAAOA,IAAI,CAACA,IAAL,GAAYA,IAAnB;AACD;AACF,OA7BuB;;;AAgCxB,aAAO;AAAEA,QAAAA,IAAI,EAAEI;AAAR,OAAP;AACD;;AACDzF,IAAAA,OAAO,CAACqD,MAAR,GAAiBA,MAAjB;;AAEA,aAASoC,UAAT,GAAsB;AACpB,aAAO;AAAEvE,QAAAA,KAAK,EAAEZ,WAAT;AAAoBgF,QAAAA,IAAI,EAAE;AAA1B,OAAP;AACD;;AAEDpD,IAAAA,OAAO,CAAC/B,SAAR,GAAoB;AAClBoD,MAAAA,WAAW,EAAErB,OADK;AAGlB+E,MAAAA,KAAK,EAAE,eAASU,aAAT,EAAwB;AAC7B,aAAKC,IAAL,GAAY,CAAZ;AACA,aAAKvC,IAAL,GAAY,CAAZ,CAF6B;;;AAK7B,aAAKQ,IAAL,GAAY,KAAKC,KAAL,GAAaxF,WAAzB;AACA,aAAKgF,IAAL,GAAY,KAAZ;AACA,aAAKI,QAAL,GAAgB,IAAhB;AAEA,aAAK/B,MAAL,GAAc,MAAd;AACA,aAAKpB,GAAL,GAAWjC,WAAX;AAEA,aAAKuG,UAAL,CAAgBnD,OAAhB,CAAwBqD,aAAxB;;AAEA,YAAI,CAACY,aAAL,EAAoB;AAClB,eAAK,IAAI5D,IAAT,IAAiB,IAAjB,EAAuB;;AAErB,gBAAIA,IAAI,CAAC8D,MAAL,CAAY,CAAZ,MAAmB,GAAnB,IACAzH,MAAM,CAACqC,IAAP,CAAY,IAAZ,EAAkBsB,IAAlB,CADA,IAEA,CAAC0D,KAAK,CAAC,CAAC1D,IAAI,CAAC+D,KAAL,CAAW,CAAX,CAAF,CAFV,EAE4B;AAC1B,mBAAK/D,IAAL,IAAazD,WAAb;AACD;AACF;AACF;AACF,OA3BiB;AA6BlByH,MAAAA,IAAI,EAAE,gBAAW;AACf,aAAKzC,IAAL,GAAY,IAAZ;AAEA,YAAI0C,SAAS,GAAG,KAAKnB,UAAL,CAAgB,CAAhB,CAAhB;AACA,YAAIoB,UAAU,GAAGD,SAAS,CAAChB,UAA3B;;AACA,YAAIiB,UAAU,CAACzF,IAAX,KAAoB,OAAxB,EAAiC;AAC/B,gBAAMyF,UAAU,CAAC1F,GAAjB;AACD;;AAED,eAAO,KAAK2F,IAAZ;AACD,OAvCiB;AAyClBnC,MAAAA,iBAAiB,EAAE,2BAASoC,SAAT,EAAoB;AACrC,YAAI,KAAK7C,IAAT,EAAe;AACb,gBAAM6C,SAAN;AACD;;AAED,YAAIlG,OAAO,GAAG,IAAd;;AACA,iBAASmG,MAAT,CAAgBC,GAAhB,EAAqBC,MAArB,EAA6B;AAC3B5D,UAAAA,MAAM,CAAClC,IAAP,GAAc,OAAd;AACAkC,UAAAA,MAAM,CAACnC,GAAP,GAAa4F,SAAb;AACAlG,UAAAA,OAAO,CAACoD,IAAR,GAAegD,GAAf;;AAEA,cAAIC,MAAJ,EAAY;;;AAGVrG,YAAAA,OAAO,CAAC0B,MAAR,GAAiB,MAAjB;AACA1B,YAAAA,OAAO,CAACM,GAAR,GAAcjC,WAAd;AACD;;AAED,iBAAO,CAAC,CAAEgI,MAAV;AACD;;AAED,aAAK,IAAIZ,CAAC,GAAG,KAAKb,UAAL,CAAgBQ,MAAhB,GAAyB,CAAtC,EAAyCK,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIlB,KAAK,GAAG,KAAKK,UAAL,CAAgBa,CAAhB,CAAZ;AACA,cAAIhD,MAAM,GAAG8B,KAAK,CAACQ,UAAnB;;AAEA,cAAIR,KAAK,CAACC,MAAN,KAAiB,MAArB,EAA6B;;;;AAI3B,mBAAO2B,MAAM,CAAC,KAAD,CAAb;AACD;;AAED,cAAI5B,KAAK,CAACC,MAAN,IAAgB,KAAKmB,IAAzB,EAA+B;AAC7B,gBAAIW,QAAQ,GAAGnI,MAAM,CAACqC,IAAP,CAAY+D,KAAZ,EAAmB,UAAnB,CAAf;AACA,gBAAIgC,UAAU,GAAGpI,MAAM,CAACqC,IAAP,CAAY+D,KAAZ,EAAmB,YAAnB,CAAjB;;AAEA,gBAAI+B,QAAQ,IAAIC,UAAhB,EAA4B;AAC1B,kBAAI,KAAKZ,IAAL,GAAYpB,KAAK,CAACE,QAAtB,EAAgC;AAC9B,uBAAO0B,MAAM,CAAC5B,KAAK,CAACE,QAAP,EAAiB,IAAjB,CAAb;AACD,eAFD,MAEO,IAAI,KAAKkB,IAAL,GAAYpB,KAAK,CAACG,UAAtB,EAAkC;AACvC,uBAAOyB,MAAM,CAAC5B,KAAK,CAACG,UAAP,CAAb;AACD;AAEF,aAPD,MAOO,IAAI4B,QAAJ,EAAc;AACnB,kBAAI,KAAKX,IAAL,GAAYpB,KAAK,CAACE,QAAtB,EAAgC;AAC9B,uBAAO0B,MAAM,CAAC5B,KAAK,CAACE,QAAP,EAAiB,IAAjB,CAAb;AACD;AAEF,aALM,MAKA,IAAI8B,UAAJ,EAAgB;AACrB,kBAAI,KAAKZ,IAAL,GAAYpB,KAAK,CAACG,UAAtB,EAAkC;AAChC,uBAAOyB,MAAM,CAAC5B,KAAK,CAACG,UAAP,CAAb;AACD;AAEF,aALM,MAKA;AACL,oBAAM,IAAInB,KAAJ,CAAU,wCAAV,CAAN;AACD;AACF;AACF;AACF,OAnGiB;AAqGlBQ,MAAAA,MAAM,EAAE,gBAASxD,IAAT,EAAeD,GAAf,EAAoB;AAC1B,aAAK,IAAImF,CAAC,GAAG,KAAKb,UAAL,CAAgBQ,MAAhB,GAAyB,CAAtC,EAAyCK,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIlB,KAAK,GAAG,KAAKK,UAAL,CAAgBa,CAAhB,CAAZ;;AACA,cAAIlB,KAAK,CAACC,MAAN,IAAgB,KAAKmB,IAArB,IACAxH,MAAM,CAACqC,IAAP,CAAY+D,KAAZ,EAAmB,YAAnB,CADA,IAEA,KAAKoB,IAAL,GAAYpB,KAAK,CAACG,UAFtB,EAEkC;AAChC,gBAAI8B,YAAY,GAAGjC,KAAnB;AACA;AACD;AACF;;AAED,YAAIiC,YAAY,KACXjG,IAAI,KAAK,OAAT,IACAA,IAAI,KAAK,UAFE,CAAZ,IAGAiG,YAAY,CAAChC,MAAb,IAAuBlE,GAHvB,IAIAA,GAAG,IAAIkG,YAAY,CAAC9B,UAJxB,EAIoC;;;AAGlC8B,UAAAA,YAAY,GAAG,IAAf;AACD;;AAED,YAAI/D,MAAM,GAAG+D,YAAY,GAAGA,YAAY,CAACzB,UAAhB,GAA6B,EAAtD;AACAtC,QAAAA,MAAM,CAAClC,IAAP,GAAcA,IAAd;AACAkC,QAAAA,MAAM,CAACnC,GAAP,GAAaA,GAAb;;AAEA,YAAIkG,YAAJ,EAAkB;AAChB,eAAK9E,MAAL,GAAc,MAAd;AACA,eAAK0B,IAAL,GAAYoD,YAAY,CAAC9B,UAAzB;AACA,iBAAO7D,gBAAP;AACD;;AAED,eAAO,KAAK4F,QAAL,CAAchE,MAAd,CAAP;AACD,OArIiB;AAuIlBgE,MAAAA,QAAQ,EAAE,kBAAShE,MAAT,EAAiBkC,QAAjB,EAA2B;AACnC,YAAIlC,MAAM,CAAClC,IAAP,KAAgB,OAApB,EAA6B;AAC3B,gBAAMkC,MAAM,CAACnC,GAAb;AACD;;AAED,YAAImC,MAAM,CAAClC,IAAP,KAAgB,OAAhB,IACAkC,MAAM,CAAClC,IAAP,KAAgB,UADpB,EACgC;AAC9B,eAAK6C,IAAL,GAAYX,MAAM,CAACnC,GAAnB;AACD,SAHD,MAGO,IAAImC,MAAM,CAAClC,IAAP,KAAgB,QAApB,EAA8B;AACnC,eAAK0F,IAAL,GAAY,KAAK3F,GAAL,GAAWmC,MAAM,CAACnC,GAA9B;AACA,eAAKoB,MAAL,GAAc,QAAd;AACA,eAAK0B,IAAL,GAAY,KAAZ;AACD,SAJM,MAIA,IAAIX,MAAM,CAAClC,IAAP,KAAgB,QAAhB,IAA4BoE,QAAhC,EAA0C;AAC/C,eAAKvB,IAAL,GAAYuB,QAAZ;AACD;;AAED,eAAO9D,gBAAP;AACD,OAxJiB;AA0JlB6F,MAAAA,MAAM,EAAE,gBAAShC,UAAT,EAAqB;AAC3B,aAAK,IAAIe,CAAC,GAAG,KAAKb,UAAL,CAAgBQ,MAAhB,GAAyB,CAAtC,EAAyCK,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIlB,KAAK,GAAG,KAAKK,UAAL,CAAgBa,CAAhB,CAAZ;;AACA,cAAIlB,KAAK,CAACG,UAAN,KAAqBA,UAAzB,EAAqC;AACnC,iBAAK+B,QAAL,CAAclC,KAAK,CAACQ,UAApB,EAAgCR,KAAK,CAACI,QAAtC;AACAG,YAAAA,aAAa,CAACP,KAAD,CAAb;AACA,mBAAO1D,gBAAP;AACD;AACF;AACF,OAnKiB;AAqKlB,eAAS,gBAAS2D,MAAT,EAAiB;AACxB,aAAK,IAAIiB,CAAC,GAAG,KAAKb,UAAL,CAAgBQ,MAAhB,GAAyB,CAAtC,EAAyCK,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIlB,KAAK,GAAG,KAAKK,UAAL,CAAgBa,CAAhB,CAAZ;;AACA,cAAIlB,KAAK,CAACC,MAAN,KAAiBA,MAArB,EAA6B;AAC3B,gBAAI/B,MAAM,GAAG8B,KAAK,CAACQ,UAAnB;;AACA,gBAAItC,MAAM,CAAClC,IAAP,KAAgB,OAApB,EAA6B;AAC3B,kBAAIoG,MAAM,GAAGlE,MAAM,CAACnC,GAApB;AACAwE,cAAAA,aAAa,CAACP,KAAD,CAAb;AACD;;AACD,mBAAOoC,MAAP;AACD;AACF,SAXuB;;;;AAexB,cAAM,IAAIpD,KAAJ,CAAU,uBAAV,CAAN;AACD,OArLiB;AAuLlBqD,MAAAA,aAAa,EAAE,uBAAStB,QAAT,EAAmBpB,UAAnB,EAA+BC,OAA/B,EAAwC;AACrD,aAAKV,QAAL,GAAgB;AACdhF,UAAAA,QAAQ,EAAE2C,MAAM,CAACkE,QAAD,CADF;AAEdpB,UAAAA,UAAU,EAAEA,UAFE;AAGdC,UAAAA,OAAO,EAAEA;AAHK,SAAhB;;AAMA,YAAI,KAAKzC,MAAL,KAAgB,MAApB,EAA4B;;;AAG1B,eAAKpB,GAAL,GAAWjC,WAAX;AACD;;AAED,eAAOwC,gBAAP;AACD;AArMiB,KAApB,CAjgBgC;;;;;AA6sBhC,WAAO9C,OAAP;AAED,GA/sBc;;;;AAotBb,GAA6B8I,MAAM,CAAC9I,OAApC,CAptBa,CAAf;;AAutBA,MAAI;AACF+I,IAAAA,kBAAkB,GAAGhJ,OAArB;AACD,GAFD,CAEE,OAAOiJ,oBAAP,EAA6B;;;;;;;;;;AAU7BC,IAAAA,QAAQ,CAAC,GAAD,EAAM,wBAAN,CAAR,CAAwClJ,OAAxC;;;;ACjuBF;;;;AAIA,IAAamJ,WAAb;AAAA;;AAEI,uBAAYC,MAAZ;;;AACI,0DAA+BA,MAAM,GAAG,MAAMA,MAAN,GAAe,GAAlB,GAAwB,EAA7D;AAFG,cAAA,GAAO,UAAP;;AAGN;;AAJL;AAAA,iCAAiC3D,KAAjC;AAOA;;;;;AAIA,IAAa4D,aAAb;AAAA;;AAEI,yBAAYD,MAAZ;;;AACI,gEAAmCA,MAAM,GAAG,MAAMA,MAAN,GAAe,GAAlB,GAAwB,EAAjE;AAFG,eAAA,GAAO,YAAP;;AAGN;;AAJL;AAAA,iCAAmC3D,KAAnC;AAOA;;;;;AAIA,IAAa6D,YAAb;AAAA;;AAEI,wBAAYF,MAAZ,EAA4BG,IAA5B;;;AACI,gCAAMH,MAAN;AACA,WAAKG,IAAL,GAAYA,IAAZ;;AACH;;AALL;AAAA,iCAAkC9D,KAAlC;;ACSA;AACA,AAAO,IAAM+D,QAAQ,GAAG;AACpBC,EAAAA,OAAO,EAAE,kEADW;AAEpBC,EAAAA,GAAG,EAAE,6BAFe;AAGpBC,EAAAA,OAAO,EAAE;AAHW,CAAjB;;AC7CP,cAAe;AACXC,EAAAA,OAAO,EAAE,gBADE;AAEXC,EAAAA,KAAK,EAAE,EAFI;AAGXC,EAAAA,OAAO,EAAE,CACL;AACI9F,IAAAA,IAAI,EAAE,gBADV;AAEI+F,IAAAA,IAAI,EAAE,EAFV;AAGIC,IAAAA,MAAM,EAAE,CACJ;AACIhG,MAAAA,IAAI,EAAE,MADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KADI,EAKJ;AACIuB,MAAAA,IAAI,EAAE,OADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KALI,EASJ;AACIuB,MAAAA,IAAI,EAAE,YADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KATI,EAaJ;AACIuB,MAAAA,IAAI,EAAE,UADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KAbI;AAHZ,GADK,EAuBL;AACIuB,IAAAA,IAAI,EAAE,aADV;AAEI+F,IAAAA,IAAI,EAAE,EAFV;AAGIC,IAAAA,MAAM,EAAE,CACJ;AACIhG,MAAAA,IAAI,EAAE,cADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KADI,EAKJ;AACIuB,MAAAA,IAAI,EAAE,aADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KALI;AAHZ,GAvBK,EAqCL;AACIuB,IAAAA,IAAI,EAAE,WADV;AAEI+F,IAAAA,IAAI,EAAE,EAFV;AAGIC,IAAAA,MAAM,EAAE,CACJ;AACIhG,MAAAA,IAAI,EAAE,YADV;AAEIvB,MAAAA,IAAI,EAAE;AAFV,KADI;AAHZ,GArCK,CAHE;AAmDXwH,EAAAA,OAAO,EAAE,EAnDE;AAoDXC,EAAAA,iBAAiB,EAAE,EApDR;AAqDXC,EAAAA,cAAc,EAAE,EArDL;AAsDXC,EAAAA,MAAM,EAAE,EAtDG;AAuDXC,EAAAA,cAAc,EAAE;AAvDL,CAAf;;ACOA;;AACA,IAAMR,KAAK,gBAAGS,YAAS,CAACC,eAAV,eAA0BD,YAAS,CAACE,kBAAV,EAA1B,EAA0DC,OAA1D,CAAd;AAEA;;;;;AAIA,SAAgBC,UAAUvJ,OAAYwJ;AAClC,MAAIlI,IAAI,GAAGoH,KAAK,CAACe,GAAN,CAAUD,QAAV,CAAX;;AACA,MAAI,CAAClI,IAAL,EAAW;AACP,UAAM,IAAIgD,KAAJ,oBAA2BkF,QAA3B,CAAN;AACH;;AACD,MAAIE,GAAG,GAAG,IAAIP,YAAS,CAACQ,YAAd,EAAV;AACArI,EAAAA,IAAI,CAACsI,SAAL,CAAeF,GAAf,EAAoB1J,KAApB;AACA,SAAO0J,GAAG,CAACG,YAAJ,EAAP;AACH;AAED,AAoBA;;;;;AAIA,SAAgBC,YAAYC,SAAiBC,YAAoBC;AAC7D,MAAMC,GAAG,GAAGC,OAAA,CAAQC,OAAR,CAAgBJ,UAAhB,EAA4BC,SAA5B,EAAuCF,OAAvC,CAAZ;AACA,MAAMM,IAAI,GAAkB;AACxBC,IAAAA,IAAI,EAAEH,mBAAA,CAAoBH,UAApB,CADkB;AAExBO,IAAAA,KAAK,EAAEL,GAAG,CAACK,KAAJ,CAAUpF,QAAV,EAFiB;AAGxBqF,IAAAA,UAAU,EAAEN,GAAG,CAACH,OAHQ;AAIxBU,IAAAA,QAAQ,EAAEP,GAAG,CAACO;AAJU,GAA5B;AAMA,SAAOlB,SAAS,CAACc,IAAD,EAAO,gBAAP,CAAhB;AACH;AAED;;;;;AAIA,SAAgBK,mBAAmB3K;AAC/B,MAAIA,GAAG,CAAC4K,UAAJ,CAAe,MAAf,CAAJ,EAA4B;AACxB,WAAO5K,GAAP;AACH;;AACD,SAAO6K,UAAO,CAACC,iBAAR,CAA0BD,UAAO,CAACE,iBAAR,CAA0B,QAAQ/K,GAAG,CAACgL,MAAJ,CAAW,CAAC,EAAZ,CAAlC,CAA1B,CAAP;AACH;AAED;;;;;AAIA,SAAgBC,eAAeC,MAAcC;AACzC,SAAOR,kBAAkB,CAACO,IAAD,CAAlB,KAA6BP,kBAAkB,CAACQ,IAAD,CAAtD;AACH;AAED;;;;;;AAKA,SAAsBC,kBAAtB;AAAA;AAAA;;;uEAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC,OAAOC,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACC,MADzC;AAAA;AAAA;AAAA;;AAEOhB,YAAAA,IAFP,GAEc,IAAIiB,WAAJ,CAAgB,EAAhB,CAFd;AAGCF,YAAAA,MAAM,CAACC,MAAP,CAAcE,eAAd,CAA8BlB,IAA9B;AAHD,6CAIQF,cAAA,CAAeqB,UAAf,CAA0BC,MAAM,CAACnB,IAAP,CAAYD,IAAZ,CAA1B,EAA6ClF,QAA7C,EAJR;;AAAA;AAAA;AAAA,mBAMcgF,aAAA,EANd;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AC3EP;;;;;AAIA,IAAsBuB,WAAtB;AAAA;;AAAA;;AA+BI;;;;;;;AA/BJ,SAsCUC,MAtCV;AAAA;AAAA;AAAA,8EAsCI;AAAA;AAAA;AAAA;AAAA;AAAA,mBACQ,KAAKC,IAAL,CAAUC,OADlB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAEc,KAAKD,IAAL,CAAUE,aAAV,CAAwB,KAAKC,UAA7B,EAAyC,KAAKC,IAA9C,CAFd;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAtCJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA2CI;AA3CJ;;AAAA,cA4CWC,OA5CX,GA4CI,iBAAeL,IAAf,EAA2BvB,IAA3B;AACI,YAAQA,IAAI,CAAC/I,IAAb;AACI,WAAK,SAAL;AACI,eAAO,IAAI4K,kBAAJ,CAAuBN,IAAvB,EAA6BvB,IAAI,CAACA,IAAlC,EAAwCA,IAAI,CAAC8B,QAA7C,CAAP;;AACJ,WAAK,UAAL;AACI,eAAO,IAAIC,mBAAJ,CAAwBR,IAAxB,EAA8BvB,IAAI,CAACA,IAAnC,EAAyCA,IAAI,CAAC8B,QAA9C,CAAP;;AACJ;AACI,cAAM,IAAI7H,KAAJ,CAAU,yCAAV,CAAN;AANR;AAQH,GArDL;;AAAA;AAAA;AAuFA;;;;;AAIA,IAAa4H,kBAAb;AAAA;;AAYI,8BAAYN,IAAZ,EAAwBvB,IAAxB,EAAsD8B,QAAtD;;;AACI;AATK,cAAA,GAAO,SAAP;AAKD,iBAAA,GAAU,IAAI,EAAJ,GAAS,IAAnB;;AAKJ,UAAKP,IAAL,GAAYA,IAAZ;AACA,UAAKI,IAAL,GAAY3B,IAAI,CAAC2B,IAAjB;AACA,UAAK/B,SAAL,GAAiBI,IAAI,CAACJ,SAAtB;AACA,UAAKoC,OAAL,GAAehC,IAAI,CAACgC,OAApB;AACA,UAAKN,UAAL,GAAkB1B,IAAI,CAAC0B,UAAvB;;AACA,UAAK3B,OAAL,GAAe,UAACkC,OAAD;AACX,aAAOxC,WAAW,CAACwC,OAAO,CAACC,MAAR,CAAe,IAAf,EAAqB,KAArB,CAAD,EAA8BlC,IAAI,CAACmC,UAAnC,EAA+CnC,IAAI,CAACgC,OAAL,CAAatM,GAA5D,CAAlB;AACH,KAFD;;AAGA,UAAKoM,QAAL,gBACQA,QAAQ,IAAI,EADpB;AAEIM,MAAAA,OAAO,EAAE,MAAKA,OAFlB;AAGI5J,MAAAA,IAAI,EAAE,MAAKwJ,OAAL,CAAaxJ;AAHvB;;AAKA,UAAK+G,SAAL,GAAiB;AAAA,aAAO;AACpBtI,QAAAA,IAAI,EAAE,SADc;AAEpB+I,QAAAA,IAAI,EAAJA,IAFoB;AAGpB8B,QAAAA,QAAQ,EAAE,MAAKA;AAHK,OAAP;AAAA,KAAjB;;;AAKH;;AAhCL;;AAAA,UAkCIO,SAlCJ,GAkCI,mBAAUJ,OAAV,EAAwB7I,MAAxB;AACI,QAAI,KAAKmI,IAAL,CAAUe,SAAV,CAAoBD,SAAxB,EAAmC;AAC/B,WAAKd,IAAL,CAAUe,SAAV,CAAoBD,SAApB,CAA8BJ,OAA9B,EAAuC7I,MAAvC;AACH;AACJ,GAtCL;;AAAA,UAwCImJ,SAxCJ,GAwCI,mBAAUN,OAAV,EAAwB1I,KAAxB;AACI,QAAI,KAAKgI,IAAL,CAAUe,SAAV,CAAoBC,SAAxB,EAAmC;AAC/B,WAAKhB,IAAL,CAAUe,SAAV,CAAoBC,SAApB,CAA8BN,OAA9B,EAAuC1I,KAAvC;AACH;AACJ,GA5CL;;AAAA,UA8CIiJ,SA9CJ,GA8CI,mBAAUP,OAAV,EAAwBQ,MAAxB;AACI,QAAM9H,IAAI,GAAa;AACnB+H,MAAAA,UAAU,EAAE,IAAIC,IAAJ,CAASA,IAAI,CAACC,GAAL,KAAa,KAAKR,OAA3B,EAAoCS,WAApC,GAAkDtG,KAAlD,CAAwD,CAAxD,EAA2D,CAAC,CAA5D;AADO,KAAvB;;AAGA,QAAI,KAAKgF,IAAL,CAAUe,SAAV,CAAoBQ,gBAAxB,EAA0C;AACtC,WAAKvB,IAAL,CAAUe,SAAV,CAAoBQ,gBAApB,CAAqC,IAArC,EAA2Cb,OAA3C,EAAoDQ,MAApD;AACH;;AACDM,IAAAA,UAAU,CAAC;AACPN,MAAAA,MAAM,CAAC,IAAI3E,YAAJ,CAAiB,gCAAjB,EAAmD,WAAnD,CAAD,CAAN;AACH,KAFS,EAEP,KAAKsE,OAAL,GAAe,GAFR,CAAV;AAGAH,IAAAA,OAAO,CAACjC,IAAR,CAAarF,IAAb,CAAkBY,IAAlB,CAAuB;AACnB7F,MAAAA,GAAG,EAAE,MADc;AAEnBC,MAAAA,KAAK,EAAEuJ,SAAS,CAACvE,IAAD,EAAO,WAAP;AAFG,KAAvB;AAIAqI,IAAAA,KAAK,CAAC,KAAKhB,OAAL,CAAaiB,GAAd,EAAmB;AACpB7K,MAAAA,MAAM,EAAE,MADY;AAEpB8K,MAAAA,OAAO,EAAE;AACL,uBAAe,CAAC,KAAKd,OAAL,GAAe,IAAhB,EAAsBe,OAAtB,CAA8B,CAA9B,CADV;AAEL,wBAAgB,WAFX;AAGL,kBAAU;AAHL,OAFW;AAQpBC,MAAAA,IAAI,EAAE,KAAKrD,OAAL,CAAakC,OAAb;AARc,KAAnB,CAAL,CAUK5I,IAVL,CAUU,UAACgK,QAAD;AACF,UAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AACzBb,QAAAA,MAAM,CAAC,IAAI3E,YAAJ,CAAiB,wBAAjB,EAA2C,YAA3C,CAAD,CAAN;AACH,OAFD;AAKH,KAhBL,WAiBW,UAACvE,KAAD;AACHkJ,MAAAA,MAAM,CACF,IAAI3E,YAAJ,qCACqCvE,KAAK,CAACmG,OAAN,IAAiB6D,MAAM,CAAChK,KAAD,CAD5D,SAEI,YAFJ,CADE,CAAN;AAMH,KAxBL;AAyBH,GArFL;;AAAA,UAuFIiK,OAvFJ,GAuFI,iBAAQvB,OAAR;AACI,QAAI,KAAKV,IAAL,CAAUe,SAAV,CAAoBkB,OAAxB,EAAiC;AAC7B,aAAO,KAAKjC,IAAL,CAAUe,SAAV,CAAoBkB,OAApB,CAA4BvB,OAA5B,EAAqC,IAArC,CAAP;AACH;;AACD,WAAOrI,OAAO,CAACX,OAAR,CAAgBgJ,OAAhB,CAAP;AACH,GA5FL;;AAAA,UA8FIwB,WA9FJ,GA8FI;AACI,QAAI,KAAKlC,IAAL,CAAUe,SAAV,CAAoBmB,WAAxB,EAAqC;AACjC,aAAO,KAAKlC,IAAL,CAAUe,SAAV,CAAoBmB,WAApB,EAAP;AACH;AACJ,GAlGL;;AAAA,UAoGWC,qBApGX,GAoGW;AACH,WAAO,KAAKnC,IAAL,CAAUmC,qBAAV,CAAgC,CAAC,KAAK9D,SAAN,CAAhC,EAAkD,IAAlD,CAAP;AACH,GAtGL;;AAAA,UAwGW+D,qBAxGX,GAwGW;AACH,WAAO,KAAKpC,IAAL,CAAUoC,qBAAV,EAAP;AACH,GA1GL;;AAAA,UA4GIC,QA5GJ,GA4GI,kBAASC,IAAT,EAA6BC,OAA7B;AACI,WAAO,KAAKvC,IAAL,CAAUqC,QAAV,CAAmBC,IAAnB,EAAyBC,OAAzB,EAAkC,IAAlC,CAAP;AACH,GA9GL;;AAAA;AAAA,EAAwCzC,WAAxC;AA2HA;;;;;AAIA,IAAaU,mBAAb;AAAA;;AAYI,+BAAYR,IAAZ,EAAwBvB,IAAxB,EAAuD8B,QAAvD;;;AACI;AAPK,eAAA,GAAO,UAAP;AAQL,WAAKP,IAAL,GAAYA,IAAZ;AACA,WAAKI,IAAL,GAAY3B,IAAI,CAAC2B,IAAjB;AACA,WAAK/B,SAAL,GAAiBI,IAAI,CAACJ,SAAtB;AACA,WAAKkC,QAAL,GAAgBA,QAAQ,IAAI,EAA5B;AACA,WAAKJ,UAAL,GAAkB1B,IAAI,CAAC0B,UAAvB;;AACA,WAAKnC,SAAL,GAAiB;AAAA,aAAO;AACpBtI,QAAAA,IAAI,EAAE,OAAKA,IADS;AAEpB+I,QAAAA,IAAI,EAAJA,IAFoB;AAGpB8B,QAAAA,QAAQ,EAAE,OAAKA;AAHK,OAAP;AAAA,KAAjB;;;AAKH;;AAxBL;;AAAA,UA0BIO,SA1BJ,GA0BI,mBAAUJ,OAAV,EAAwB7I,MAAxB;AACI,QAAI,KAAKmI,IAAL,CAAUe,SAAV,CAAoBD,SAAxB,EAAmC;AAC/B,WAAKd,IAAL,CAAUe,SAAV,CAAoBD,SAApB,CAA8BJ,OAA9B,EAAuC7I,MAAvC;AACH;AACJ,GA9BL;;AAAA,UAgCImJ,SAhCJ,GAgCI,mBAAUN,OAAV,EAAwB1I,KAAxB;AACI,QAAI,KAAKgI,IAAL,CAAUe,SAAV,CAAoBC,SAAxB,EAAmC;AAC/B,WAAKhB,IAAL,CAAUe,SAAV,CAAoBC,SAApB,CAA8BN,OAA9B,EAAuC1I,KAAvC;AACH;AACJ,GApCL;;AAAA,UAsCIiJ,SAtCJ,GAsCI,mBAAUP,OAAV,EAAwBQ,MAAxB;AACI,QAAI,KAAKlB,IAAL,CAAUe,SAAV,CAAoBQ,gBAAxB,EAA0C;AACtC,WAAKvB,IAAL,CAAUe,SAAV,CAAoBQ,gBAApB,CAAqC,IAArC,EAA2Cb,OAA3C,EAAoDQ,MAApD;AACH,KAFD,MAEO;AACH,WAAKlB,IAAL,CAAUe,SAAV,CAAoBE,SAApB,CAA8BP,OAA9B,EAAuCQ,MAAvC;AACH;AACJ,GA5CL;;AAAA,UA8CIe,OA9CJ,GA8CI,iBAAQvB,OAAR;AACI,QAAI,KAAKV,IAAL,CAAUe,SAAV,CAAoBkB,OAAxB,EAAiC;AAC7B,aAAO,KAAKjC,IAAL,CAAUe,SAAV,CAAoBkB,OAApB,CAA4BvB,OAA5B,EAAqC,IAArC,CAAP;AACH;;AACD,WAAOrI,OAAO,CAACX,OAAR,CAAgBgJ,OAAhB,CAAP;AACH,GAnDL;;AAAA,UAqDIwB,WArDJ,GAqDI;AACI,QAAI,KAAKlC,IAAL,CAAUe,SAAV,CAAoBmB,WAAxB,EAAqC;AACjC,aAAO,KAAKlC,IAAL,CAAUe,SAAV,CAAoBmB,WAApB,EAAP;AACH;AACJ,GAzDL;;AAAA,UA2DWC,qBA3DX,GA2DW;AACH,WAAO,KAAKnC,IAAL,CAAUmC,qBAAV,CAAgC,CAAC,KAAK9D,SAAN,CAAhC,EAAkD,IAAlD,CAAP;AACH,GA7DL;;AAAA,UA+DW+D,qBA/DX,GA+DW;AACH,WAAO,KAAKpC,IAAL,CAAUoC,qBAAV,EAAP;AACH,GAjEL;;AAAA,UAmEIC,QAnEJ,GAmEI,kBAASC,IAAT,EAA6BC,OAA7B;AACI,WAAO,KAAKvC,IAAL,CAAUqC,QAAV,CAAmBC,IAAnB,EAAyBC,OAAzB,EAAkC,IAAlC,CAAP;AACH,GArEL;;AAAA;AAAA,EAAyCzC,WAAzC;;ACvJA;;;;;;;;;;;;;;;;;AAgBA,IAAa0C,IAAb;AAeI;AACA,gBAAYD,OAAZ;AALQ,iBAAA,GAAW,IAAIE,GAAJ,EAAX;AACA,oBAAA,GAAc,IAAIA,GAAJ,EAAd;AACA,mBAAA,GAAqB,EAArB;;AAIJ,QAAI,OAAOF,OAAP,KAAmB,QAAvB,EAAiC;AAC7B,YAAM,IAAIpJ,SAAJ,CAAc,wBAAd,CAAN;AACH;;AACD,QAAI,CAACoJ,OAAO,CAACxB,SAAb,EAAwB;AACpB,YAAM,IAAI5H,SAAJ,CACF,uFADE,CAAN;AAGH;;AACD,QAAIoJ,OAAO,CAAC5F,GAAR,KAAgBnJ,SAAhB,IAA6B,OAAO+O,OAAO,CAAC5F,GAAf,KAAuB,QAAxD,EAAkE;AAC9D,WAAKA,GAAL,GAAW,IAAI+F,UAAJ,CAAYH,OAAO,CAAC5F,GAAR,IAAeF,QAAQ,CAACE,GAApC,CAAX;AACH,KAFD,MAEO;AACH,WAAKA,GAAL,GAAW4F,OAAO,CAAC5F,GAAnB;AACH;;AACD,QAAI4F,OAAO,CAAC7F,OAAZ,EAAqB;AACjB,WAAKA,OAAL,GACI,OAAO6F,OAAO,CAAC7F,OAAf,KAA2B,QAA3B,GACMiG,YAAA,CAAaJ,OAAO,CAAC7F,OAArB,CADN,GAEM6F,OAAO,CAAC7F,OAHlB;AAIH,KALD,MAKO;AACH,WAAKA,OAAL,GAAeD,QAAQ,CAACC,OAAxB;AACH;;AACD,SAAKkG,cAAL,GAAsB,CAACL,OAAO,CAAC3F,OAAR,IAAmBH,QAAQ,CAACG,OAA7B,EAAsCiG,IAAtC,GAA6CC,OAA7C,CAAqD,KAArD,EAA4D,EAA5D,CAAtB;AACA,SAAK/B,SAAL,GAAiBwB,OAAO,CAACxB,SAAzB;;AACA,QAAIwB,OAAO,CAACtC,OAAR,KAAoB,IAAxB,EAA8B;AAC1B,WAAKA,OAAL,GAAesC,OAAO,CAACtC,OAAvB;AACH;;AACD,SAAK8C,cAAL,GAAsB;AAClBC,MAAAA,WAAW,EAAE,IADK;AAElBC,MAAAA,IAAI,EAAJA,IAFkB;AAGlBC,MAAAA,MAAM,EAAEX,OAAO,CAACW;AAHE,KAAtB;;AAKA,QAAIX,OAAO,CAACY,UAAR,IAAsBZ,OAAO,CAACY,UAAR,CAAmB5I,MAAnB,GAA4B,CAAtD,EAAyD;AACrD,WAAK4I,UAAL,GAAkBZ,OAAO,CAACY,UAAR,IAAsB,EAAxC;AACH;AACJ;AAED;;;;;;AArDJ;;AAAA,SAyDiBC,MAzDjB;AAAA;AAAA;AAAA,8EAyDW,iBAAaC,OAAb;AAAA;;AAAA;AAAA;AAAA;AAAA;AACCC,cAAAA,EADD,GACM,KAAKC,QAAL,CAAc1F,GAAd,CAAkBwF,OAAlB,CADN;;AAAA,kBAEEC,EAFF;AAAA;AAAA;AAAA;;AAGKF,cAAAA,QAHL,GAGc,KAAKI,WAAL,CAAiB3F,GAAjB,CAAqBwF,OAArB,CAHd;;AAIC,kBAAI,CAACD,QAAL,EAAa;AACTA,gBAAAA,QAAM,GAAG,KAAKzG,GAAL,CAAS8G,OAAT,CAAiBJ,OAAjB,CAAT;AACA,qBAAKG,WAAL,CAAiBE,GAAjB,CAAqBL,OAArB,EAA8BD,QAA9B;AACH;;AAPF;AAAA,qBAQaA,QARb;;AAAA;AAQCE,cAAAA,EARD,iBAQqBK,GARrB;AASC,mBAAKH,WAAL,WAAwBH,OAAxB;;AACA,kBAAIC,EAAJ,EAAQ;AACJ,qBAAKC,QAAL,CAAcG,GAAd,CAAkBL,OAAlB,EAA2BC,EAA3B;AACH;;AAZF;AAAA,+CAcIA,EAdJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAzDX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA0EI;;;;AA1EJ;;AAAA,SA8EWM,iBA9EX,GA8EW;AACH,WAAU,KAAKhB,cAAf,SAAiCiB,OAAI,EAArC;AACH;AAED;;;;AAlFJ;;AAAA,SAsFiBC,aAtFjB;AAAA;AAAA;AAAA,qFAsFW,kBAAoBxB,IAApB,EAA6DvB,SAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AACGgD,cAAAA,CADH,GACOhD,SAAS,IAAI,KAAKA,SADzB;;AAAA;AAAA,qBAGiB4B,kBAAA,CAAmBzN,MAAnB,cAEToN,IAFS;AAGZ5F,gBAAAA,OAAO,EAAE,KAAKA,OAHF;AAIZsH,gBAAAA,SAAS,EAAE,KAJC;AAKZC,gBAAAA,QAAQ,EAAE;AACNvC,kBAAAA,GAAG,EAAE,KAAKkC,iBAAL,EADC;AAENM,kBAAAA,UAAU,EAAE;AAFN;AALE,kBAUhB,KAAKnB,cAVW,CAHjB;;AAAA;AAGCrC,cAAAA,OAHD;;AAAA,mBAeCqD,CAAC,CAAC9B,OAfH;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAgBiB8B,CAAC,CAAC9B,OAAF,CAAUvB,OAAV,CAhBjB;;AAAA;AAgBCA,cAAAA,OAhBD;;AAAA;AAAA,gDAkBIA,OAlBJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAtFX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA2GI;;;;AA3GJ;;AAAA,SA+GiByD,WA/GjB;AAAA;AAAA;AAAA,mFA+GW,kBACHzD,OADG,EAEHK,SAFG,EAGHiD,SAHG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAGHA,SAHG;AAGHA,gBAAAA,SAHG,GAGS,KAHT;AAAA;;AAKGD,cAAAA,CALH,GAKOhD,SAAS,IAAI,KAAKA,SALzB;AAAA;AAOOqD,cAAAA,OAPP,GAOiB1D,OAAO,CAACjC,IAAR,CAAawF,QAP9B;;AAAA,kBAQMG,OAAO,CAACrF,UAAR,CAAmB,KAAK6D,cAAxB,CARN;AAAA;AAAA;AAAA;;AAAA,oBASW,IAAIlK,KAAJ,CAAU,mCAAV,CATX;;AAAA;AAAA,oBAWKgI,OAAO,CAACjC,IAAR,CAAa4F,KAAb,KAAuB,CAX5B;AAAA;AAAA;AAAA;;AAAA,oBAYW,IAAI3L,KAAJ,CAAU,uBAAV,CAZX;;AAAA;AAcC;AACM4L,cAAAA,GAfP,GAeoC,EAfpC;AAgBOC,cAAAA,MAhBP,GAgBgBC,eAAe,CAACJ,OAAD,EAAUE,GAAV,CAAf,CAA8BxM,IAA9B,CAAmC,UAAC2G,IAAD;AAC9C,oBAAI,OAAOA,IAAI,CAACgG,QAAZ,KAAyB,QAA7B,EAAuC;AACnC,wBAAM,IAAIrI,WAAJ,0BAAuCqC,IAAI,CAACgG,QAA5C,CAAN;AACH;;AACD,uBAAOhG,IAAP;AACH,eALc,CAhBhB;AAsBOyC,cAAAA,MAtBP,GAsBgB,IAAI7I,OAAJ,CAAmB,UAACqM,CAAD,EAAI/M,MAAJ;AAC9BoM,gBAAAA,CAAC,CAAC9C,SAAF,CAAYP,OAAZ,EAAqB,UAACrE,MAAD;AACjB,sBAAIiI,GAAG,CAACpD,MAAR,EAAgB;AACZoD,oBAAAA,GAAG,CAACpD,MAAJ;AACH;;AACD,sBAAI,OAAO7E,MAAP,KAAkB,QAAtB,EAAgC;AAC5B1E,oBAAAA,MAAM,CAAC,IAAIyE,WAAJ,CAAgBC,MAAhB,CAAD,CAAN;AACH,mBAFD,MAEO;AACH1E,oBAAAA,MAAM,CAAC0E,MAAD,CAAN;AACH;AACJ,iBATD;AAUH,eAXc,CAtBhB;AAAA;AAAA,qBAkCuBhE,OAAO,CAACsM,IAAR,CAAa,CAACJ,MAAD,EAASrD,MAAT,CAAb,CAlCvB;;AAAA;AAkCO0D,cAAAA,OAlCP;AAmCOC,cAAAA,MAnCP,GAmCiC;AAC5BC,gBAAAA,KAAK,EAAEF,OAAO,CAACG,EADa;AAE5BC,gBAAAA,UAAU,EAAEJ,OAAO,CAACK;AAFQ,eAnCjC;AAuCOC,cAAAA,UAvCP,GAuC8B9R,MAAM,CAACgH,IAAP,CAAYwK,OAAZ,EACxBO,MADwB,CACjB,UAAChR,GAAD;AAAA,uBAASA,GAAG,CAAC4K,UAAJ,CAAe,KAAf,KAAyB5K,GAAG,KAAK,MAA1C;AAAA,eADiB,EAExBiR,GAFwB,CAEpB,UAACjR,GAAD;AAAA,uBAASyQ,OAAO,CAACzQ,GAAD,CAAhB;AAAA,eAFoB,CAvC9B;;AAAA;AAAA,qBA2CwBwO,0BAAA,CAA2B0C,WAA3B,CACnBT,OADmB,EAEnB,KAAK7B,cAFc,CA3CxB;;AAAA;AA2COuC,cAAAA,QA3CP;AA+COlM,cAAAA,IA/CP,GA+CckM,QAAQ,CAAC5E,OAAT,CAAiB6E,OAAjB,EA/Cd;;AAgDC,kBAAInM,IAAI,CAAC,UAAD,CAAR,EAAsB;AAClB8L,gBAAAA,UAAU,CAACM,OAAX,CAAmBpM,IAAI,CAAC,UAAD,CAAvB;AACH;;AACMqM,cAAAA,qBAnDR,GAmD8CH,QAnD9C,CAmDQG,qBAnDR,EAmD+BC,WAnD/B,GAmD8CJ,QAnD9C,CAmD+BI,WAnD/B;AAoDO7N,cAAAA,MApDP,GAoDgC;AAC3B6I,gBAAAA,OAAO,EAAE4E,QAAQ,CAAC5E,OADS;AAE3B+E,gBAAAA,qBAAqB,EAArBA,qBAF2B;AAG3BC,gBAAAA,WAAW,EAAXA,WAH2B;AAI3BR,gBAAAA,UAAU,EAAVA,UAJ2B;AAK3BN,gBAAAA,OAAO,EAAPA,OAL2B;AAM3BC,gBAAAA,MAAM,EAANA;AAN2B,eApDhC;;AAAA,mBA4DKb,SA5DL;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA6DuB,KAAKrH,GAAL,CAASgJ,gBAAT,CAA0B;AACxCT,gBAAAA,UAAU,EAAErN,MAAM,CAACqN,UADqB;AAExCO,gBAAAA,qBAAqB,EAAE5N,MAAM,CAAC4N;AAFU,eAA1B,CA7DvB;;AAAA;AA6DWnH,cAAAA,GA7DX;AAiEKzG,cAAAA,MAAM,CAAC+N,SAAP,GAAmBtH,GAAG,CAACsH,SAAvB;;AAjEL;AAAA,mBAmEK/N,MAAM,CAAC6I,OAAP,CAAemF,UAAf,EAnEL;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAoEW,KAAKC,aAAL,CAAmBjO,MAAnB,CApEX;;AAAA;AAsEC,kBAAIkM,CAAC,CAACjD,SAAN,EAAiB;AACbiD,gBAAAA,CAAC,CAACjD,SAAF,CAAYJ,OAAZ,EAAqB7I,MAArB;AACH;;AAxEF,gDAyEQA,MAzER;;AAAA;AAAA;AAAA;;AA2EC,kBAAIkM,CAAC,CAAC/C,SAAN,EAAiB;AACb+C,gBAAAA,CAAC,CAAC/C,SAAF,CAAYN,OAAZ;AACH;;AA7EF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA/GX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAiMI;;;;;;;;;;;;;AAjMJ;;AAAA,SA8MiB2B,QA9MjB;AAAA;AAAA;AAAA,gFA8MW,kBACHC,IADG,EAEHC,OAFG,EAGHxB,SAHG;AAAA;AAAA;AAAA;AAAA;AAAA;AAKGgD,cAAAA,CALH,GAKOhD,SAAS,IAAI,KAAKA,SALzB;AAMGiD,cAAAA,SANH,GAMezB,OAAO,GAAGA,OAAO,CAACyB,SAAR,KAAsB,KAAzB,GAAiC,IANvD;;AAQH,kBAAID,CAAC,IAAIA,CAAC,CAAC7B,WAAX,EAAwB;AACpB6B,gBAAAA,CAAC,CAAC7B,WAAF;AACH,eAVE;;;AAYC6D,cAAAA,OAZD,GAYWzD,IAZX;;AAaH,kBACIA,IAAI,CAACpF,OAAL,KACC6I,OAAO,CAAC5E,UAAR,IACG4E,OAAO,CAACC,aADX,IAEGD,OAAO,CAACE,gBAFX,IAGGF,OAAO,CAACG,mBAHX,IAIGH,OAAO,CAACI,gBAJX,IAKGJ,OAAO,CAACK,SANZ,CADJ,EAQE;AACE9D,gBAAAA,IAAI,GAAG;AACHoD,kBAAAA,WAAW;AACPvE,oBAAAA,UAAU,EAAE,qBADL;AAEP6E,oBAAAA,aAAa,EAAE,CAFR;AAGPC,oBAAAA,gBAAgB,EAAE,CAHX;AAIPC,oBAAAA,mBAAmB,EAAE,CAJd;AAKPC,oBAAAA,gBAAgB,EAAE,CALX;AAMPC,oBAAAA,SAAS,EAAE;AANJ,qBAOJL,OAPI;AADR,iBAAP;AAWH;;AAjCE;AAAA,qBAkCmB,KAAKjC,aAAL,CAAmBxB,IAAnB,EAAyByB,CAAzB,CAlCnB;;AAAA;AAkCGrD,cAAAA,OAlCH;AAAA;AAAA,qBAmCkB,KAAKyD,WAAL,CAAiBzD,OAAjB,EAA0BqD,CAA1B,EAA6BC,SAA7B,CAnClB;;AAAA;AAmCGnM,cAAAA,MAnCH;AAAA,gDAoCIA,MApCJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA9MX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAqPI;;;;;;;;;AArPJ;;AAAA,SA8PiBwO,QA9PjB;AAAA;AAAA;AAAA,gFA8PW,kBACHC,iBADG,EAEHlN,IAFG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAImB,KAAK0K,aAAL,CAAmB;AACrCyC,gBAAAA,QAAQ,EAAE;AAACvB,kBAAAA,UAAU,EAAEsB,iBAAiB,IAAI;AAAlC,iBAD2B;AAErClN,gBAAAA,IAAI,EAAJA;AAFqC,eAAnB,CAJnB;;AAAA;AAIGsH,cAAAA,OAJH;AAAA;AAAA,qBAQe,KAAKyD,WAAL,CAAiBzD,OAAjB,CARf;;AAAA;AAQGpC,cAAAA,GARH;;AAAA,kBASEA,GAAG,CAACoC,OAAJ,CAAYmF,UAAZ,EATF;AAAA;AAAA;AAAA;;AAAA,oBAUO,IAAIvJ,aAAJ,uBAVP;;AAAA;AAYG6B,cAAAA,OAZH,GAYa0B,MAAM,CAAC2G,MAAP,CAAc,CAC1B3G,MAAM,CAACnB,IAAP,CAAYgC,OAAO,CAAC+F,UAAR,EAAZ,EAAkC,KAAlC,CAD0B,EAE1B5G,MAAM,CAACnB,IAAP,CAAYJ,GAAG,CAACmH,qBAAhB,CAF0B,EAG1B5F,MAAM,CAAC6G,KAAP,CAAa,EAAb,CAH0B,CAAd,CAZb;AAiBI7B,cAAAA,MAjBJ,GAiBcvG,GAjBd,CAiBIuG,MAjBJ;AAkBG8B,cAAAA,SAlBH,GAkBeC,MAAG,CAACC,SAAJ,CAAcC,UAAd,CAAyBxI,GAAG,CAAC4G,UAAJ,CAAe,CAAf,CAAzB,EAA4C6B,OAA5C,CAAoD5I,OAApD,EAA6D6I,cAA7D,EAlBf;AAAA;AAAA,qBAmBmB,KAAKrK,GAAL,CAASsK,WAAT,CAAqBpC,MAAM,CAACC,KAA5B,CAnBnB;;AAAA;AAmBGzB,cAAAA,OAnBH;;AAAA,mBAqBCiD,iBArBD;AAAA;AAAA;AAAA;;AAAA,oBAuBMA,iBAAiB,CAACxB,KAAlB,KAA4BnC,mBAA5B,IACG2D,iBAAiB,CAACxB,KAAlB,KAA4BD,MAAM,CAACC,KADvC,IAECwB,iBAAiB,CAACtB,UAAlB,KAAiCrC,yBAAjC,IACG2D,iBAAiB,CAACtB,UAAlB,KAAiCH,MAAM,CAACG,UA1BjD;AAAA;AAAA;AAAA;;AAAA,oBA4BW,IAAI1I,aAAJ,qCACgC4K,UAAU,CAACrC,MAAD,CAD1C,mBACgEqC,UAAU,CACxEZ,iBADwE,CAD1E,OA5BX;;AAAA;AAAA,6DAoCIhI,GApCJ;AAqCC+E,gBAAAA,OAAO,EAAPA,OArCD;AAsCCsD,gBAAAA,SAAS,EAATA;AAtCD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA9PX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAwSI;;;;;AAxSJ;;AAAA,SA6SiBb,aA7SjB;AAAA;AAAA;AAAA,qFA6SW,kBAAoBxH,GAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AACGoC,cAAAA,OADH,GACapC,GAAG,CAACoC,OADjB;AAEGvC,cAAAA,OAFH,GAEa0B,MAAM,CAAC2G,MAAP,CAAc,CAC1B3G,MAAM,CAACnB,IAAP,CAAYgC,OAAO,CAAC+F,UAAR,EAAZ,EAAkC,KAAlC,CAD0B,EAE1B5G,MAAM,CAACnB,IAAP,CAAYJ,GAAG,CAACmH,qBAAhB,CAF0B,EAG1B5F,MAAM,CAAC6G,KAAP,CAAa,EAAb,CAH0B,CAAd,CAFb;AAOI7B,cAAAA,MAPJ,GAOcvG,GAPd,CAOIuG,MAPJ;AAQG8B,cAAAA,SARH,GAQeC,MAAG,CAACC,SAAJ,CAAcC,UAAd,CAAyBxI,GAAG,CAAC4G,UAAJ,CAAe,CAAf,CAAzB,EAA4C6B,OAA5C,CAAoD5I,OAApD,EAA6D6I,cAA7D,EARf;AAAA;AAAA,qBASmB,KAAKrK,GAAL,CAASsK,WAAT,CAAqBpC,MAAM,CAACC,KAA5B,CATnB;;AAAA;AASGzB,cAAAA,OATH;;AAAA,kBAUEA,OAVF;AAAA;AAAA;AAAA;;AAAA,oBAWO,IAAI/G,aAAJ,sCAAqDuI,MAAM,CAACC,KAA5D,CAXP;;AAAA;AAcGE,cAAAA,UAdH,GAcgB3B,OAAO,CAAC8D,WAAR,CAAoBC,IAApB,CACf;AAAA,oBAAEC,SAAF,QAAEA,SAAF;AAAA,uBAAsBA,SAAS,KAAKxC,MAAM,CAACG,UAA3C;AAAA,eADe,CAdhB;;AAAA,kBAiBEA,UAjBF;AAAA;AAAA;AAAA;;AAAA,oBAkBO,IAAI1I,aAAJ,CACCuI,MAAM,CAACC,KADR,wCACgDD,MAAM,CAACG,UADvD,CAlBP;;AAAA;AAuBG5E,cAAAA,IAvBH,GAuBU4E,UAAU,CAACsC,aAvBrB;AAwBGC,cAAAA,OAxBH,GAwBanH,IAAI,CAAChG,IAAL,CAAUgN,IAAV,CAAe;AAAA,oBAAEjT,GAAF,SAAEA,GAAF;AAAA,uBAAgBiL,cAAc,CAACjL,GAAD,EAAMwS,SAAN,CAA9B;AAAA,eAAf,CAxBb;;AAAA,kBAyBEY,OAzBF;AAAA;AAAA;AAAA;;AAAA,oBA0BO,IAAIjL,aAAJ,CAAqB4K,UAAU,CAACrC,MAAD,CAA/B,uCA1BP;;AAAA;AAAA,oBA4BCzE,IAAI,CAACoH,SAAL,GAAiBD,OAAO,CAACE,MA5B1B;AAAA;AAAA;AAAA;;AAAA,oBA6BO,IAAInL,aAAJ,CAAqB4K,UAAU,CAACrC,MAAD,CAA/B,8CA7BP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA7SX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA8UI;;;;;AA9UJ;;AAAA,SAmViB6C,KAnVjB;AAAA;AAAA;AAAA,6EAmVW,kBAAYvH,UAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACsBZ,kBAAkB,EADxC;;AAAA;AACGnB,cAAAA,UADH;AAEGwC,cAAAA,UAFH,GAEgBgG,MAAG,CAACe,UAAJ,CAAeb,UAAf,CAA0B1I,UAA1B,EAAsCwJ,YAAtC,GAAqDZ,cAArD,EAFhB;AAGGa,cAAAA,UAHH,GAG4B;AAC3BC,gBAAAA,YAAY,EAAE3H,UADa;AAE3B4H,gBAAAA,WAAW,EAAEnH;AAFc,eAH5B;AAAA;AAAA,qBAOe,KAAKyF,QAAL,CAAc7S,SAAd,EAAyB;AACvCwM,gBAAAA,IAAI,EAAErC,SAAS,CAACkK,UAAD,EAAa,aAAb;AADwB,eAAzB,CAPf;;AAAA;AAOGvJ,cAAAA,GAPH;AAUGiC,cAAAA,QAVH,GAUc;AAACyH,gBAAAA,UAAU,EAAE1J,GAAG,CAACoC,OAAJ,CAAYuH,UAAZ,GAAyB,aAAzB,MAA4CzU;AAAzD,eAVd;;AAYH,kBAAI8K,GAAG,CAACsG,OAAJ,CAAYsD,OAAZ,IAAuB5J,GAAG,CAACsG,OAAJ,CAAYuD,QAAnC,IAA+C7J,GAAG,CAACsG,OAAJ,CAAYwD,SAA/D,EAA0E;AACtEC,gBAAAA,OAAO,GAAG,IAAI/H,kBAAJ,CACN,IADM,EAEN;AACIH,kBAAAA,UAAU,EAAVA,UADJ;AAEIC,kBAAAA,IAAI,EAAE9B,GAAG,CAACuG,MAFd;AAGIxG,kBAAAA,SAAS,EAAEC,GAAG,CAACqI,SAHnB;AAIIlG,kBAAAA,OAAO,EAAE;AACLiB,oBAAAA,GAAG,EAAEpD,GAAG,CAACsG,OAAJ,CAAYsD,OADZ;AAEL/T,oBAAAA,GAAG,EAAEmK,GAAG,CAACsG,OAAJ,CAAYuD,QAFZ;AAGLlR,oBAAAA,IAAI,EAAEqH,GAAG,CAACsG,OAAJ,CAAYwD;AAHb,mBAJb;AASIxH,kBAAAA,UAAU,EAAExC;AAThB,iBAFM,EAaNmC,QAbM,CAAV;AAeH,eAhBD,MAgBO;AACH8H,gBAAAA,OAAO,GAAG,IAAI7H,mBAAJ,CACN,IADM,EAEN;AACIL,kBAAAA,UAAU,EAAVA,UADJ;AAEIC,kBAAAA,IAAI,EAAE9B,GAAG,CAACuG,MAFd;AAGIxG,kBAAAA,SAAS,EAAEC,GAAG,CAACqI;AAHnB,iBAFM,EAONpG,QAPM,CAAV;AASH;;AAtCE,mBAuCC,KAAKN,OAvCN;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAwCO,KAAKqI,YAAL,CAAkBnI,UAAlB,EAA8BkI,OAA9B,CAxCP;;AAAA;AAAA,mBA2CCA,OAAO,CAACjI,IAAR,CAAa0E,KA3Cd;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA4CsB,KAAKnI,GAAL,CAAS4L,cAAT,CAAwB;AACzCC,gBAAAA,KAAK,EAAE,cADkC;AAEzChM,gBAAAA,IAAI,EAAE,cAFmC;AAGzCiM,gBAAAA,IAAI,EAAE,IAHmC;AAIzCC,gBAAAA,KAAK,EAAE,WAJkC;AAKzCC,gBAAAA,WAAW,EAAEN,OAAO,CAACjI,IAAR,CAAa0E,KALe;AAMzC8D,gBAAAA,WAAW,EAAEP,OAAO,CAACjI,IAAR,CAAa0E;AANe,eAAxB,CA5CtB;;AAAA;AAAA;AA4CQ+D,cAAAA,IA5CR,yBA4CQA,IA5CR;;AAAA,oBAoDKA,IAAI,IAAIA,IAAI,CAACtO,MAAL,GAAc,CApD3B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAqDiC,KAAKoC,GAAL,CAASmM,kBAAT,CAA4BD,IAA5B,CArDjC;;AAAA;AAqDKR,cAAAA,OAAO,CAACU,WArDb;;AAAA;AAyDH;AACA,kBAAI,KAAK5F,UAAL,CAAgB5I,MAAhB,GAAyB,CAA7B,EAAgC;AAC5B,qBAAK0F,OAAL,CAAc+I,KAAd,CAAoB,aAApB,EAAmC,KAAK7F,UAAxC;AACH;;AA5DE,6DA+DI7E,GA/DJ;AAgEC+J,gBAAAA,OAAO,EAAPA;AAhED;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAnVX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAuZI;;;;;;;AAvZJ;;AAAA,SA8ZiBY,cA9ZjB;AAAA;AAAA;AAAA,sFA8ZW,kBAAqB9I,UAArB,EAAyCC,IAAzC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,KAAKH,OADP;AAAA;AAAA;AAAA;;AAAA,oBAEO,IAAIvH,KAAJ,CAAU,0DAAV,CAFP;;AAAA;AAAA,mBAKC0H,IALD;AAAA;AAAA;AAAA;;AAMCjM,cAAAA,GAAG,GAAG,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B+G,UAAU,CAAC9G,IAAD,CAAtC,CAAN;AAND;AAAA;;AAAA;AAAA;AAAA,qBAQqB,KAAK+I,YAAL,CAAkBhJ,UAAlB,CARrB;;AAAA;AAQKiJ,cAAAA,MARL,kBAQoD,CARpD;;AAAA,kBASMA,MATN;AAAA;AAAA;AAAA;;AAAA,gDAUY,IAVZ;;AAAA;AAYCjV,cAAAA,GAAG,GAAG,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B+G,UAAU,CAACkC,MAAD,CAAtC,CAAN;;AAZD;AAAA;AAAA,qBAcc,KAAKnJ,OAAL,CAAaoJ,IAAb,CAAkBlV,GAAlB,CAdd;;AAAA;AAcCsK,cAAAA,IAdD;;AAAA,kBAeEA,IAfF;AAAA;AAAA;AAAA;;AAAA,gDAgBQ,IAhBR;;AAAA;AAAA;AAoBC6K,cAAAA,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAW/K,IAAX,CAAd;AApBD;AAAA;;AAAA;AAAA;AAAA;AAAA,oBAsBO,IAAI/F,KAAJ,uDACiD,aAAMyF,OAAN,IAAiB6D,MAAM,cADxE,QAtBP;;AAAA;AA0BGqG,cAAAA,OA1BH,GA0BavI,WAAW,CAACO,OAAZ,CAAoB,IAApB,EAA0BiJ,WAA1B,CA1Bb;;AAAA,mBA2BClJ,IA3BD;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA6BO,KAAKqJ,YAAL,CAAkBtJ,UAAlB,EAA8BC,IAA9B,CA7BP;;AAAA;AAAA,mBAgCCiI,OAAO,CAACjI,IAAR,CAAa0E,KAhCd;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAiCsB,KAAKnI,GAAL,CAAS4L,cAAT,CAAwB;AACzCC,gBAAAA,KAAK,EAAE,cADkC;AAEzChM,gBAAAA,IAAI,EAAE,cAFmC;AAGzCiM,gBAAAA,IAAI,EAAE,IAHmC;AAIzCC,gBAAAA,KAAK,EAAE,WAJkC;AAKzCC,gBAAAA,WAAW,EAAEN,OAAO,CAACjI,IAAR,CAAa0E,KALe;AAMzC8D,gBAAAA,WAAW,EAAEP,OAAO,CAACjI,IAAR,CAAa0E;AANe,eAAxB,CAjCtB;;AAAA;AAAA;AAiCQ+D,cAAAA,IAjCR,0BAiCQA,IAjCR;;AAAA,oBAyCKA,IAAI,IAAIA,IAAI,CAACtO,MAAL,GAAc,CAzC3B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA0CiC,KAAKoC,GAAL,CAASmM,kBAAT,CAA4BD,IAA5B,CA1CjC;;AAAA;AA0CKR,cAAAA,OAAO,CAACU,WA1Cb;;AAAA;AAAA,gDA8CIV,OA9CJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA9ZX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA+cI;;;;;AA/cJ;;AAAA,SAodiBc,YApdjB;AAAA;AAAA;AAAA,oFAodW,kBAAmBhJ,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,KAAKF,OADP;AAAA;AAAA;AAAA;;AAAA,oBAEO,IAAIvH,KAAJ,CAAU,wDAAV,CAFP;;AAAA;AAICvE,cAAAA,GAJD,GAIO,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B,MAA5B,CAJP;AAAA;AAAA,6BAOQoJ,IAPR;AAAA;AAAA,qBAO0B,KAAKtJ,OAAL,CAAaoJ,IAAb,CAAkBlV,GAAlB,CAP1B;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA,6BAOqD,IAPrD;;AAAA;AAAA;AAOCuV,cAAAA,IAPD,gBAOaF,KAPb;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,oBASO,IAAI9Q,KAAJ,qDAC+C,aAAMyF,OAAN,IAAiB6D,MAAM,cADtE,QATP;;AAAA;AAAA,gDAaI0H,IAbJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KApdX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAoeI;;;;AApeJ;;AAAA,SAweiBxJ,aAxejB;AAAA;AAAA;AAAA,qFAweW,mBAAoBC,UAApB,EAAwCC,IAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,KAAKH,OADP;AAAA;AAAA;AAAA;;AAAA,oBAEO,IAAIvH,KAAJ,CAAU,yDAAV,CAFP;;AAAA;AAICvE,cAAAA,GAJD,GAIO,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B+G,UAAU,CAAC9G,IAAD,CAAtC,CAJP;AAAA;AAAA,qBAKG,KAAKH,OAAL,CAAaF,MAAb,CAAoB5L,GAApB,CALH;;AAAA;AAAA;AAAA,qBAMG,KAAKsV,YAAL,CAAkBtJ,UAAlB,EAA8BC,IAA9B,EAAoC,IAApC,CANH;;AAAA;AAAA;AAAA,qBAOO,KAAKH,OAAL,CAAaoJ,IAAb,CAAkB,aAAlB,CAPP;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQC,mBAAKpJ,OAAL,CAAaF,MAAb,CAAoB,aAApB;;AARD;AAAA;AAAA,qBAUO,KAAKE,OAAL,CAAaoJ,IAAb,CAAkB,WAAlB,CAVP;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAWC,mBAAKpJ,OAAL,CAAaF,MAAb,CAAoB,WAApB;;AAXD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxeX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAufI;;;;AAvfJ;;AAAA,SA2fiB4J,aA3fjB;AAAA;AAAA;AAAA,qFA2fW,mBAAoBxJ,UAApB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,KAAKF,OADP;AAAA;AAAA;AAAA;;AAAA,oBAEO,IAAIvH,KAAJ,CAAU,yDAAV,CAFP;;AAAA;AAAA;AAAA;AAAA,qBAIsB,KAAKyQ,YAAL,CAAkBhJ,UAAlB,CAJtB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIQC,cAAAA,IAJR;AAAA;AAAA,qBAKO,KAAKF,aAAL,CAAmBC,UAAnB,EAA+BC,IAA/B,CALP;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA3fX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAogBI;;;;;;;AApgBJ;;AAAA,SA2gBW+B,qBA3gBX,GA2gBW,+BACHyH,aADG,EAEH7I,SAFG;;;AAIH,WAAO;AACH8I,MAAAA,gBAAgB;AAAA,+EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,qDAAYD,aAAZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SADb;AAEHE,MAAAA,IAAI;AAAA,mEAAE,mBAAOxH,IAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACIyB,kBAAAA,CADJ,GACQhD,SAAS,IAAI,KAAI,CAACA,SAD1B;AAEEL,kBAAAA,OAFF,GAEYiC,kBAAA,CAAmBoH,eAAnB,CACVzH,IAAI,CAAC5F,OADK,EAEV4F,IAAI,CAACmD,qBAFK,EAGV,KAAI,CAAC1C,cAHK,CAFZ;AAOFrC,kBAAAA,OAAO,CAACsJ,WAAR,CAAoB,KAAI,CAACpG,iBAAL,EAApB,EAA8C,IAA9C;AACAlD,kBAAAA,OAAO,CAACuJ,YAAR,CAAqB,KAArB;;AARE,uBASElG,CAAC,CAAC9B,OATJ;AAAA;AAAA;AAAA;;AAAA;AAAA,yBAUkB8B,CAAC,CAAC9B,OAAF,CAAUvB,OAAV,CAVlB;;AAAA;AAUEA,kBAAAA,OAVF;;AAAA;AAAA;AAAA,yBAYgD,KAAI,CAACyD,WAAL,CAAiBzD,OAAjB,EAA0BqD,CAA1B,CAZhD;;AAAA;AAAA;AAYK0B,kBAAAA,qBAZL,yBAYKA,qBAZL;AAY4BP,kBAAAA,UAZ5B,yBAY4BA,UAZ5B;AAAA,kEAcK5C,IAdL;AAeEmD,oBAAAA,qBAAqB,EAArBA,qBAfF;AAgBEP,oBAAAA,UAAU,EAAVA;AAhBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAFD,KAAP;AAsBH;AAED;;;;AAviBJ;;AAAA,SA2iBW9C,qBA3iBX,GA2iBW;QACIzF,MAAO,KAAPA;AACP,WAAO;AACGuN,MAAAA,eADH,2BACmB5H,IADnB;;;;;;;AAEQsH,kBAAAA,gBAA8BtH,KAA9BsH,eAAelE,cAAepD,KAAfoD;;yBACD/I,GAAG,CAACwN,IAAJ,CAAS,6BAAT,EAAwC;AACzDzE,oBAAAA,WAAW,EAAXA,WADyD;AAEzD0E,oBAAAA,cAAc,EAAER,aAAa,CAACxE,GAAd,CAAkBtG,kBAAlB;AAFyC,mBAAxC;;;AAAfjH,kBAAAA;qDAICA,MAAM,CAACwS,aAAP,CAAqBjF,GAArB,CAAyBtG,kBAAzB;;;;;;;;;AACV;AARE,KAAP;AAUH;AAED;AAzjBJ;;AAAA,SA0jBkB2K,YA1jBlB;AAAA;AAAA;AAAA,oFA0jBY,mBAAmBtJ,UAAnB,EAAuCC,IAAvC,EAA8DL,MAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA8DA,MAA9D;AAA8DA,gBAAAA,MAA9D,GAAuE,KAAvE;AAAA;;AAAA;AAAA,qBACc,KAAKoJ,YAAL,CAAkBhJ,UAAlB,CADd;;AAAA;AACAmK,cAAAA,KADA;AAEAC,cAAAA,aAFA,GAEgBrD,UAAU,CAAC9G,IAAD,CAF1B;AAGAoK,cAAAA,QAHA,GAGWF,KAAK,CAACG,SAAN,CAAgB,UAACC,CAAD;AAAA,uBAAOxD,UAAU,CAACwD,CAAD,CAAV,KAAkBH,aAAzB;AAAA,eAAhB,CAHX;;AAIJ,kBAAIC,QAAQ,IAAI,CAAhB,EAAmB;AACfF,gBAAAA,KAAK,CAACK,MAAN,CAAaH,QAAb,EAAuB,CAAvB;AACH;;AACGrW,cAAAA,GAPA,GAOM,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B,MAA5B,CAPN;;AAAA,oBAQAJ,MAAM,KAAK,IARX;AAAA;AAAA;AAAA;;AAAA;AAAA,qBASM,KAAKE,OAAL,CAAcF,MAAd,CAAqB5L,GAArB,CATN;;AAAA;AAAA;AAAA;;AAAA;AAWAmW,cAAAA,KAAK,CAAC9E,OAAN,CAAcpF,IAAd;AAXA;AAAA,qBAYM,KAAKH,OAAL,CAAc+I,KAAd,CAAoB7U,GAApB,EAAyBoV,IAAI,CAACqB,SAAL,CAAeN,KAAf,CAAzB,CAZN;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA1jBZ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA0kBI;AA1kBJ;;AAAA,SA2kBkBhC,YA3kBlB;AAAA;AAAA;AAAA,oFA2kBY,mBAAmBnI,UAAnB,EAAuCkI,OAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AACAlU,cAAAA,GADA,GACM,KAAK+U,UAAL,CAAgB/I,UAAhB,EAA4B+G,UAAU,CAACmB,OAAO,CAACjI,IAAT,CAAtC,CADN;AAEA3B,cAAAA,IAFA,GAEO8K,IAAI,CAACqB,SAAL,CAAevC,OAAO,CAACrK,SAAR,EAAf,CAFP;AAAA;AAAA,qBAGE,KAAKiC,OAAL,CAAc+I,KAAd,CAAoB7U,GAApB,EAAyBsK,IAAzB,CAHF;;AAAA;AAAA;AAAA,qBAIE,KAAKgL,YAAL,CAAkBtJ,UAAlB,EAA8BkI,OAAO,CAACjI,IAAtC,CAJF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA3kBZ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAklBI;AAllBJ;;AAAA,SAmlBY8I,UAnlBZ,GAmlBY,oBAAW/I,UAAX,EAA+B0K,MAA/B;AACJ,WAAO,CAAC,KAAKnO,OAAN,EAAeyD,UAAf,EAA2B0K,MAA3B,EAAmCC,IAAnC,CAAwC,GAAxC,CAAP;AACH,GArlBL;;AAAA;AAAA;AAwlBA;;;;;AAIA,SAAStG,eAAT,CAAyB9C,GAAzB,EAAsC4C,GAAtC;AACI,SAAO,IAAIjM,OAAJ,CAAiC,UAACX,OAAD,EAAUC,MAAV;AACpC,QAAIoT,MAAM,GAAG,IAAb;AACA,QAAIC,OAAO,GAAG,CAAd;AACA,QAAMC,SAAS,GAAGvJ,GAAG,CAACoB,OAAJ,CAAY,OAAZ,EAAqB,IAArB,CAAlB;;AACA,QAAMoI,cAAc,GAAG,SAAjBA,cAAiB,CAACpJ,QAAD;AACnB,UAAI;AACApK,QAAAA,OAAO,CAAC6R,IAAI,CAACC,KAAL,CAAW1H,QAAX,CAAD,CAAP;AACH,OAFD,CAEE,OAAO9J,KAAP,EAAc;AACZA,QAAAA,KAAK,CAACmG,OAAN,GAAgB,oCAAoCnG,KAAK,CAACmG,OAA1D;AACAxG,QAAAA,MAAM,CAACK,KAAD,CAAN;AACH;AACJ,KAPD;;AAQA,QAAMmT,OAAO,GAAG,SAAVA,OAAU;AACZ,UAAM5G,MAAM,GAAG,IAAI6G,SAAJ,CAAcH,SAAd,CAAf;;AACA3G,MAAAA,GAAG,CAACpD,MAAJ,GAAa;AACT6J,QAAAA,MAAM,GAAG,KAAT;;AACA,YACIxG,MAAM,CAAC8G,UAAP,KAAsBD,SAAS,CAACE,IAAhC,IACA/G,MAAM,CAAC8G,UAAP,KAAsBD,SAAS,CAACG,UAFpC,EAGE;AACEhH,UAAAA,MAAM,CAACiH,KAAP;AACH;AACJ,OARD;;AASAjH,MAAAA,MAAM,CAACkH,SAAP,GAAmB,UAACC,KAAD;AACfX,QAAAA,MAAM,GAAG,KAAT;;AACA,YAAIxG,MAAM,CAAC8G,UAAP,KAAsBD,SAAS,CAACE,IAApC,EAA0C;AACtC/G,UAAAA,MAAM,CAACiH,KAAP;AACH;;AACD,YAAI,OAAOG,IAAP,KAAgB,WAAhB,IAA+BD,KAAK,CAACjN,IAAN,YAAsBkN,IAAzD,EAA+D;AAC3D,cAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;AACAD,UAAAA,MAAM,CAACE,MAAP,GAAgB;AACZZ,YAAAA,cAAc,CAACU,MAAM,CAAC/T,MAAR,CAAd;AACH,WAFD;;AAGA+T,UAAAA,MAAM,CAACG,OAAP,GAAiB,UAAC/T,KAAD;AACbL,YAAAA,MAAM,CAACK,KAAD,CAAN;AACH,WAFD;;AAGA4T,UAAAA,MAAM,CAACI,UAAP,CAAkBN,KAAK,CAACjN,IAAxB;AACH,SATD,MASO;AACH,cAAI,OAAOiN,KAAK,CAACjN,IAAb,KAAsB,QAA1B,EAAoC;AAChCyM,YAAAA,cAAc,CAACQ,KAAK,CAACjN,IAAP,CAAd;AACH,WAFD,MAEO,IAAIiN,KAAK,CAACjN,IAAN,YAAsBwN,WAA1B,EAAuC;AAC1Cf,YAAAA,cAAc,CAACrL,MAAM,CAACnB,IAAP,CAAYgN,KAAK,CAACjN,IAAlB,EAAwBlF,QAAxB,EAAD,CAAd;AACH,WAFM,MAEA;AACH2R,YAAAA,cAAc,CAACQ,KAAK,CAACjN,IAAN,CAAWlF,QAAX,EAAD,CAAd;AACH;AACJ;AACJ,OAvBD;;AAwBAgL,MAAAA,MAAM,CAAC2H,MAAP,GAAgB;AACZlB,QAAAA,OAAO,GAAG,CAAV;AACH,OAFD;;AAGAzG,MAAAA,MAAM,CAACwH,OAAP,GAAiB,UAACrH,CAAD,IAAjB;;AACAH,MAAAA,MAAM,CAAC4H,OAAP,GAAiB,UAACzH,CAAD;AACb,YAAIqG,MAAJ,EAAY;AACRvJ,UAAAA,UAAU,CAAC2J,OAAD,EAAUiB,OAAO,CAACpB,OAAO,EAAR,CAAjB,CAAV;AACH;AACJ,OAJD;AAKH,KA5CD;;AA6CAG,IAAAA,OAAO;AACV,GA1DM,CAAP;AA2DH;AAED;;;;;;;AAKA,SAASiB,OAAT,CAAiBC,KAAjB;AACI,SAAOC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAASH,KAAK,GAAG,EAAjB,EAAqB,CAArB,CAAT,EAAkC,KAAK,IAAvC,CAAP;AACH;AAED;;;;;;AAIA,SAASnF,UAAT,CAAoB9G,IAApB;MACS0E,QAAqB1E,KAArB0E;MAAOE,aAAc5E,KAAd4E;;AACZ,MAAIF,KAAK,KAAKnC,mBAAd,EAAmC;AAC/BmC,IAAAA,KAAK,GAAG,OAAR;AACH;;AACD,MAAIE,UAAU,KAAKrC,mBAAf,IAAsCqC,UAAU,KAAKrC,yBAAzD,EAAoF;AAChFqC,IAAAA,UAAU,GAAG,OAAb;AACH;;AACD,SAAUF,KAAV,SAAmBE,UAAnB;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}