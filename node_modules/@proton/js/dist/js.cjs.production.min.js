"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("pako"),r=require("elliptic"),n=e(require("base64url")),i=require("hash.js"),a=e(require("ripemd-ts"));require("fast-text-encoding");var s=e(require("cross-fetch"));function o(e,t,r,n,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void r(e)}o.done?t(u):Promise.resolve(u).then(n,i)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,u,"next",e)}function u(e){o(a,n,i,s,u,"throw",e)}s(void 0)}))}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t,r){return(h=f()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&p(i,r.prototype),i}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return h(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m,g,b=(function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=Object.create((t&&t.prototype instanceof f?t:f).prototype),a=new k(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return{value:void 0,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var o=_(s,r);if(o){if(o===p)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=c(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function f(){}function h(){}function l(){}var d={};d[i]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(A([])));v&&v!==t&&r.call(v,i)&&(d=v);var m=l.prototype=f.prototype=Object.create(d);function g(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(i,a){function s(){return new t((function(n,s){!function n(i,a,s,o){var u=c(e[i],e,a);if("throw"!==u.type){var p=u.arg,f=p.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,o)}),(function(e){n("throw",e,s,o)})):t.resolve(f).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,o)}))}o(u.arg)}(i,a,n,s)}))}return n=n?n.then(s,s):s()}}function _(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function A(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:z}}function z(){return{value:void 0,done:!0}}return h.prototype=m.constructor=l,l.constructor=h,h.displayName=o(l,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,o(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(b.prototype),b.prototype[a]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var s=new b(u(t,r,n,i),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},g(m),o(m,s,"Generator"),m[i]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=A,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(g={exports:{}}),g.exports),_=a.hash,w="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=function(){for(var e=Array(256).fill(-1),t=0;t<w.length;++t)e[w.charCodeAt(t)]=t;return e}(),A=function(){for(var e=Array(256).fill(-1),t=0;t<x.length;++t)e[x.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),z=function(e){return 0!=(128&e[e.length-1])},S=function(e){for(var t=1,r=0;r<e.length;++r){var n=(255&~e[r])+t;e[r]=n,t=n>>8}},E=function(e,t){for(var r=new Uint8Array(e),n=0;n<t.length;++n){var i=t.charCodeAt(n);if(i<"0".charCodeAt(0)||i>"9".charCodeAt(0))throw new Error("invalid number");for(var a=i-"0".charCodeAt(0),s=0;s<e;++s){var o=10*r[s]+a;r[s]=o,a=o>>8}if(a)throw new Error("number is out of range")}return r},N=function(e,t){var r="-"===t[0];r&&(t=t.substr(1));var n=E(e,t);if(r){if(S(n),!z(n))throw new Error("number is out of range")}else if(z(n))throw new Error("number is out of range");return n},U=function(e,t){void 0===t&&(t=1);for(var r=Array(t).fill("0".charCodeAt(0)),n=e.length-1;n>=0;--n){for(var i=e[n],a=0;a<r.length;++a){var s=(r[a]-"0".charCodeAt(0)<<8)+i;r[a]="0".charCodeAt(0)+s%10,i=s/10|0}for(;i;)r.push("0".charCodeAt(0)+i%10),i=i/10|0}return r.reverse(),String.fromCharCode.apply(String,r)},T=function(e,t){if(void 0===t&&(t=1),z(e)){var r=e.slice();return S(r),"-"+U(r,t)}return U(e,t)},P=function(e,t){if(!e)return function(e){for(var t=[],r=0;r<e.length;++r){var n=k[e.charCodeAt(r)];if(n<0)throw new Error("invalid base-58 value");for(var i=0;i<t.length;++i){var a=58*t[i]+n;t[i]=255&a,n=a>>8}n&&t.push(n)}for(var s,o=v(e);!(s=o()).done&&"1"===s.value;)t.push(0);return t.reverse(),new Uint8Array(t)}(t);for(var r=new Uint8Array(e),n=0;n<t.length;++n){var i=k[t.charCodeAt(n)];if(i<0)throw new Error("invalid base-58 value");for(var a=0;a<e;++a){var s=58*r[a]+i;r[a]=s,i=s>>8}if(i)throw new Error("base-58 value is out of range")}return r.reverse(),r},O=function(e){for(var t,r=[],n=v(e);!(t=n()).done;){for(var i=t.value,a=0;a<r.length;++a){var s=(k[r[a]]<<8)+i;r[a]=w.charCodeAt(s%58),i=s/58|0}for(;i;)r.push(w.charCodeAt(i%58)),i=i/58|0}for(var o,u=v(e);!(o=u()).done&&!o.value;)r.push("1".charCodeAt(0));return r.reverse(),String.fromCharCode.apply(String,r)},C=function(e){var t=e.length;if(1==(3&t)&&"="===e[t-1]&&(t-=1),0!=(3&t))throw new Error("base-64 value is not padded correctly");var r=t>>2,n=3*r;t>0&&"="===e[t-1]&&(n-="="===e[t-2]?2:1);for(var i=new Uint8Array(n),a=0;a<r;++a){var s=A[e.charCodeAt(4*a+0)],o=A[e.charCodeAt(4*a+1)],u=A[e.charCodeAt(4*a+2)],c=A[e.charCodeAt(4*a+3)];i[3*a+0]=s<<2|o>>4,3*a+1<n&&(i[3*a+1]=(15&o)<<4|u>>2),3*a+2<n&&(i[3*a+2]=(3&u)<<6|c)}return i};!function(e){e[e.k1=0]="k1",e[e.r1=1]="r1",e[e.wa=2]="wa",e[e.rsa=100]="rsa",e[e.eth=101]="eth"}(m||(m={}));var K=function(e,t){for(var r=new Uint8Array(e.length+t.length),n=0;n<e.length;++n)r[n]=e[n];for(var i=0;i<t.length;++i)r[e.length+i]=t.charCodeAt(i);return _(r)},j=function(e,t,r,n){var i=P(r?r+4:0,e),a={type:t,data:new Uint8Array(i.buffer,0,i.length-4)},s=new Uint8Array(K(a.data,n));if(s[0]!==i[i.length-4]||s[1]!==i[i.length-3]||s[2]!==i[i.length-2]||s[3]!==i[i.length-1])throw new Error("checksum doesn't match");return a},F=function(e,t,r){for(var n=new Uint8Array(K(e.data,t)),i=new Uint8Array(e.data.length+4),a=0;a<e.data.length;++a)i[a]=e.data[a];for(var s=0;s<4;++s)i[s+e.data.length]=n[s];return r+O(i)},R=function(e,t){if(void 0===t&&(t="EOS"),"string"!=typeof e)throw new Error("expected string containing public key");if(e.substr(0,3)===t){for(var r=P(37,e.substr(3)),n={type:m.k1,data:new Uint8Array(33)},i=0;i<33;++i)n.data[i]=r[i];var a=new Uint8Array(_(n.data));if(a[0]!==r[33]||a[1]!==r[34]||a[2]!==r[35]||a[3]!==r[36])throw new Error("checksum doesn't match");return n}if("PUB_K1_"===e.substr(0,7))return j(e.substr(7),m.k1,33,"K1");if("PUB_R1_"===e.substr(0,7))return j(e.substr(7),m.r1,33,"R1");if("PUB_WA_"===e.substr(0,7))return j(e.substr(7),m.wa,0,"WA");throw new Error("unrecognized public key format")},D=function(e,t){if(void 0===t&&(t="EOS"),e.type===m.k1&&33===e.data.length)return F(e,"",t);throw e.type===m.r1||e.type===m.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},B=function(e){if(e.type===m.k1&&33===e.data.length)return F(e,"K1","PUB_K1_");if(e.type===m.r1&&33===e.data.length)return F(e,"R1","PUB_R1_");if(e.type===m.wa)return F(e,"WA","PUB_WA_");throw new Error("unrecognized public key format")},I=function(e,t){return void 0===t&&(t="EOS"),e.substr(0,3)===t?B(R(e,t)):e},V=function(e,t){return void 0===t&&(t="EOS"),e.map((function(e){return I(e,t)}))},L=function(e){if("string"!=typeof e)throw new Error("expected string containing private key");if("PVT_R1_"===e.substr(0,7))return j(e.substr(7),m.r1,32,"R1");if("PVT_K1_"===e.substr(0,7))return j(e.substr(7),m.k1,32,"K1");var t=P(37,e),r={type:m.k1,data:new Uint8Array(32)};if(128!==t[0])throw new Error("unrecognized private key type");for(var n=0;n<32;++n)r.data[n]=t[n+1];return r},q=function(e){if(e.type===m.k1&&32===e.data.length){var t=[];t.push(128),e.data.forEach((function(e){return t.push(e)}));for(var r=new Uint8Array(i.sha256().update(i.sha256().update(t).digest()).digest()),n=new Uint8Array(37),a=0;a<t.length;a++)n[a]=t[a];for(var s=0;s<4;s++)n[s+t.length]=r[s];return O(n)}throw e.type===m.r1||e.type===m.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},G=function(e){if(e.type===m.r1)return F(e,"R1","PVT_R1_");if(e.type===m.k1)return F(e,"K1","PVT_K1_");throw new Error("unrecognized private key format")},M=function(e){if("string"!=typeof e)throw new Error("expected string containing signature");if("SIG_K1_"===e.substr(0,7))return j(e.substr(7),m.k1,65,"K1");if("SIG_R1_"===e.substr(0,7))return j(e.substr(7),m.r1,65,"R1");if("SIG_WA_"===e.substr(0,7))return j(e.substr(7),m.wa,0,"WA");throw new Error("unrecognized signature format")},W=function(e){if(e.type===m.k1)return F(e,"K1","SIG_K1_");if(e.type===m.r1)return F(e,"R1","SIG_R1_");if(e.type===m.wa)return F(e,"WA","SIG_WA_");throw new Error("unrecognized signature format")},J={__proto__:null,isNegative:z,negate:S,decimalToBinary:E,signedDecimalToBinary:N,binaryToDecimal:U,signedBinaryToDecimal:T,base58ToBinary:P,binaryToBase58:O,base64ToBinary:C,get KeyType(){return m},publicKeyDataSize:33,privateKeyDataSize:32,signatureDataSize:65,stringToPublicKey:R,publicKeyToLegacyString:D,publicKeyToString:B,convertLegacyPublicKey:I,convertLegacyPublicKeys:V,stringToPrivateKey:L,privateKeyToLegacyString:q,privateKeyToString:G,stringToSignature:M,signatureToString:W},H=function(e){void 0===e&&(e={}),this.options=void 0,this.skippedBinaryExtension=!1,this.options=e},Y=function(){function e(e){var t=void 0===e?{}:e,r=t.array,n=t.textEncoder,i=t.textDecoder;this.length=void 0,this.array=void 0,this.readPos=0,this.textEncoder=void 0,this.textDecoder=void 0,this.array=r||new Uint8Array(1024),this.length=r?r.length:0,this.textEncoder=n||new TextEncoder,this.textDecoder=i||new TextDecoder("utf-8")}var t=e.prototype;return t.reserve=function(e){if(!(this.length+e<=this.array.length)){for(var t=this.array.length;this.length+e>t;)t=Math.ceil(1.5*t);var r=new Uint8Array(t);r.set(this.array),this.array=r}},t.haveReadData=function(){return this.readPos<this.length},t.restartRead=function(){this.readPos=0},t.asUint8Array=function(){return new Uint8Array(this.array.buffer,this.array.byteOffset,this.length)},t.pushArray=function(e){this.reserve(e.length),this.array.set(e,this.length),this.length+=e.length},t.push=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.pushArray(t)},t.get=function(){if(this.readPos<this.length)return this.array[this.readPos++];throw new Error("Read past end of buffer")},t.pushUint8ArrayChecked=function(e,t){if(e.length!==t)throw new Error("Binary data has incorrect size");this.pushArray(e)},t.getUint8Array=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");var t=new Uint8Array(this.array.buffer,this.array.byteOffset+this.readPos,e);return this.readPos+=e,t},t.skip=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");this.readPos+=e},t.pushUint16=function(e){this.push(e>>0&255,e>>8&255)},t.getUint16=function(){var e=0;return(e|=this.get()<<0)|this.get()<<8},t.pushUint32=function(e){this.push(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},t.getUint32=function(){var e=0;return e|=this.get()<<0,e|=this.get()<<8,e|=this.get()<<16,(e|=this.get()<<24)>>>0},t.pushNumberAsUint64=function(e){this.pushUint32(e>>>0),this.pushUint32(Math.floor(e/4294967296)>>>0)},t.getUint64AsNumber=function(){var e=this.getUint32();return 4294967296*(this.getUint32()>>>0)+(e>>>0)},t.pushVaruint32=function(e){for(;;){if(!(e>>>7)){this.push(e);break}this.push(128|127&e),e>>>=7}},t.getVaruint32=function(){for(var e=0,t=0;;){var r=this.get();if(e|=(127&r)<<t,t+=7,!(128&r))break}return e>>>0},t.pushVarint32=function(e){this.pushVaruint32(e<<1^e>>31)},t.getVarint32=function(){var e=this.getVaruint32();return 1&e?~e>>1|2147483648:e>>>1},t.pushFloat32=function(e){this.pushArray(new Uint8Array(new Float32Array([e]).buffer))},t.getFloat32=function(){return new Float32Array(this.getUint8Array(4).slice().buffer)[0]},t.pushFloat64=function(e){this.pushArray(new Uint8Array(new Float64Array([e]).buffer))},t.getFloat64=function(){return new Float64Array(this.getUint8Array(8).slice().buffer)[0]},t.pushName=function(e){if("string"!=typeof e)throw new Error("Expected string containing name");if(!new RegExp(/^[.1-5a-z]{0,12}[.1-5a-j]?$/).test(e))throw new Error("Name should be less than 13 characters, or less than 14 if last character is between 1-5 or a-j, and only contain the following symbols .12345abcdefghijklmnopqrstuvwxyz");for(var t=function(e){return e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+6:e>="1".charCodeAt(0)&&e<="5".charCodeAt(0)?e-"1".charCodeAt(0)+1:0},r=new Uint8Array(8),n=63,i=0;i<e.length;++i){var a=t(e.charCodeAt(i));n<5&&(a<<=1);for(var s=4;s>=0;--s)n>=0&&(r[Math.floor(n/8)]|=(a>>s&1)<<n%8,--n)}this.pushArray(r)},t.getName=function(){for(var e=this.getUint8Array(8),t="",r=63;r>=0;){for(var n=0,i=0;i<5;++i)r>=0&&(n=n<<1|e[Math.floor(r/8)]>>r%8&1,--r);t+=n>=6?String.fromCharCode(n+"a".charCodeAt(0)-6):n>=1?String.fromCharCode(n+"1".charCodeAt(0)-1):"."}for(;t.endsWith(".");)t=t.substr(0,t.length-1);return t},t.pushBytes=function(e){this.pushVaruint32(e.length),this.pushArray(e)},t.getBytes=function(){return this.getUint8Array(this.getVaruint32())},t.pushString=function(e){this.pushBytes(this.textEncoder.encode(e))},t.getString=function(){return this.textDecoder.decode(this.getBytes())},t.pushSymbolCode=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol_code");var t=[];for(t.push.apply(t,this.textEncoder.encode(e));t.length<8;)t.push(0);this.pushArray(t.slice(0,8))},t.getSymbolCode=function(){var e,t=this.getUint8Array(8);for(e=0;e<t.length&&t[e];++e);return this.textDecoder.decode(new Uint8Array(t.buffer,t.byteOffset,e))},t.pushSymbol=function(e){var t=e.name,r=e.precision;if(!/^[A-Z]{1,7}$/.test(t))throw new Error("Expected symbol to be A-Z and between one and seven characters");var n=[255&r];for(n.push.apply(n,this.textEncoder.encode(t));n.length<8;)n.push(0);this.pushArray(n.slice(0,8))},t.getSymbol=function(){var e,t=this.get(),r=this.getUint8Array(7);for(e=0;e<r.length&&r[e];++e);return{name:this.textDecoder.decode(new Uint8Array(r.buffer,r.byteOffset,e)),precision:t}},t.pushAsset=function(e){if("string"!=typeof e)throw new Error("Expected string containing asset");var t=0,r="",n=0;"-"===(e=e.trim())[t]&&(r+="-",++t);for(var i=!1;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)i=!0,r+=e[t],++t;if(!i)throw new Error("Asset must begin with a number");if("."===e[t])for(++t;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)r+=e[t],++n,++t;var a=e.substr(t).trim();this.pushArray(N(8,r)),this.pushSymbol({name:a,precision:n})},t.getAsset=function(){var e=this.getUint8Array(8),t=this.getSymbol(),r=t.name,n=t.precision,i=T(e,n+1);return n&&(i=i.substr(0,i.length-n)+"."+i.substr(i.length-n)),i+" "+r},t.pushPublicKey=function(e){var t=R(e);this.push(t.type),this.pushArray(t.data)},t.getPublicKey=function(){var e,t=this.get();if(t===m.wa){var r=this.readPos;this.skip(34),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+r,this.readPos-r)}else e=this.getUint8Array(33);return B({type:t,data:e})},t.pushPrivateKey=function(e){var t=L(e);this.push(t.type),this.pushArray(t.data)},t.getPrivateKey=function(){var e=this.get(),t=this.getUint8Array(32);return G({type:e,data:t})},t.pushSignature=function(e){var t=M(e);this.push(t.type),this.pushArray(t.data)},t.getSignature=function(){var e,t=this.get();if(t===m.wa){var r=this.readPos;this.skip(65),this.skip(this.getVaruint32()),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+r,this.readPos-r)}else e=this.getUint8Array(65);return W({type:t,data:e})},e}(),Z=function(e){return e.startsWith("eosio::abi/1.")},$=function(e){var t=Date.parse(e);if(Number.isNaN(t))throw new Error("Invalid time format");return t},Q=function(e){return Math.round(1e3*$(e+"Z"))},X=function(e){var t=new Date(e/1e3).toISOString();return t.substr(0,t.length-1)},ee=function(e){return Math.round($(e+"Z")/1e3)},te=function(e){var t=new Date(1e3*e).toISOString();return t.substr(0,t.length-1)},re=function(e){return Math.round(($(e+"Z")-9466848e5)/500)},ne=function(e){var t=new Date(500*e+9466848e5).toISOString();return t.substr(0,t.length-1)},ie=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol");var t=e.match(/^([0-9]+),([A-Z]+)$/);if(!t)throw new Error("Invalid symbol");return{name:t[2],precision:+t[1]}},ae=function(e){return e.precision+","+e.name},se=function(e){for(var t,r="",n=v(e);!(t=n()).done;)r+=("00"+t.value.toString(16)).slice(-2);return r.toUpperCase()},oe=function(e){if("string"!=typeof e)throw new Error("Expected string containing hex digits");if(e.length%2)throw new Error("Odd number of hex digits");for(var t=e.length/2,r=new Uint8Array(t),n=0;n<t;++n){var i=parseInt(e.substr(2*n,2),16);if(Number.isNaN(i))throw new Error("Expected hex string");r[n]=i}return r};function ue(e,t){throw new Error("Don't know how to serialize "+this.name)}function ce(e){throw new Error("Don't know how to deserialize "+this.name)}function pe(e,t,r,n){if(void 0===r&&(r=new H),void 0===n&&(n=!0),"object"!=typeof t)throw new Error("expected object containing data: "+JSON.stringify(t));this.base&&this.base.serialize(e,t,r,n);for(var i,a=v(this.fields);!(i=a()).done;){var s=i.value;if(s.name in t){if(r.skippedBinaryExtension)throw new Error("unexpected "+this.name+"."+s.name);s.type.serialize(e,t[s.name],r,n&&s===this.fields[this.fields.length-1])}else{if(!n||!s.type.extensionOf)throw new Error("missing "+this.name+"."+s.name+" (type="+s.type.name+")");r.skippedBinaryExtension=!0}}}function fe(e,t,r){var n;void 0===t&&(t=new H),void 0===r&&(r=!0),n=this.base?this.base.deserialize(e,t,r):{};for(var i,a=v(this.fields);!(i=a()).done;){var s=i.value;r&&s.type.extensionOf&&!e.haveReadData()?t.skippedBinaryExtension=!0:n[s.name]=s.type.deserialize(e,t,r)}return n}function he(e,t,r,n){if(!Array.isArray(t)||2!==t.length||"string"!=typeof t[0])throw new Error('expected variant: ["type", value]');var i=this.fields.findIndex((function(e){return e.name===t[0]}));if(i<0)throw new Error('type "'+t[0]+'" is not valid for variant');e.pushVaruint32(i),this.fields[i].type.serialize(e,t[1],r,n)}function le(e,t,r){var n=e.getVaruint32();if(n>=this.fields.length)throw new Error("type index "+n+" is not valid for variant");var i=this.fields[n];return[i.name,i.type.deserialize(e,t,r)]}function de(e,t,r,n){e.pushVaruint32(t.length);for(var i,a=v(t);!(i=a()).done;)this.arrayOf.serialize(e,i.value,r,!1)}function ye(e,t,r){for(var n=e.getVaruint32(),i=[],a=0;a<n;++a)i.push(this.arrayOf.deserialize(e,t,!1));return i}function ve(e,t,r,n){null==t?e.push(0):(e.push(1),this.optionalOf.serialize(e,t,r,n))}function me(e,t,r){return e.get()?this.optionalOf.deserialize(e,t,r):null}function ge(e,t,r,n){this.extensionOf.serialize(e,t,r,n)}function be(e,t,r){return this.extensionOf.deserialize(e,t,r)}function _e(e,t,r,n){var i=Object.entries(t);e.pushVaruint32(i.length);for(var a=0,s=i;a<s.length;a++){var o=s[a],u=o[1],c=this.fields[1].type;this.fields[0].type.serialize(e,o[0],r,n),c.serialize(e,u,r,n)}}function we(e,t,r){for(var n=e.getVaruint32(),i={},a=0;a<n;++a){var s=this.fields[1].type;i[this.fields[0].type.deserialize(e,t,r)]=s.deserialize(e,t,r)}return i}function xe(e,t,r,n){var i=this;e.pushVaruint32(t.length),t.forEach((function(t){i.fields[0].type.serialize(e,t[0],r,n),i.fields[1].type.serialize(e,t[1],r,n)}))}function ke(e,t,r){for(var n=[],i=e.getVaruint32(),a=0;a<i;++a)n.push(this.fields[0].type.deserialize(e,t,r)),n.push(this.fields[1].type.deserialize(e,t,r));return n}var Ae=function(e){return Object.assign({name:"<missing name>",aliasOfName:"",arrayOf:void 0,optionalOf:void 0,extensionOf:void 0,baseName:"",base:void 0,fields:[],serialize:ue,deserialize:ce},e)},ze=function(e,t){if(Number.isNaN(+e)||Number.isNaN(+t)||"number"!=typeof e&&"string"!=typeof e)throw new Error("Expected number");if(+e!=+t)throw new Error("Number is out of range");return+e},Se=function(){var e=new Map(Object.entries({bool:Ae({name:"bool",serialize:function(e,t){if("boolean"!=typeof t&&("number"!=typeof t||1!==t&&0!==t))throw new Error("Expected boolean or number equal to 1 or 0");e.push(t?1:0)},deserialize:function(e){return!!e.get()}}),uint8:Ae({name:"uint8",serialize:function(e,t){e.push(ze(t,255&t))},deserialize:function(e){return e.get()}}),int8:Ae({name:"int8",serialize:function(e,t){e.push(ze(t,t<<24>>24))},deserialize:function(e){return e.get()<<24>>24}}),uint16:Ae({name:"uint16",serialize:function(e,t){e.pushUint16(ze(t,65535&t))},deserialize:function(e){return e.getUint16()}}),int16:Ae({name:"int16",serialize:function(e,t){e.pushUint16(ze(t,t<<16>>16))},deserialize:function(e){return e.getUint16()<<16>>16}}),uint32:Ae({name:"uint32",serialize:function(e,t){e.pushUint32(ze(t,t>>>0))},deserialize:function(e){return e.getUint32()}}),uint64:Ae({name:"uint64",serialize:function(e,t){e.pushArray(E(8,""+t))},deserialize:function(e){return U(e.getUint8Array(8))}}),int64:Ae({name:"int64",serialize:function(e,t){e.pushArray(N(8,""+t))},deserialize:function(e){return T(e.getUint8Array(8))}}),int32:Ae({name:"int32",serialize:function(e,t){e.pushUint32(ze(t,0|t))},deserialize:function(e){return 0|e.getUint32()}}),varuint32:Ae({name:"varuint32",serialize:function(e,t){e.pushVaruint32(ze(t,t>>>0))},deserialize:function(e){return e.getVaruint32()}}),varint32:Ae({name:"varint32",serialize:function(e,t){e.pushVarint32(ze(t,0|t))},deserialize:function(e){return e.getVarint32()}}),uint128:Ae({name:"uint128",serialize:function(e,t){e.pushArray(E(16,""+t))},deserialize:function(e){return U(e.getUint8Array(16))}}),int128:Ae({name:"int128",serialize:function(e,t){e.pushArray(N(16,""+t))},deserialize:function(e){return T(e.getUint8Array(16))}}),float32:Ae({name:"float32",serialize:function(e,t){e.pushFloat32(t)},deserialize:function(e){return e.getFloat32()}}),float64:Ae({name:"float64",serialize:function(e,t){e.pushFloat64(t)},deserialize:function(e){return e.getFloat64()}}),float128:Ae({name:"float128",serialize:function(e,t){e.pushUint8ArrayChecked(oe(t),16)},deserialize:function(e){return se(e.getUint8Array(16))}}),bytes:Ae({name:"bytes",serialize:function(e,t){t instanceof Uint8Array||Array.isArray(t)?e.pushBytes(t):e.pushBytes(oe(t))},deserialize:function(e,t){return t&&t.options.bytesAsUint8Array?e.getBytes():se(e.getBytes())}}),string:Ae({name:"string",serialize:function(e,t){e.pushString(t)},deserialize:function(e){return e.getString()}}),name:Ae({name:"name",serialize:function(e,t){e.pushName(t)},deserialize:function(e){return e.getName()}}),time_point:Ae({name:"time_point",serialize:function(e,t){e.pushNumberAsUint64(Q(t))},deserialize:function(e){return X(e.getUint64AsNumber())}}),time_point_sec:Ae({name:"time_point_sec",serialize:function(e,t){e.pushUint32(ee(t))},deserialize:function(e){return te(e.getUint32())}}),block_timestamp_type:Ae({name:"block_timestamp_type",serialize:function(e,t){e.pushUint32(re(t))},deserialize:function(e){return ne(e.getUint32())}}),symbol_code:Ae({name:"symbol_code",serialize:function(e,t){e.pushSymbolCode(t)},deserialize:function(e){return e.getSymbolCode()}}),symbol:Ae({name:"symbol",serialize:function(e,t){e.pushSymbol(ie(t))},deserialize:function(e){return ae(e.getSymbol())}}),asset:Ae({name:"asset",serialize:function(e,t){e.pushAsset(t)},deserialize:function(e){return e.getAsset()}}),checksum160:Ae({name:"checksum160",serialize:function(e,t){e.pushUint8ArrayChecked(oe(t),20)},deserialize:function(e){return se(e.getUint8Array(20))}}),checksum256:Ae({name:"checksum256",serialize:function(e,t){e.pushUint8ArrayChecked(oe(t),32)},deserialize:function(e){return se(e.getUint8Array(32))}}),checksum512:Ae({name:"checksum512",serialize:function(e,t){e.pushUint8ArrayChecked(oe(t),64)},deserialize:function(e){return se(e.getUint8Array(64))}}),public_key:Ae({name:"public_key",serialize:function(e,t){e.pushPublicKey(t)},deserialize:function(e){return e.getPublicKey()}}),private_key:Ae({name:"private_key",serialize:function(e,t){e.pushPrivateKey(t)},deserialize:function(e){return e.getPrivateKey()}}),signature:Ae({name:"signature",serialize:function(e,t){e.pushSignature(t)},deserialize:function(e){return e.getSignature()}})}));return e.set("extended_asset",Ae({name:"extended_asset",baseName:"",fields:[{name:"quantity",typeName:"asset",type:e.get("asset")},{name:"contract",typeName:"name",type:e.get("name")}],serialize:pe,deserialize:fe})),e},Ee=function(){var e=Se();return e.set("extensions_entry",Ae({name:"extensions_entry",baseName:"",fields:[{name:"tag",typeName:"uint16",type:void 0},{name:"value",typeName:"bytes",type:void 0}],serialize:pe,deserialize:fe})),e.set("type_def",Ae({name:"type_def",baseName:"",fields:[{name:"new_type_name",typeName:"string",type:void 0},{name:"type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("field_def",Ae({name:"field_def",baseName:"",fields:[{name:"name",typeName:"string",type:void 0},{name:"type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("struct_def",Ae({name:"struct_def",baseName:"",fields:[{name:"name",typeName:"string",type:void 0},{name:"base",typeName:"string",type:void 0},{name:"fields",typeName:"field_def[]",type:void 0}],serialize:pe,deserialize:fe})),e.set("action_def",Ae({name:"action_def",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"type",typeName:"string",type:void 0},{name:"ricardian_contract",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("table_def",Ae({name:"table_def",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"index_type",typeName:"string",type:void 0},{name:"key_names",typeName:"string[]",type:void 0},{name:"key_types",typeName:"string[]",type:void 0},{name:"type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("clause_pair",Ae({name:"clause_pair",baseName:"",fields:[{name:"id",typeName:"string",type:void 0},{name:"body",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("error_message",Ae({name:"error_message",baseName:"",fields:[{name:"error_code",typeName:"uint64",type:void 0},{name:"error_msg",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("variant_def",Ae({name:"variant_def",baseName:"",fields:[{name:"name",typeName:"string",type:void 0},{name:"types",typeName:"string[]",type:void 0}],serialize:pe,deserialize:fe})),e.set("action_result",Ae({name:"action_result",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"result_type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("primary_key_index_def",Ae({name:"primary_key_index_def",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("secondary_index_def",Ae({name:"secondary_index_def",baseName:"",fields:[{name:"type",typeName:"string",type:void 0}],serialize:pe,deserialize:fe})),e.set("secondary_indices",Ae({name:"secondary_indices",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"secondary_index_def",typeName:"secondary_index_def",type:void 0}],serialize:_e,deserialize:we})),e.set("kv_table_entry_def",Ae({name:"kv_table_entry_def",baseName:"",fields:[{name:"type",typeName:"string",type:void 0},{name:"primary_index",typeName:"primary_key_index_def",type:void 0},{name:"secondary_indices",typeName:"secondary_indices",type:void 0}],serialize:pe,deserialize:fe})),e.set("kv_table",Ae({name:"kv_table",baseName:"",fields:[{name:"name",typeName:"name",type:void 0},{name:"kv_table_entry_def",typeName:"kv_table_entry_def",type:void 0}],serialize:_e,deserialize:we})),e.set("abi_def",Ae({name:"abi_def",baseName:"",fields:[{name:"version",typeName:"string",type:void 0},{name:"types",typeName:"type_def[]",type:void 0},{name:"structs",typeName:"struct_def[]",type:void 0},{name:"actions",typeName:"action_def[]",type:void 0},{name:"tables",typeName:"table_def[]",type:void 0},{name:"ricardian_clauses",typeName:"clause_pair[]",type:void 0},{name:"error_messages",typeName:"error_message[]",type:void 0},{name:"abi_extensions",typeName:"extensions_entry[]",type:void 0},{name:"variants",typeName:"variant_def[]$",type:void 0},{name:"action_results",typeName:"action_result[]$",type:void 0},{name:"kv_tables",typeName:"kv_table$",type:void 0}],serialize:pe,deserialize:fe})),e},Ne=function(){var e=Se();return e.set("resource_payer",Ae({name:"resource_payer",baseName:"",fields:[{name:"payer",typeName:"name",type:void 0},{name:"max_net_bytes",typeName:"uint64",type:void 0},{name:"max_cpu_us",typeName:"uint64",type:void 0},{name:"max_memory_bytes",typeName:"uint64",type:void 0}],serialize:pe,deserialize:fe})),e},Ue=function(){var e=Se();return e.set("permission_level",Ae({name:"permission_level",baseName:"",fields:[{name:"actor",typeName:"name",type:void 0},{name:"permission",typeName:"name",type:void 0}],serialize:pe,deserialize:fe})),e.set("action",Ae({name:"action",baseName:"",fields:[{name:"account",typeName:"name",type:void 0},{name:"name",typeName:"name",type:void 0},{name:"authorization",typeName:"permission_level[]",type:void 0},{name:"data",typeName:"bytes",type:void 0}],serialize:pe,deserialize:fe})),e.set("extension",Ae({name:"extension",baseName:"",fields:[{name:"type",typeName:"uint16",type:void 0},{name:"data",typeName:"bytes",type:void 0}],serialize:xe,deserialize:ke})),e.set("transaction_header",Ae({name:"transaction_header",baseName:"",fields:[{name:"expiration",typeName:"time_point_sec",type:void 0},{name:"ref_block_num",typeName:"uint16",type:void 0},{name:"ref_block_prefix",typeName:"uint32",type:void 0},{name:"max_net_usage_words",typeName:"varuint32",type:void 0},{name:"max_cpu_usage_ms",typeName:"uint8",type:void 0},{name:"delay_sec",typeName:"varuint32",type:void 0}],serialize:pe,deserialize:fe})),e.set("transaction",Ae({name:"transaction",baseName:"transaction_header",fields:[{name:"context_free_actions",typeName:"action[]",type:void 0},{name:"actions",typeName:"action[]",type:void 0},{name:"transaction_extensions",typeName:"extension",type:void 0}],serialize:pe,deserialize:fe})),e},Te=function e(t,r){var n=t.get(r);if(n&&n.aliasOfName)return e(t,n.aliasOfName);if(n)return n;if(r.endsWith("[]"))return Ae({name:r,arrayOf:e(t,r.substr(0,r.length-2)),serialize:de,deserialize:ye});if(r.endsWith("?"))return Ae({name:r,optionalOf:e(t,r.substr(0,r.length-1)),serialize:ve,deserialize:me});if(r.endsWith("$"))return Ae({name:r,extensionOf:e(t,r.substr(0,r.length-1)),serialize:ge,deserialize:be});throw new Error("Unknown type: "+r)},Pe=function(e,t){var r=new Map(e);if(t&&t.types)for(var n,i=v(t.types);!(n=i()).done;){var a=n.value,s=a.new_type_name;r.set(s,Ae({name:s,aliasOfName:a.type}))}if(t&&t.structs)for(var o,u=v(t.structs);!(o=u()).done;){var c=o.value,p=c.name;r.set(p,Ae({name:p,baseName:c.base,fields:c.fields.map((function(e){return{name:e.name,typeName:e.type,type:void 0}})),serialize:pe,deserialize:fe}))}if(t&&t.variants)for(var f,h=v(t.variants);!(f=h()).done;){var l=f.value,d=l.name;r.set(d,Ae({name:d,fields:l.types.map((function(e){return{name:e,typeName:e,type:void 0}})),serialize:he,deserialize:le}))}for(var y,m=v(r);!(y=m()).done;){var g=y.value[1];g.baseName&&(g.base=Te(r,g.baseName));for(var b,_=v(g.fields);!(b=_()).done;){var w=b.value;w.type=Te(r,w.typeName)}}return r},Oe=function(e,t){var r,n=e.header?e.header.timestamp:e.timestamp,i=parseInt((r=e.id.substr(16,8)).substr(6,2)+r.substr(4,2)+r.substr(2,2)+r.substr(0,2),16);return{expiration:te(ee(n)+t),ref_block_num:65535&e.block_num,ref_block_prefix:i}},Ce=function(e,t,r,n){var i=e.actions.get(r);if(!i)throw new Error("Unknown action "+r+" in contract "+t);var a=new Y;return i.serialize(a,n),se(a.asUint8Array())},Ke=function(e,t,r,n,i){return{account:t,name:r,authorization:n,data:Ce(e,t,r,i)}},je=function(e,t,r,n){var i=e.actions.get(r);if("string"==typeof n&&(n=oe(n)),!i)throw new Error("Unknown action "+r+" in contract "+t);var a=new Y;return a.pushArray(n),i.deserialize(a)},Fe=function(e,t,r,n,i){return{account:t,name:r,authorization:n,data:je(e,t,r,i)}},Re=function(e,t){var r,n;if(null===t){var i=[Me.null_t,t];r=i[0],n=i[1]}else if("string"==typeof t){var a=[Me.string,t];r=a[0],n=a[1]}else if("number"==typeof t){var s=[Me.int32,t];r=s[0],n=s[1]}else if(t instanceof Uint8Array){var o=[Me.bytes,t];r=o[0],n=o[1]}else if(Array.isArray(t)){var u=[Me.any_array,t];r=u[0],n=u[1]}else if(2===Object.keys(t).length&&t.hasOwnProperty("type")&&t.hasOwnProperty("value")){var c=[Me[t.type],t.value];r=c[0],n=c[1]}else{var p=[Me.any_object,t];r=p[0],n=p[1]}e.pushVaruint32(r.index),r.type.serialize(e,n)},De=function(e,t){var r=e.getVaruint32();if(r>=We.length)throw new Error("Tried to deserialize unknown anyvar type");var n=We[r],i=n.type.deserialize(e,t);return t&&t.options.useShortForm||n.useShortForm?i:{type:n.type.name,value:i}},Be=function(e){return De(e,new H({useShortForm:!0}))},Ie=function(e,t){var r=Object.entries(t);e.pushVaruint32(r.length);for(var n=0,i=r;n<i.length;n++){var a=i[n],s=a[1];e.pushString(a[0]),Re(e,s)}},Ve=function(e,t){for(var r=e.getVaruint32(),n={},i=0;i<r;++i){var a=e.getString();if(a in n){for(var s=1;a+"_"+s in n;)++s;a=a+"_"+s}n[a]=De(e,t)}return n},Le=function(e,t){e.pushVaruint32(t.length);for(var r,n=v(t);!(r=n()).done;)Re(e,r.value)},qe=function(e,t){for(var r=e.getVaruint32(),n=[],i=0;i<r;++i)n.push(De(e,t));return n},Ge=function(){var e=Se();return e.set("null_t",Ae({name:"null_t",serialize:function(e,t){},deserialize:function(e,t){}})),e.set("any_object",Ae({name:"any_object",serialize:Ie,deserialize:Ve})),e.set("any_array",Ae({name:"any_array",serialize:Le,deserialize:qe})),e}(),Me={null_t:{index:0,useShortForm:!0,type:Ge.get("null_t")},int64:{index:1,useShortForm:!1,type:Ge.get("int64")},uint64:{index:2,useShortForm:!1,type:Ge.get("uint64")},int32:{index:3,useShortForm:!0,type:Ge.get("int32")},uint32:{index:4,useShortForm:!1,type:Ge.get("uint32")},int16:{index:5,useShortForm:!1,type:Ge.get("int16")},uint16:{index:6,useShortForm:!1,type:Ge.get("uint16")},int8:{index:7,useShortForm:!1,type:Ge.get("int8")},uint8:{index:8,useShortForm:!1,type:Ge.get("uint8")},time_point:{index:9,useShortForm:!1,type:Ge.get("time_point")},checksum256:{index:10,useShortForm:!1,type:Ge.get("checksum256")},float64:{index:11,useShortForm:!1,type:Ge.get("float64")},string:{index:12,useShortForm:!0,type:Ge.get("string")},any_object:{index:13,useShortForm:!0,type:Ge.get("any_object")},any_array:{index:14,useShortForm:!0,type:Ge.get("any_array")},bytes:{index:15,useShortForm:!1,type:Ge.get("bytes")},symbol:{index:16,useShortForm:!1,type:Ge.get("symbol")},symbol_code:{index:17,useShortForm:!1,type:Ge.get("symbol_code")},asset:{index:18,useShortForm:!1,type:Ge.get("asset")}},We=[Me.null_t,Me.int64,Me.uint64,Me.int32,Me.uint32,Me.int16,Me.uint16,Me.int8,Me.uint8,Me.time_point,Me.checksum256,Me.float64,Me.string,Me.any_object,Me.any_array,Me.bytes,Me.symbol,Me.symbol_code,Me.asset],Je=function e(t,r){var n,i,a;if("string"==typeof r)n=r;else if(Array.isArray(r)&&2===r.length)n=r[0],a=r[1];else if(Array.isArray(r)&&3===r.length)n=r[0],i=r[1],a=r[2];else{var s=[r.method,r.arg,r.filter];n=s[0],i=s[1],a=s[2]}if(t.pushString(n),void 0===i?t.push(0):(t.push(1),Re(t,i)),void 0===a)t.push(0);else{t.pushVaruint32(a.length);for(var o,u=v(a);!(o=u()).done;)e(t,o.value)}};function He(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}var Ye={__proto__:null,SerializerState:H,SerialBuffer:Y,supportedAbiVersion:Z,dateToTimePoint:Q,timePointToDate:X,dateToTimePointSec:ee,timePointSecToDate:te,dateToBlockTimestamp:re,blockTimestampToDate:ne,stringToSymbol:ie,symbolToString:ae,arrayToHex:se,hexToUint8Array:oe,createInitialTypes:Se,createAbiTypes:Ee,createTransactionExtensionTypes:Ne,createTransactionTypes:Ue,getType:Te,getTypesFromAbi:Pe,transactionHeader:Oe,serializeActionData:Ce,serializeAction:Ke,deserializeActionData:je,deserializeAction:Fe,serializeAnyvar:Re,deserializeAnyvar:De,deserializeAnyvarShort:Be,serializeAnyObject:Ie,deserializeAnyObject:Ve,serializeAnyArray:Le,deserializeAnyArray:qe,serializeQuery:Je,b64tob64u:He},Ze=function(e){return new r.ec(e===m.k1?"secp256k1":"p256")},$e=function(e){return i.sha256().update(e).digest("hex")},Qe=function(){function e(e,t){this.key=void 0,this.ec=void 0,this.key=e,this.ec=t}e.fromString=function(t,r){var n=R(t);return r||(r=Ze(n.type)),new e(n,r)},e.fromElliptic=function(t,r,n){var i=t.getPublic().getX().toArray("be",32),a=t.getPublic().getY().toArray("be",32);return n||(n=Ze(r)),new e({type:r,data:new Uint8Array([1&a[31]?3:2].concat(i))},n)};var t=e.prototype;return t.toString=function(){return B(this.key)},t.toLegacyString=function(e){return D(this.key,e)},t.toElliptic=function(){return this.ec.keyPair({pub:Buffer.from(this.key.data)})},t.getType=function(){return this.key.type},t.isValid=function(){try{return this.toElliptic().validate().result}catch(e){return!1}},e}(),Xe=require("bn.js"),et=function(){function e(e,t){this.signature=void 0,this.ec=void 0,this.signature=e,this.ec=t}e.fromString=function(t,r){var n=M(t);return r||(r=Ze(n.type)),new e(n,r)},e.fromElliptic=function(t,r,n){t.recoveryParam||(t.recoveryParam=0);var i,a=t.r.toArray("be",32),s=t.s.toArray("be",32);r===m.k1||r===m.r1?(i=t.recoveryParam+27,t.recoveryParam<=3&&(i+=4)):r===m.wa&&(i=t.recoveryParam);var o=new Uint8Array([i].concat(a,s));return n||(n=Ze(r)),new e({type:r,data:o},n)};var t=e.prototype;return t.toElliptic=function(){var e,t=new Xe(this.signature.data.slice(1,33)),r=new Xe(this.signature.data.slice(33,65));return this.signature.type===m.k1||this.signature.type===m.r1?(e=this.signature.data[0]-27)>3&&(e-=4):e=this.signature.type===m.wa?this.signature.data[0]:0,{r:t,s:r,recoveryParam:3&e}},t.toString=function(){return W(this.signature)},t.toBinary=function(){return this.signature.data},t.getType=function(){return this.signature.type},t.verify=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n="utf8"),r&&("string"==typeof e&&(e=Buffer.from(e,n)),e=this.ec.hash().update(e).digest());var i=this.toElliptic(),a=t.toElliptic();return this.ec.verify(e,i,a,n)},t.recover=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r="utf8"),t&&("string"==typeof e&&(e=Buffer.from(e,r)),e=this.ec.hash().update(e).digest());var n=this.toElliptic(),i=this.ec.recoverPubKey(e,n,n.recoveryParam,r),a=this.ec.keyFromPublic(i);return Qe.fromElliptic(a,this.getType(),this.ec)},e}(),tt=function(){function e(e,t){this.key=void 0,this.ec=void 0,this.key=e,this.ec=t}e.fromElliptic=function(t,r,n){return n||(n=Ze(r)),new e({type:r,data:t.getPrivate().toArrayLike(Buffer,"be",32)},n)},e.fromString=function(t,r){var n=L(t);return r||(r=Ze(n.type)),new e(n,r)};var t=e.prototype;return t.toElliptic=function(){return this.ec.keyFromPrivate(this.key.data)},t.toLegacyString=function(){return q(this.key)},t.toString=function(){return G(this.key)},t.getType=function(){return this.key.type},t.getPublicKey=function(){var e=this.toElliptic();return Qe.fromElliptic(e,this.getType(),this.ec)},t.sign=function(e,t,r){var n=this;void 0===t&&(t=!0),void 0===r&&(r="utf8"),t&&("string"==typeof e&&(e=Buffer.from(e,r)),e=this.ec.hash().update(e).digest());var i,a,s=0,o=function(t){var r=n.toElliptic().sign(e,t);return et.fromElliptic(r,n.getType(),n.ec)};if(this.key.type===m.k1)do{i=o({canonical:!0,pers:[++s]})}while(128&(a=i.toBinary())[1]||0===a[1]&&!(128&a[2])||128&a[33]||!(0!==a[33]||128&a[34]));else i=o({canonical:!0});return i},t.isValid=function(){try{return this.toElliptic().validate().result}catch(e){return!1}},e}(),rt={__proto__:null,generateKeyPair:function(e,t){if(void 0===t&&(t={}),!t.secureEnv)throw new Error("Key generation is completely INSECURE in production environments in the browser. If you are absolutely certain this does NOT describe your environment, set `secureEnv` in your options to `true`.  If this does describe your environment and you set `secureEnv` to `true`, YOU DO SO AT YOUR OWN RISK AND THE RISK OF YOUR USERS.");var n,i=(n=new r.ec(e===m.k1?"secp256k1":"p256")).genKeyPair(t.ecOptions);return{publicKey:Qe.fromElliptic(i,e,n),privateKey:tt.fromElliptic(i,e,n)}},PrivateKey:tt,PublicKey:Qe,Signature:et,constructElliptic:Ze},nt=new r.ec("secp256k1"),it=function(e,t,r,n){void 0===n&&(n=nt);var i=Buffer.concat([Buffer.from(e,"hex"),Buffer.from(t),Buffer.from(r?new Uint8Array(n.hash().update(r).digest()):new Uint8Array(32))]);return n.hash().update(i).digest()},at=function(){function e(e){this.keys=new Map,this.availableKeys=[];for(var t,r=v(e);!(t=r()).done;){var n=tt.fromString(t.value),i=n.toElliptic(),a=n.getPublicKey().toString();this.keys.set(a,i),this.availableKeys.push(a)}}var t=e.prototype;return t.getAvailableKeys=function(){var e=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.availableKeys);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.sign=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c,p,f,h,l;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.requiredKeys,a=it(t.chainId,n=t.serializedTransaction,i=t.serializedContextFreeData,nt),s=[],o=v(r);!(u=o()).done;)p=Qe.fromString(c=u.value),(f=this.keys.get(I(c)))&&(h=tt.fromElliptic(f,p.getType()),l=h.sign(a,!1),s.push(l.toString()));return e.abrupt("return",{signatures:s,serializedTransaction:n,serializedContextFreeData:i});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),st=function(){function e(e){this.rpc=void 0,this.authorityProvider=void 0,this.abiProvider=void 0,this.signatureProvider=void 0,this.abiTypes=void 0,this.transactionTypes=void 0,this.contracts=new Map,this.cachedAbis=new Map,this.crypto=void 0,this.recoverPersonalSignature=void 0,this.transactionExtensions=[{id:1,type:"resource_payer",keys:["payer","max_net_bytes","max_cpu_us","max_memory_bytes"]}],this.rpc=e.rpc,this.authorityProvider=e.authorityProvider||e.rpc,this.abiProvider=e.abiProvider||e.rpc,e.signatureProvider&&(this.signatureProvider=e.signatureProvider),this.abiTypes=Pe(Ee()),this.transactionTypes=Pe(Ue()),this.crypto=e.crypto||"undefined"!=typeof window&&window&&window.crypto||global&&global.crypto,this.recoverPersonalSignature=e.recoverPersonalSignature}var i=e.prototype;return i.getCrypto=function(){if(!this.crypto)throw new Error("No 'crypto' module found. On nodejs, do const { Crypto } = require('@peculiar/webcrypto'); const crypto = new Crypto; new Api({ rpc, crypto });");return this.crypto},i.getRecoverPersonalSignature=function(){if(!this.recoverPersonalSignature)throw new Error("No 'recoverPersonalSignature' function found. Do const { recoverPersonalSignature } = require('eth-sig-util'); new Api({ rpc, recoverPersonalSignature });");return this.recoverPersonalSignature},i.rawAbiToJson=function(e){var t=new Y({array:e});if(!Z(t.getString()))throw new Error("Unsupported abi version");return t.restartRead(),this.abiTypes.get("abi_def").deserialize(t)},i.jsonToRawAbi=function(e){var t=new Y;if(this.abiTypes.get("abi_def").serialize(t,e),!Z(t.getString()))throw new Error("Unsupported abi version");return t.asUint8Array()},i.getCachedAbi=function(){var e=u(b.mark((function e(t,r){var n,i,a;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!1),r||!this.cachedAbis.get(t)){e.next=3;break}return e.abrupt("return",this.cachedAbis.get(t));case 3:return e.prev=3,e.next=6,this.abiProvider.getRawAbi(t);case 6:a=this.rawAbiToJson(i=e.sent.abi),n={rawAbi:i,abi:a},e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(3),e.t0.message="fetching abi for "+t+": "+e.t0.message,e.t0;case 15:if(n){e.next=17;break}throw new Error("Missing abi for "+t);case 17:return this.cachedAbis.set(t,n),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(t,r){return e.apply(this,arguments)}}(),i.getAbi=function(){var e=u(b.mark((function e(t,r){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!1),e.next=3,this.getCachedAbi(t,r);case 3:return e.abrupt("return",e.sent.abi);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),i.getTransactionAbis=function(){var e=u(b.mark((function e(t,r){var n,i,a,s,o=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!1),n=(t.context_free_actions||[]).concat(t.actions),i=n.map((function(e){return e.account})),a=new Set(i),s=Array.from(a).map(function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getCachedAbi(t,r);case 2:return e.abrupt("return",{accountName:t,abi:e.sent.rawAbi});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(s));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),i.getContract=function(){var e=u(b.mark((function e(t,r){var n,i,a,s,o,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!1),r||!this.contracts.get(t)){e.next=3;break}return e.abrupt("return",this.contracts.get(t));case 3:return e.next=5,this.getAbi(t,r);case 5:for(n=e.sent,i=Pe(Se(),n),a=new Map,s=v(n.actions);!(o=s()).done;)a.set((u=o.value).name,Te(i,u.type));return this.contracts.set(t,c={types:i,actions:a}),e.abrupt("return",c);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),i.serialize=function(e,t,r){this.transactionTypes.get(t).serialize(e,r)},i.deserialize=function(e,t){return this.transactionTypes.get(t).deserialize(e)},i.serializeTransaction=function(e){var t=new Y;return this.serialize(t,"transaction",Object.assign({max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],transaction_extensions:[]},e)),t.asUint8Array()},i.serializeContextFreeData=function(e){if(e&&e.length){var t=new Y;t.pushVaruint32(e.length);for(var r,n=v(e);!(r=n()).done;)t.pushBytes(r.value);return t.asUint8Array()}},i.deserializeTransaction=function(e){var t=new Y;return t.pushArray(e),this.deserialize(t,"transaction")},i.serializeTransactionExtensions=function(e){var t=[];if(e.resource_payer){var r=new Y;Pe(Ne()).get("resource_payer").serialize(r,e.resource_payer),t=[].concat(t,[[1,se(r.asUint8Array())]])}return t},i.deserializeTransactionExtensions=function(e){var t=this,r={};return e.forEach((function(e){var n=t.transactionExtensions.find((function(t){return t.id===e[0]}));if(void 0===n)throw new Error("Transaction Extension could not be determined: "+e);var i=Pe(Ne()),a=new Y;a.pushArray(oe(e[1]));var s=i.get(n.type).deserialize(a);1===e[0]&&(s.max_net_bytes=Number(s.max_net_bytes),s.max_cpu_us=Number(s.max_cpu_us),s.max_memory_bytes=Number(s.max_memory_bytes),r.resource_payer=s)})),r},i.deleteTransactionExtensionObjects=function(e){return delete e.resource_payer,e},i.serializeActions=function(){var e=u(b.mark((function e(t){var r=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=u(b.mark((function e(t){var n,i,a,s,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.account,i=t.name,a=t.authorization,s=t.data,e.next=3,r.getContract(n);case 3:if(o=e.sent,"object"==typeof s){e.next=6;break}return e.abrupt("return",t);case 6:return e.abrupt("return",Ke(o,n,i,a,s));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.deserializeActions=function(){var e=u(b.mark((function e(t){var r=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=u(b.mark((function e(t){var n,i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.account,i=t.name,a=t.authorization,s=t.data,e.next=3,r.getContract(n);case 3:return e.abrupt("return",Fe(e.sent,n,i,a,s));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.deserializeActionsSync=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=[]),r=[],n=v(t);case 3:if((i=n()).done){e.next=11;break}return s=(a=i.value).account,o=a.name,u=a.authorization,c=a.data,e.next=7,this.getContract(s);case 7:r.push(Fe(e.sent,s,o,u,c));case 9:e.next=3;break;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.deserializeTransactionWithActions=function(){var e=u(b.mark((function e(t){var r,n;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"string"==typeof t&&(t=oe(t)),r=this.deserializeTransaction(t),e.next=4,this.deserializeActionsSync(r.context_free_actions);case 4:return n=e.sent,e.next=7,this.deserializeActionsSync(r.actions);case 7:return e.abrupt("return",Object.assign({},r,{context_free_actions:n,actions:e.sent}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.deflateSerializedArray=function(e){return t.deflate(e,{level:9})},i.inflateSerializedArray=function(e){return t.inflate(e)},i.transact=function(){var e=u(b.mark((function e(t,r){var n,i,a,s,o,u,c,p,f,h,l,d,y,v,m,g,_,w,x;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0===(i=(n=void 0===r?{}:r).broadcast)||i,o=void 0===(s=n.sign)||s,u=n.readOnlyTrx,c=n.returnFailureTraces,p=n.requiredKeys,f=n.compression,h=n.blocksBehind,l=n.useLastIrreversible,d=n.expireSeconds,y=n.transactionHeader,e.next=3,this.rpc.get_info();case 3:if(v=e.sent,y){e.next=24;break}if("number"!=typeof h||!l){e.next=10;break}throw new Error("Use either blocksBehind or useLastIrreversible");case 10:if("number"==typeof h||l){e.next=14;break}throw new Error("Must provide one blocksBehind or useLastIrreversible");case 14:if(d){e.next=18;break}throw new Error("Must provide expireSeconds");case 18:return e.next=20,this.generateTapos(v,t,h,l,d);case 20:y=e.sent;case 22:if(this.hasRequiredTaposFields(y)){e.next=24;break}throw new Error("Required configuration or TAPOS fields are not present");case 24:return e.next=26,this.getTransactionAbis(t);case 26:return m=e.sent,e.t0=Object,e.t1={},e.t2=y,e.next=32,this.serializeTransactionExtensions(t);case 32:return e.t3=e.sent,e.next=35,this.serializeActions(t.context_free_actions||[]);case 35:return e.t4=e.sent,e.next=38,this.serializeActions(t.actions);case 38:if(e.t5=e.sent,e.t6={transaction_extensions:e.t3,context_free_actions:e.t4,actions:e.t5},t=e.t0.assign.call(e.t0,e.t1,e.t2,e.t6),t=this.deleteTransactionExtensionObjects(t),g=this.serializeTransaction(t),_=this.serializeContextFreeData(t.context_free_data),w={serializedTransaction:g,serializedContextFreeData:_,signatures:[]},!o){e.next=58;break}if(this.signatureProvider){e.next=48;break}throw new Error("No signature provider available");case 48:if(p){e.next=55;break}return e.next=51,this.signatureProvider.getAvailableKeys();case 51:return x=e.sent,e.next=54,this.authorityProvider.getRequiredKeys({transaction:t,availableKeys:x});case 54:p=e.sent;case 55:return e.next=57,this.signatureProvider.sign({chainId:v.chain_id,requiredKeys:p,serializedTransaction:g,serializedContextFreeData:_,abis:m});case 57:w=e.sent;case 58:if(!a){e.next=62;break}if(!f){e.next=61;break}return e.abrupt("return",this.pushCompressedSignedTransaction(w,u,c));case 61:return e.abrupt("return",this.pushSignedTransaction(w,u,c));case 62:return e.abrupt("return",Object.assign({},w,{transactionHeader:y}));case 63:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),i.transactWithDelay=function(){var e=u(b.mark((function e(t,r,n){var i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},i=function(e){return a.apply(this,arguments)},void 0===r&&(r={}),e.next=5,this.transact(t,r);case 5:return s=e.sent,e.next=8,i(n);case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),i.query=function(){var e=u(b.mark((function e(t,r,n,i){var a,s,o,u,c,p,f,h,l,d,y,v,m;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.sign,s=i.requiredKeys,u=void 0===(o=i.authorization)?[]:o,e.next=3,this.rpc.get_info();case 3:return c=e.sent,e.next=6,this.tryRefBlockFromGetInfo(c);case 6:if(p=e.sent,f=new Y,Je(f,n),h=Object.assign({},Oe(p,1800),{context_free_actions:[],actions:[{account:t,name:"queryit",authorization:u,data:se(f.asUint8Array())}]}),l=this.serializeTransaction(h),d=[],!a){e.next=29;break}if(this.signatureProvider){e.next=15;break}throw new Error("No signature provider available");case 15:return e.next=17,this.getTransactionAbis(h);case 17:if(y=e.sent,s){e.next=25;break}return e.next=21,this.signatureProvider.getAvailableKeys();case 21:return v=e.sent,e.next=24,this.authorityProvider.getRequiredKeys({transaction:h,availableKeys:v});case 24:s=e.sent;case 25:return e.next=27,this.signatureProvider.sign({chainId:c.chain_id,requiredKeys:s,serializedTransaction:l,serializedContextFreeData:void 0,abis:y});case 27:d=e.sent.signatures;case 29:return e.next=31,this.rpc.send_transaction({signatures:d,compression:0,serializedTransaction:l});case 31:if(m=new Y({array:oe(e.sent.processed.action_traces[0][1].return_value)}),!r){e.next=37;break}return e.abrupt("return",Be(m));case 37:return e.abrupt("return",De(m));case 38:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),i.pushSignedTransaction=function(){var e=u(b.mark((function e(t,r,n){var i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.signatures,a=t.serializedTransaction,s=t.serializedContextFreeData,void 0===r&&(r=!1),void 0===n&&(n=!1),!r){e.next=5;break}return e.abrupt("return",this.rpc.push_ro_transaction({signatures:i,serializedTransaction:a,serializedContextFreeData:s},n));case 5:return e.abrupt("return",this.rpc.push_transaction({signatures:i,serializedTransaction:a,serializedContextFreeData:s}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),i.pushCompressedSignedTransaction=function(){var e=u(b.mark((function e(t,r,n){var i,a,s,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.signatures,a=t.serializedContextFreeData,void 0===r&&(r=!1),void 0===n&&(n=!1),s=this.deflateSerializedArray(t.serializedTransaction),o=this.deflateSerializedArray(a||new Uint8Array(0)),!r){e.next=7;break}return e.abrupt("return",this.rpc.push_ro_transaction({signatures:i,compression:1,serializedTransaction:s,serializedContextFreeData:o},n));case 7:return e.abrupt("return",this.rpc.push_transaction({signatures:i,compression:1,serializedTransaction:s,serializedContextFreeData:o}));case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),i.generateTapos=function(){var e=u(b.mark((function e(t,r,n,i,a){var s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=3),t){e.next=5;break}return e.next=4,this.rpc.get_info();case 4:t=e.sent;case 5:if(!i){e.next=10;break}return e.next=8,this.tryRefBlockFromGetInfo(t);case 8:return e.abrupt("return",Object.assign({},Oe(e.sent,a),r));case 10:if(!((s=t.head_block_num-n)<=t.last_irreversible_block_num)){e.next=17;break}return e.next=14,this.tryGetBlockInfo(s);case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,this.tryGetBlockHeaderState(s);case 19:e.t0=e.sent;case 20:return e.abrupt("return",Object.assign({},Oe(e.t0,a),r));case 22:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),i.hasRequiredTaposFields=function(e){return!(!e.expiration||"number"!=typeof e.ref_block_num||"number"!=typeof e.ref_block_prefix)},i.tryGetBlockHeaderState=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.rpc.get_block_header_state(t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,this.tryGetBlockInfo(t);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),i.tryGetBlockInfo=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.rpc.get_block_info(t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,this.rpc.get_block(t);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),i.tryRefBlockFromGetInfo=function(){var e=u(b.mark((function e(t){var r;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.hasOwnProperty("last_irreversible_block_id")&&t.hasOwnProperty("last_irreversible_block_num")&&t.hasOwnProperty("last_irreversible_block_time"))){e.next=4;break}return e.abrupt("return",{block_num:t.last_irreversible_block_num,id:t.last_irreversible_block_id,timestamp:t.last_irreversible_block_time});case 4:return e.next=6,this.tryGetBlockInfo(t.last_irreversible_block_num);case 6:return e.abrupt("return",{block_num:(r=e.sent).block_num,id:r.id,timestamp:r.timestamp});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.with=function(e){return new ut(this,e)},i.buildTransaction=function(e){var t=new ot(this);return e?e(t):t},i.getAccountKeys=function(){var e=u(b.mark((function e(t,r){var n;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.rpc.get_account(t);case 3:if(!(n=e.sent.permissions.find((function(e){return e.perm_name===r})))){e.next=8;break}return e.abrupt("return",n.required_auth.keys.map((function(e){return Qe.fromString(e.key).toString()})));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}(),i.sha256Digest=function(){var e=u(b.mark((function e(t){var r;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t instanceof Uint8Array?t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):t,e.t0=Uint8Array,e.next=4,this.getCrypto().subtle.digest("SHA-256",r);case 4:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.matchRsaKeyToSignature=function(){var e=u(b.mark((function e(t){var r,i,a,s,o,u,c,p,f,h,l,d,y,m,g,_,w,x,k,A;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.actor,a=(i=t.transaction.actions[0].data).signature,s=i.nonce,o=i.trx,e.next=4,this.rpc.fetchCredentials(r);case 4:u=(u=e.sent).filter((function(e){return"rsa_public_key"===e.key.key[0]})),c=v(u);case 7:if((p=c()).done){e.next=36;break}return f=p.value.key.key[1],h=He(Buffer.from(f.exponent,"hex").toString("base64")),l=He(Buffer.from(f.modulus,"hex").toString("base64")),d=JSON.parse(a.client_json),y=new Uint8Array(n.toBuffer(d.challenge).buffer),m=new Y,g=this.serializeTransaction(o),m.pushArray(g),m.pushNumberAsUint64(s),e.next=20,this.sha256Digest(m.asUint8Array().slice());case 20:if(_=e.sent,se(y)===se(_)){e.next=23;break}return e.abrupt("continue",34);case 23:return e.next=25,this.getCrypto().subtle.importKey("jwk",{kty:"RSA",e:h,n:l,alg:"RS256",ext:!1},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);case 25:return w=e.sent,x=oe(a.auth_data),k=oe($e(a.client_json)),A=new Uint8Array([].concat(x,k)),e.next=31,this.getCrypto().subtle.verify("RSASSA-PKCS1-v1_5",w,oe(a.signature),A);case 31:if(!e.sent){e.next=34;break}return e.abrupt("return",!0);case 34:e.next=7;break;case 36:return e.abrupt("return",!1);case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.matchEthKeyToSignature=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c,p,f,h,l,d;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.actor,i=(n=t.transaction.actions[0].data).signature,a=n.nonce,s=n.trx,e.next=4,this.rpc.fetchCredentials(r);case 4:o=(o=e.sent).filter((function(e){return"eth_public_key"===e.key.key[0]})),u=v(o);case 7:if((c=u()).done){e.next=24;break}return p="0x"+c.value.key.key[1],f=new Y,h=this.serializeTransaction(s),f.pushArray(h),f.pushNumberAsUint64(a),e.next=16,this.sha256Digest(f.asUint8Array().slice());case 16:if(l=se(e.sent),d="0x"+i.signature,this.getRecoverPersonalSignature()({data:l,sig:d})!==p){e.next=22;break}return e.abrupt("return",!0);case 22:e.next=7;break;case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.matchWaKeyToSignature=function(){var e=u(b.mark((function e(t){var n,i,a,s,o,u,c,p,f,h,l,d,y;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.signature,i=t.key,a=t.digest,e.prev=1,s=M(n),o=new Y({array:s.data}),u=new et({type:m.r1,data:o.getUint8Array(65)},new r.ec("p256")),c=o.getBytes().slice(),p=o.getBytes().slice(),(f=new Y).pushArray(c),e.t0=f,e.next=12,this.sha256Digest(p);case 12:return e.t1=e.sent,e.t0.pushArray.call(e.t0,e.t1),h=u.recover(f.asUint8Array()),l=Qe.fromString(i),d=new Y({array:l.key.data.slice(0,33)}),y=B({type:m.r1,data:d.asUint8Array()}),e.abrupt("return",h.toString()===y&&u.verify(a,h,!1));case 21:return e.prev=21,e.t2=e.catch(1),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(t){return e.apply(this,arguments)}}(),i.checkIfKeysMatchTransaction=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c,p,f,h,l,d,y,g,_,w,x,k,A,z,S,E,N=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.actor,n=t.permission,i=t.transaction,a=t.signatures,s=t.chainId,i=JSON.parse(JSON.stringify(i)),a=JSON.parse(JSON.stringify(a)),1!==i.actions.length||"webauthn"!==i.actions[0].account||"exec"!==i.actions[0].name||"active"!==n){e.next=33;break}if(o=i.actions[0].data.trx,console.dir(o,{depth:null}),1===o.actions.length){e.next=8;break}return e.abrupt("return",!1);case 8:u=v(o.actions);case 9:if((c=u()).done){e.next=20;break}p=v(c.value.authorization);case 12:if((f=p()).done){e.next=18;break}if((h=f.value).actor===r&&h.permission===n){e.next=16;break}return e.abrupt("return",!1);case 16:e.next=12;break;case 18:e.next=9;break;case 20:if("eth_public_key"!==(l=i.actions[0].data.key.key[0])){e.next=25;break}return e.abrupt("return",this.matchEthKeyToSignature({transaction:i,actor:r}));case 25:if("rsa_public_key"!==l){e.next=29;break}return e.abrupt("return",this.matchRsaKeyToSignature({transaction:i,actor:r}));case 29:return console.log("Key type "+l+" not supported"),e.abrupt("return",!1);case 31:e.next=66;break;case 33:d=v(i.actions);case 34:if((y=d()).done){e.next=45;break}g=v(y.value.authorization);case 37:if((_=g()).done){e.next=43;break}if((w=_.value).actor===r&&w.permission===n){e.next=41;break}return e.abrupt("return",!1);case 41:e.next=37;break;case 43:e.next=34;break;case 45:if(s){e.next=50;break}return e.next=48,this.rpc.get_info();case 48:s=e.sent.chain_id;case 50:return e.next=52,this.serializeActions(i.context_free_actions||[]);case 52:return i.context_free_actions=e.sent,e.next=55,this.serializeActions(i.actions);case 55:return i.actions=e.sent,x=this.serializeTransaction(i),k=this.serializeContextFreeData(i.context_free_data),A=et.fromString(a[0]),z=A.getType(),S=it(s,x,k),e.next=63,this.getAccountKeys(r,n);case 63:return E=e.sent.some((function(e){var t=Qe.fromString(e);return z===m.wa?N.matchWaKeyToSignature({signature:A.toString(),key:t.toString(),digest:S}):[m.k1,m.r1].includes(z)?A.verify(S,t,!1):(console.log("Key type "+z+" not supported"),!1)})),e.abrupt("return",E);case 66:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),ot=function(){function e(e){this.api=void 0,this.actions=[],this.contextFreeGroups=[],this.api=e}var t=e.prototype;return t.with=function(e){var t=new ut(this.api,e);return this.actions.push(t),t},t.associateContextFree=function(e){return this.contextFreeGroups.push(e),this},t.send=function(){var e=u(b.mark((function e(t){var r,n,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n=[],i=this.actions.map((function(e){return e.serializedData})),e.next=5,Promise.all(this.contextFreeGroups.map(function(){var e=u(b.mark((function e(t){var a,s,o,u;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t({cfd:r.length,cfa:n.length}),o=a.contextFreeAction,u=a.contextFreeData,(s=a.action)&&i.push(s),o&&n.push(o),u&&r.push(u);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return this.contextFreeGroups=[],this.actions=[],e.next=9,this.api.transact({context_free_data:r,context_free_actions:n,actions:i},t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),ut=function(){function e(e,t){this.api=void 0,this.accountName=void 0,this.serializedData=void 0,this.api=e,this.accountName=t}return e.prototype.as=function(e){return void 0===e&&(e=[]),new ct(this,this.api,this.accountName,e&&"string"==typeof e?[{actor:e,permission:"active"}]:e)},e}(),ct=function(e,t,r,n){var i=this,a=t.cachedAbis.get(r);if(!a)throw new Error("ABI must be cached before using ActionBuilder, run api.getAbi()");for(var s,o=Pe(Se(),a.abi),u=new Map,c=v(a.abi.actions);!(s=c()).done;){var p=s.value;u.set(p.name,Te(o,p.type))}u.forEach((function(t,a){var s;Object.assign(i,((s={})[a]=function(){for(var i={},s=arguments.length,c=new Array(s),p=0;p<s;p++)c[p]=arguments[p];c.forEach((function(e,r){i[t.fields[r].name]=e}));var f=Ke({types:o,actions:u},r,a,n,i);return e.serializedData=f,f},s))}))},pt={__proto__:null},ft=function(e){var t,r;function n(t){var r;return t&&t.error&&t.error.details&&t.error.details.length&&t.error.details[0].message?((r=e.call(this,t.error.details[0].message)||this).json=void 0,r.details=void 0,r.details=t.error.details):t&&t.processed&&t.processed.except&&t.processed.except.message?((r=e.call(this,t.processed.except.message)||this).json=void 0,r.details=void 0,r.details=t.processed.except):t&&t.result&&t.result.except&&t.result.except.message?((r=e.call(this,t.result.except.message)||this).json=void 0,r.details=void 0,r.details=t.result.except):t?((r=e.call(this,t.message)||this).json=void 0,r.details=void 0):((r=e.call(this,t)||this).json=void 0,r.details=void 0),Object.setPrototypeOf(d(r),n.prototype),r.json=t,d(r)}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,p(t,r),n}(l(Error));function ht(){return lt.apply(this,arguments)}function lt(){return(lt=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.get_table_rows({code:"eosio.proton",table:"kycproviders",scope:"eosio.proton"});case 3:this.validKycProviders=e.sent.rows.reduce((function(e,t){return t.blisted||e.push(t.kyc_provider),e}),[]),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Unable to get KYC Providers.");case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))).apply(this,arguments)}function dt(e){return yt.apply(this,arguments)}function yt(){return(yt=u(b.mark((function e(t){var r,n,i,a=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=["firstname","lastname","birthdate","address"],0!==t.length){e.next=3;break}throw new Error("Please enter an account.");case 3:if(0!==this.validKycProviders.length){e.next=6;break}return e.next=6,this.getValidKycProviders();case 6:if(n=[],!Array.isArray(t)){e.next=11;break}n=t,e.next=23;break;case 11:if("string"!=typeof t){e.next=23;break}return e.prev=12,e.next=15,this.get_table_rows({code:"eosio.proton",table:"usersinfo",scope:"eosio.proton",lower_bound:t,upper_bound:t});case 15:n=e.sent.rows,e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(12),new Error("Account not found!");case 23:return i=n.map((function(e){var t=e.kyc.reduce((function(e,t){return a.validKycProviders.indexOf(t.kyc_provider)>=0&&(e=t.kyc_level.split(",").map((function(e){return e.split(":")[1]})).concat(e)),e}),[]);return e.isLightKYCVerified=r.every((function(e){return t.includes(e)})),e})),e.abrupt("return",i);case 25:case"end":return e.stop()}}),e,this,[[12,20]])})))).apply(this,arguments)}function vt(e){return mt.apply(this,arguments)}function mt(){return(mt=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get_table_rows({code:"webauthn",scope:"webauthn",table:"credentials",lower_bound:t,upper_bound:t,key_type:"name",index_position:2});case 2:return e.abrupt("return",e.sent.rows);case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var gt=function(e){for(var t,r="",n=v(e);!(t=n()).done;)r+=("00"+t.value.toString(16)).slice(-2);return r},bt=function(){function e(e){this.endpoints=void 0,this.maxRetries=3,this.currentEndpoint=void 0,this.validKycProviders=[],this.isLightKYCVerified=dt,this.getValidKycProviders=ht,this.fetchCredentials=vt,e=Array.isArray(e)?e:[e],this.endpoints=e.map((function(e){return e.replace(/\/$/,"")})),this.currentEndpoint="",this.nextEndpoint()}var t=e.prototype;return t.nextEndpoint=function(){if(this.endpoints.length){if(this.currentEndpoint){var e=this.endpoints.shift();this.endpoints=this.endpoints.concat(e||[])}this.currentEndpoint=this.endpoints[0]}},t.fetch=function(){var e=u(b.mark((function e(t,r,n){var i,a,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=0),e.prev=1,e.next=4,s(this.currentEndpoint+t,{body:JSON.stringify(r),method:"POST"});case 4:return i=e.sent,e.next=7,i.json();case 7:if(!(a=e.sent).processed||!a.processed.except){e.next=12;break}throw new ft(a);case 12:if(!a.result||!a.result.except){e.next=14;break}throw new ft(a);case 14:e.next=27;break;case 16:if(e.prev=16,e.t0=e.catch(1),console.log({currentEndpoint:this.currentEndpoint,endpoints:this.endpoints,currentRetries:n,error:e.t0}),!(this.endpoints.length>1)){e.next=27;break}if(this.nextEndpoint(),!(n<this.maxRetries)){e.next=25;break}return e.abrupt("return",this.fetch(t,r,++n));case 25:throw e.t0.isFetchError=!0,new ft(e.t0);case 27:if(i&&i.ok){e.next=29;break}throw new ft(a);case 29:if(!a||!a.head_block_time){e.next=37;break}if(o=new Date(a.head_block_time+"Z").getTime(),!(((new Date).getTime()-o)/1e3>30&&this.endpoints.length>1)){e.next=37;break}if(this.nextEndpoint(),!(n<this.maxRetries)){e.next=37;break}return e.abrupt("return",this.fetch(t,r,++n));case 37:return e.abrupt("return",a);case 38:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(t,r,n){return e.apply(this,arguments)}}(),t.get=function(){var e=u(b.mark((function e(t){var r;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:if(!((r=e.sent).status>=400)){e.next=5;break}throw new Error("Bad response from server "+r.status);case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.abi_bin_to_json=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/abi_bin_to_json",{code:t,action:r,binargs:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.abi_json_to_bin=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/abi_json_to_bin",{code:t,action:r,args:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.get_abi=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_abi",{account_name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_account=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_account",{account_name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_accounts_by_authorizers=function(){var e=u(b.mark((function e(t,r){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_accounts_by_authorizers",{accounts:t,keys:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_activated_protocol_features=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===(r=t.limit)?10:r,a=void 0!==(i=t.search_by_block_num)&&i,o=void 0!==(s=t.reverse)&&s,u=t.lower_bound,c=t.upper_bound,e.next=3,this.fetch("/v1/chain/get_activated_protocol_features",{lower_bound:u,upper_bound:c,limit:n,search_by_block_num:a,reverse:o});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_block_header_state=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_block_header_state",{block_num_or_id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_block_info=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_block_info",{block_num:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_block=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_block",{block_num_or_id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_code=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_code",{account_name:t,code_as_wasm:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_code_hash=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_code_hash",{account_name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_currency_balance=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_currency_balance",{code:t,account:r,symbol:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.get_currency_stats=function(){var e=u(b.mark((function e(t,r){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_currency_stats",{code:t,symbol:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_info=function(){var e=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_info",{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_producer_schedule=function(){var e=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_producer_schedule",{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_producers=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!0),void 0===r&&(r=""),void 0===n&&(n=50),e.next=5,this.fetch("/v1/chain/get_producers",{json:t,lower_bound:r,limit:n});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.get_raw_code_and_abi=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_raw_code_and_abi",{account_name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRawAbi=function(){var e=u(b.mark((function e(t){var r,n;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get_raw_abi(t);case 2:return n=C((r=e.sent).abi),e.abrupt("return",{accountName:r.account_name,abi:n});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_raw_abi=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_raw_abi",{account_name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_scheduled_transactions=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!0),void 0===r&&(r=""),void 0===n&&(n=50),e.next=5,this.fetch("/v1/chain/get_scheduled_transactions",{json:t,lower_bound:r,limit:n});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.get_table_rows=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c,p,f,h,l,d,y,v,m,g,_,w;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===(r=t.json)||r,i=t.code,a=t.scope,s=t.table,u=void 0===(o=t.lower_bound)?"":o,p=void 0===(c=t.upper_bound)?"":c,h=void 0===(f=t.index_position)?1:f,d=void 0===(l=t.key_type)?"":l,v=void 0===(y=t.limit)?10:y,g=void 0!==(m=t.reverse)&&m,w=void 0!==(_=t.show_payer)&&_,e.next=3,this.fetch("/v1/chain/get_table_rows",{json:n,code:i,scope:a,table:s,lower_bound:u,upper_bound:p,index_position:h,key_type:d,limit:v,reverse:g,show_payer:w});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_kv_table_rows=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c,p,f,h,l,d,y,v,m;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===(r=t.json)||r,i=t.code,a=t.table,s=t.index_name,u=void 0===(o=t.encode_type)?"bytes":o,c=t.index_value,p=t.lower_bound,f=t.upper_bound,l=void 0===(h=t.limit)?10:h,y=void 0!==(d=t.reverse)&&d,m=void 0!==(v=t.show_payer)&&v,e.next=3,this.fetch("/v1/chain/get_kv_table_rows",{json:n,code:i,table:a,index_name:s,encode_type:u,index_value:c,lower_bound:p,upper_bound:f,limit:l,reverse:y,show_payer:m});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_table_by_scope=function(){var e=u(b.mark((function e(t){var r,n,i,a,s,o,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.code,n=t.table,a=void 0===(i=t.lower_bound)?"":i,o=void 0===(s=t.upper_bound)?"":s,c=void 0===(u=t.limit)?10:u,e.next=3,this.fetch("/v1/chain/get_table_by_scope",{code:r,table:n,lower_bound:a,upper_bound:o,limit:c});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getRequiredKeys=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/chain/get_required_keys",{transaction:t.transaction,available_keys:t.availableKeys});case 2:return e.abrupt("return",V(e.sent.required_keys));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.push_transaction=function(){var e=u(b.mark((function e(t){var r,n,i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.signatures,i=void 0===(n=t.compression)?0:n,a=t.serializedTransaction,s=t.serializedContextFreeData,e.prev=1,e.next=4,this.fetch("/v1/chain/push_transaction",{signatures:r,compression:i,packed_context_free_data:gt(s||new Uint8Array(0)),packed_trx:gt(a)});case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),e.t0&&e.t0.json&&e.t0.json.error&&"expired_tx_exception"===e.t0.json.error.name&&(e.t0.json.error.message="Transaction Expired: Try Again",this.nextEndpoint()),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),t.push_ro_transaction=function(){var e=u(b.mark((function e(t,r){var n,i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.signatures,a=void 0===(i=t.compression)?0:i,s=t.serializedTransaction,void 0===r&&(r=!1),e.next=4,this.fetch("/v1/chain/push_ro_transaction",{transaction:{signatures:n,compression:a,packed_context_free_data:gt(new Uint8Array(0)),packed_trx:gt(s)},return_failure_traces:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.push_transactions=function(){var e=u(b.mark((function e(t){var r;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){var t=e.compression,r=e.serializedTransaction;return{signatures:e.signatures,compression:void 0===t?0:t,packed_context_free_data:gt(e.serializedContextFreeData||new Uint8Array(0)),packed_trx:gt(r)}})),e.next=3,this.fetch("/v1/chain/push_transactions",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.send_transaction=function(){var e=u(b.mark((function e(t){var r,n,i,a,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.signatures,i=void 0===(n=t.compression)?0:n,a=t.serializedTransaction,s=t.serializedContextFreeData,e.next=3,this.fetch("/v1/chain/send_transaction",{signatures:r,compression:i,packed_context_free_data:gt(s||new Uint8Array(0)),packed_trx:gt(a)});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.db_size_get=function(){var e=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/db_size/get",{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.trace_get_block=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/trace_api/get_block",{block_num:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.history_get_actions=function(){var e=u(b.mark((function e(t,r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=null),void 0===n&&(n=null),e.next=4,this.fetch("/v1/history/get_actions",{account_name:t,pos:r,offset:n});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.history_get_transaction=function(){var e=u(b.mark((function e(t,r){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=null),e.next=3,this.fetch("/v1/history/get_transaction",{id:t,block_num_hint:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.history_get_key_accounts=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/history/get_key_accounts",{public_key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.history_get_controlled_accounts=function(){var e=u(b.mark((function e(t){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch("/v1/history/get_controlled_accounts",{controlling_account:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),_t={__proto__:null},wt=function(){function e(){this.keys=new Map}var t=e.prototype;return t.getAvailableKeys=function(){var e=u(b.mark((function e(){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Array.from(this.keys.keys()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.sign=function(){var e=u(b.mark((function e(t){var n,i,a,s,o,u,c,p,f,h,l,d,y,g,_,w,x,k,A,z,S,E,N;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.chainId,i=t.requiredKeys,a=t.serializedTransaction,s=t.serializedContextFreeData,(o=new Y).pushArray(oe(n)),o.pushArray(a),!s){e.next=14;break}return e.t0=o,e.t1=Uint8Array,e.next=9,crypto.subtle.digest("SHA-256",s.buffer);case 9:e.t2=e.sent,e.t3=new e.t1(e.t2),e.t0.pushArray.call(e.t0,e.t3),e.next=15;break;case 14:o.pushArray(new Uint8Array(32));case 15:return e.t4=Uint8Array,e.next=18,crypto.subtle.digest("SHA-256",o.asUint8Array().slice().buffer);case 18:e.t5=e.sent,u=new e.t4(e.t5),c=[],p=v(i);case 22:if((f=p()).done){e.next=67;break}return l=oe(this.keys.get(h=f.value)),e.next=27,navigator.credentials.get({publicKey:{timeout:6e4,allowCredentials:[{id:l,type:"public-key"}],challenge:u.buffer}});case 27:if(d=e.sent,y=new r.ec("p256"),g=y.keyFromPublic(R(h).data.subarray(0,33)).getPublic(),_=function(e){for(var t=Array.from(e);t.length<32;)t.unshift(0);for(;t.length>32;)if(0!==t.shift())throw new Error("Signature has an r or s that is too big");return new Uint8Array(t)},48===(w=new Y({array:new Uint8Array(d.response.signature)})).get()){e.next=34;break}throw new Error("Signature missing DER prefix");case 34:if(w.get()===w.array.length-2){e.next=36;break}throw new Error("Signature has bad length");case 36:if(2===w.get()){e.next=38;break}throw new Error("Signature has bad r marker");case 38:if(x=_(w.getUint8Array(w.get())),2===w.get()){e.next=41;break}throw new Error("Signature has bad s marker");case 41:return k=_(w.getUint8Array(w.get())),(A=new Y).pushArray(new Uint8Array(d.response.authenticatorData)),e.t6=A,e.t7=Uint8Array,e.next=48,crypto.subtle.digest("SHA-256",d.response.clientDataJSON);case 48:return e.t8=e.sent,e.t9=new e.t7(e.t8),e.t6.pushArray.call(e.t6,e.t9),e.t10=Uint8Array,e.next=54,crypto.subtle.digest("SHA-256",A.asUint8Array().slice());case 54:e.t11=e.sent,z=new e.t10(e.t11),S=y.getKeyRecoveryParam(z,new Uint8Array(d.response.signature),g),(E=new Y).push(S+27+4),E.pushArray(x),E.pushArray(k),E.pushBytes(new Uint8Array(d.response.authenticatorData)),E.pushBytes(new Uint8Array(d.response.clientDataJSON)),N=W({type:m.wa,data:E.asUint8Array().slice()}),c.push(N);case 65:e.next=22;break;case 67:return e.abrupt("return",{signatures:c,serializedTransaction:a,serializedContextFreeData:s});case 68:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),xt={Api:st,ApiInterfaces:pt,JsonRpc:bt,Numeric:J,RpcInterfaces:_t,RpcError:ft,Serialize:Ye,JsSignatureProvider:at,Key:rt,sha256:$e,WebAuthnSignatureProvider:wt};exports.Api=st,exports.ApiInterfaces=pt,exports.JsSignatureProvider=at,exports.JsonRpc=bt,exports.Key=rt,exports.Numeric=J,exports.RpcError=ft,exports.RpcInterfaces=_t,exports.Serialize=Ye,exports.WebAuthnSignatureProvider=wt,exports.default=xt,exports.digestFromSerializedData=it,exports.sha256=$e;
//# sourceMappingURL=js.cjs.production.min.js.map
